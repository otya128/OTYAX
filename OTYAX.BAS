@SOF 'START OF FILE
GOTO @STOPSKIP
' ('¥w¥`) Ó¯ÄÐ¼Þ¶¸ÅÙÖÃ²ÀÞ¯À
'±Ý¾ÞÝÅSTOP->CONT¦ - @STOP
@STOP
STOP
RETURN
@ERR
DATA "Syntax error
DATA "Out of range
DATA "Out of memory
DATA "Undefined label
DATA "NEXT without FOR
DATA "Out of DATA
DATA "Illegal function call
DATA "Duplicate definition
DATA "Can't continue
DATA "Missing operand
DATA "Duplicate label
DATA "Illegal resource
DATA "Illegal character type
DATA "String too long
DATA "Division by zero
DATA "Overflow
DATA "Subscript out of range
DATA "Type mismatch
DATA "Fomula too complex
DATA "RETURN without GOSUB
DATA "FOR without NEXT
DATA "Illegal MML
ACLS
DIM ERR$[22]
RESTORE @ERR
FOR I=0TO 21
 READ ERR$[I]
NEXT
IF ERL==0THEN ?"´×-Ê ±ØÏ¾Ý" ELSE INPUT"·ÄÞ³ÄÁ­³ÃÞ´×-?(Y/N)";YN$
IF YN$=="Y"THEN ?"ÃÞ-À»¸¼Þ®":DELETE "MEM:OTWINI"
IF ERL!=0THEN IF ERR==4 THEN ?"±ÌßØÒ²¦ ÏÁ¶Þ´À ¶É³¾²¶Þ ±ØÏ½" ELSE ?"ÊÞ¸ÞÉ¶É³¾²¶Þ ±ØÏ½"
?"ºÚÃÞ¶²¹Â¼Å²ÉÅ×",ERL,ERR$[ERR-1],"¦Î³º¸¼Ã¸ÀÞ»²
STOP
GOTO @SOF
@STOPSKIP
'„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z            SO    F    
'„x                   „x           „µ„¶„³„¬„® „¯  „² 
'„x(C)2013otya        „x            „¯„³„¬„® „±  „­ 
'„x20130105 = WINDOW  „x           „¯„¶„³„¬„®  „²„¯  
'„x  OTYAX VER4 „z„z„z„z„z„z„x„z„z„z„z„z„z„z     „®„·„µ„¶ „µ„ª„«„µ 
'„¼„z„z„z„z„z„z„z„z„z„z„z„z„z„x     „w       „x  
'              „x20130305=¶Ý¾²„x  
'4.0.1         „x      08=4.0.1  
'   ¾-ÌÞ¼­³¾²  „x    1024=4.1 „x  
'ÒÆ­-¼­³¾²     „¼„z„z„z„z„z„z„z„z„z„z„z„z„z„x  
'                               
'                               
SYSBEEP=TRUE
CLEAR
IF BUTTON()AND 2048THEN DBG=1:BEEP 
CY=CSRY-1
IF BUTTON()AND 1024THEN CY=CY+1
IF CY<0THEN CY=0
FOR I=0TO 31
L$=CHR$(CHKCHR(I,CY))
LL$=LL$+L$
L=CHKCHR(I,CY)
IF F==1AND((ASC("A")<=L AND ASC("Z")>=L)OR L$=="_")THEN LBL$=LBL$+L$
IF L$=="@"THEN F=1
NEXT
CY=0:L$="":LL$=""
IF F THEN GOTO "@"+LBL$
F=0
LBL$=""
ACLS
IF DBG THEN GOSUB @DBG
COMKF=1
FMAX=256*192
DIM DISK[256*192]
DIM F$[192]
CMDLINEMAX=10
DIM CMD$[CMDLINEMAX]
GOSUB @CMDREAD
VER$= MID$(PRGNAME$,LEN("OTYAX"),3)
VERSION$="OTYAX."+VER$
IF MID$(VER$,0,1)=="A"THEN VERSION$="OTYAXVER4.ALPHA."+MID$(VER$,1,256)
IF MID$(VER$,0,1)=="B"THEN VERSION$="OTYAXVER4.BETA."+MID$(VER$,1,256)
VER$="4.1
VERSION$="OTYAX.4.1
?"NEW OTYAX VER 4.1"
GOSUB @INI
GOSUB "@"+AUTOSUB$
END
@OTW
ACLS
?"OTYAX-WINDOW SYSTEM
?VERSION$
?"Now Setting...
VSYNC 0
RESTORE @OTWDAT
READ OTWMAX
DIM OTWDAT$[OTWMAX]
DIM OTWDATL[OTWMAX]
DIM OTWDATT[OTWMAX]
L=0
FOR I=0TO OTWMAX-1
 READ OTWDAT$[I],OTWDATL[I],O$
 IF O$=="V"THEN OTWDATT[I]=0
 IF O$=="S"THEN OTWDATT[I]=1
 L=L+OTWDATL[I]
NEXT
SYSBEEP=0
MEM$=""
LOAD"MEM:OTWINI",FALSE
MEM_$=MEM$
'?L,LEN(MEM$)
'STOP
IF L!=LEN(MEM$)THEN ?"„F„GÌ¾²ÅÃÞ-À ÃÞ½¡":WAIT 60:?MEM$:GOTO@OTWINISKP
IF RESULT==TRUE THEN GOSUB @OTWINILD:GOTO@OTWINI
@OTWINISKP
GOSUB @OTWVARSET
CANCELFLG=L>LEN(MEM$) AND MEM$!=""
MEMLEN=LEN(MEM$)
GOSUB@OTWINISAV
IF L>MEMLEN AND MEM_$!=""THEN GOSUB @OTWINIUPDATE
GOTO@OTWINI

RETURN
@OTWINIUPDATE
 MEM$=MID$(MEM_$,0,MEMLEN)+MID$(MEM$,MEMLEN,LEN(MEM$)-MEMLEN)
'?MEM$,LEN(MEM$)
 SAVE "MEM:OTWINI"
GOSUB @OTWINILD

RETURN
'SAVEDATA²¹²¼·
@OTWDAT
DATA 13
DATA 16,1,V
DATA 1,1,V
DATA "",12,S
DATA 256,2,V
DATA 512,2,V
DATA "NORMAL",12,S
DATA 15,1,V
DATA 14,1,V
DATA 1,1,V
DATA 14,1,V
DATA 22,1,V
DATA 1,1,V
DATA "",8,S
@OTWINILD
 I=0
 LOAD"MEM:OTWINI",FALSE
 FOR J=0TO LEN(MEM$)-1
  OTWDAT$[I]=MID$(MEM$,J,OTWDATL[I])
  IF OTWDATT[I]==1THEN K=INSTR(J,MEM$,CHR$(0)):IF K!=-1THEN OTWDAT$[I]=MID$(OTWDAT$[I],0,K-J)
  J=J+OTWDATL[I]-1
  FOR K=1TO OTWDATT[I]==0
   O$="&H"
   FOR L=0TO OTWDATL[I]-1
    O$=O$+HEX$(ASC(MID$(OTWDAT$[I],L,1)),2)
   NEXT
   OTWDAT$[I]=O$
  NEXT
  I=I+1
 NEXT
RETURN
@OTWINISAVP
 ON OTWDATT[I] GOSUB @OTWINISAVV,@OTWINISAVS
 I=I+1
 MEM$=MEM$+K$
RETURN
@OTWINISAVV
 K$=""
 FOR J=0TO OTWDATL[I]-1
  K$=K$+CHR$(VAL("&H"+MID$(HEX$(V,OTWDATL[I]*2),J*2,2)))
 NEXT
RETURN
@OTWINISAVS
 K$=""
 K$=V$+CHR$(0)*(OTWDATL[I]-LEN(V$))
RETURN
@OTWINISAV
 I=0
 MEM$=""
 V=TSKMAX
 GOSUB@OTWINISAVP
 V=MOUSEMODE
 GOSUB@OTWINISAVP
 V$=SHELL$
 GOSUB@OTWINISAVP
 V=CLICKBTN
 GOSUB@OTWINISAVP
 V=CLICKBTNR
 GOSUB@OTWINISAVP
 V$=WINDFDESIGN$
 GOSUB@OTWINISAVP
 V=WINDEFAUTBG
 GOSUB@OTWINISAVP
 V=COMDEFAUTBG
 GOSUB@OTWINISAVP
 V=WINMOVMODE
 GOSUB@OTWINISAVP
 V=WINBOXC
 GOSUB@OTWINISAVP
 V=OTWBGCL
 GOSUB@OTWINISAVP
 V=WINDLTWAIT
 GOSUB@OTWINISAVP
 V$=MOUSERES$
 GOSUB@OTWINISAVP
 IF !CANCELFLG THEN SAVE "MEM:OTWINI"
 CANCELFLG=0
RETURN
'12
'SAVEDAT
TSKMAX=1DOT         1
MOUSEMODE=1DOT      2
SHELL$=12DOT        14
CLICKBTN=2DOT       16
CLICKBTNR=2DOT      18
WINDFDEGIN$=12DOT   30
WINDEFAUTBG=1DOT    31
COMDEFAUTBG=1DOT    32
WINMOVMODE=1DOT     33
WINBOXC=1DOT        34
OTWBGCL=1DOT        35
WINDLTWAIT=1DOT     36
@COM_OTW
COMP$="NOT COMMAND APPLICATION":GOSUB COMPRT$
RETURN
@OTWFONTBG
 FOR I=0TO 255
  CHRREAD("BGF",I),C$
  CHRSET "BGU",I,C$
 NEXT
RETURN
@OTWCOL 
 COLINIT "BG"
 FOR I=0TO 255
  COLREAD("BG",I),R,G,B
  COLSET "GRP",I,HEX$(R,2)+HEX$(G,2)+HEX$(B,2)
   COLSET "SP",I,HEX$(R,2)+HEX$(G,2)+HEX$(B,2)
 NEXT
RETURN
@OTWVARSET
 TSKMAX=VAL(OTWDAT$[0])
 MOUSEMODE  =VAL(OTWDAT$[01])
 SHELL$     =OTWDAT$[02]
 CLICKBTN   =VAL(OTWDAT$[3])
 CLICKBTNR  =VAL(OTWDAT$[04])
 WINDFDESIGN$=OTWDAT$[05]
 WINDEFAUTBG=VAL(OTWDAT$[06])
 COMDEFAUTBG=VAL(OTWDAT$[07])
 WINMOVMODE =VAL(OTWDAT$[08])
 WINBOXC    =VAL(OTWDAT$[09])
 OTWBGCL    =VAL(OTWDAT$[10])
 WINDLTWAIT =VAL(OTWDAT$[11])
 MOUSERES$  =OTWDAT$[12]
RETURN
@OTWSAFEMODE
 ACLS
SYSBEEP=1
GOSUB @OTWVARSET
 GPAGE 0,0,0
 GOSUB @OTWCOL
 GPAGE 0,1,1
 GOSUB @OTWCOL
 GOSUB @OTWFONTBG
' MOUSEMODE=1
 MOUSESCL=100
 MOUSESP=0
 MOUSEX=256/2-16*MOUSESCL/100
 MOUSEY=192/2-16*MOUSESCL/100
 'Ï³½¦ºËß-
 CHRREAD("SPS1",46*4),C$
 CHRSET "SPU",0,C$
 CHRREAD("SPS1",46*4+1),C$
 CHRSET "SPU",1,C$
 CHRREAD("SPS1",46*4+2),C$
 CHRSET "SPU",2,C$
 CHRREAD("SPS1",46*4+3),C$
 CHRSET "SPU",3,C$
 SPSET MOUSESP,0,0,0,0,0 '¾¯Ä
 SPOFS MOUSESP,MOUSEX,MOUSEY
 SPSCALE MOUSESP,MOUSESCL
 '»²ÀÞ²ÄÞ³¼ÞÀ½¸
 'TSKMAX=16
 '*@WIN_? ×ÍÞÙÉÅÏ´
 TSKMAX=TSKMAX+1
 DIM WINNAME$[TSKMAX]
 '*³¨ÝÄÞ³Ê ±¸Ã¨ÌÞ ¶
 DIM WINFLG[TSKMAX]
 '*À²ÄÙÊÞ-ÉÅÏ´
 DIM WINTTL$[TSKMAX]
 
 'WINM[]=0
 ' WINX[],WINY[],WINX2[],WINY2[]
 ' É»²½ÞÉ³¨ÝÄÞ³¦¼ÞÄÞ³»¸¾²
 'WINM[]=1
 ' ¼ÞÌÞÝÃÞ¼Ã²¡
 ' WINX,WINY,WINX2,WINY2,WINSCX,WINSCY
 ' ¦¾¯Ä¼¤ÖÝÃÞ
 ' AL=APPLABEL
 ' ALSX=WINSCX,ALSY=WINSCY
 ' ¦½Ù¡(ÊÞ±²ÆÖ³ÞÃÊALX,ALY,ALX2,ALY2ÆÓ)
 DIM WINM[TSKMAX]
 '»²½Þ
 DIM WINMLT[TSKMAX]
 DIM WINX[TSKMAX]
 DIM WINY[TSKMAX]
 DIM WINX2[TSKMAX]
 DIM WINY2[TSKMAX]
 DIM WINSX[TSKMAX]
 DIM WINSY[TSKMAX]
 DIM TSKF[TSKMAX]

'2013/08/25Â²¶
 WINMESMAX=16'QUEUE
 DIM WINID[TSKMAX]
 WINID=0
 DIM WINMESBUF$[WINMESMAX]'WINSWPÖ³
 DIM WINMES$[TSKMAX,WINMESMAX]
 DIM WINMES_ID[TSKMAX,WINMESMAX]
 DIM WINMESBUF_ID[WINMESMAX]'WINSWPÖ³
 DIM WINMES_I[TSKMAX]
 WINIDMLT=-1
'---
'2013/08/30Â²¶
 DIM WINR[TSKMAX]
'---
'2013/09/02Â²¶
 DIM TSKBAR$[TSKMAX]
 DIM TSKBAR[TSKMAX]
'---
 TSKMAX=TSKMAX-1
 DIM WINBUFF[4]
 WINBUFF[0]=1
 WINBUFF[1]=1
 'ºÝ¿-Ù
''''''''''''''' '65536byteÎÄÞ¼®³Ë
 DIM COM$[64]
 WINCOM=1
 TSK=TSKMAX-1
 '¼ªÙ¡
 'RUN.OTW¦ ÊÔ¸¼Þ¯¿³¼À²¡->
 '¼À¡
 '@WINEXE¦Â¸ØÀ²->¼À
 'SHELL$="RUN"
 WINNAME$[0]=SHELL$
 WINFLG[0]=-1
 IF SHELL$=="" THEN WINFLG[0]=0:WINNAME$[0]=""

 'L¶ÞÂ¶´Å²,ËÀÞØ·· ÅÄÞÉËÄ
 '¶·¶´½²¼®³
 'ËÀÞØ·· =R=512
 'L,RºÜÚÀ=A=16
 '¼Þ­³¼Þ·- ÉÎ³¶Þ×¸ÀÞ¶Þ
 'Î¶ÆÂ¶³ÉÃÞË½²¼®³
' CLICKBTN=256
' CLICKBTNR=512
 'WINDOWÉÃÞ»Þ²Ý
 '@DEG_(ººÉÌÞÌÞÝ)
 'NORMAL =Wi95Ì³
 'VISUAL=WiXPÌ³
 'WINDFDESIGN$="MAC"'NORMAL
 WINDESIGN$=WINDFDESIGN$
 'ÁÞÌ«ÙÄÊ²¹² ¼®¸
' WINDEFAUTBG=15
 '¶Å×½Þ-1
 '-1=ÃÞÌ«ÙÄ¦¼Ã²¡
 WINBG=WINDEFAUTBG
 '**¼Þ¯¿³½Ù¶ÌÒ²**
 'ºÝ¿-Ù Ö³
' COMDEFAUTBG=14
 '¶Å×½Þ-1
 '-1=ÃÞÌ«ÙÄ¦¼Ã²¡
 COMBG=-1
 'Ï³½É·¬×ÊÞÝ
 '0=Â³¼Þ®³
 '1=¾ÝÁ¸¼Þ
 '2=¼®ØÁ­³
 MOUSEMAX=3
 DIM MOUSE[MOUSEMAX]
 MOUSE[0]=110-64
 MOUSE[1]=112-64
 MOUSE[2]=96-64
 GOSUB @MOUSESET
 IF MOUSERES$!=""THEN LOAD"SPU:"+MOUSERES$,0
 '0ÎÝÀ²¶ÞÂ²Ã²¶Å¸ÃÌ¼¾ÞÝ
 '1¸ÛÜ¸ÉÐ²ÄÞ³ MOUSE¦ÊÅ¼À×²ÄÞ³
 '2·Ó²¡
 '**1¦ ½²¼®³**
' WINMOVMODE=1
 'Ü¸É²Û
' WINMOVBOXC=14
 '·®³¾²¼­³Ø®³ÉWAIT¾¯Ã²
 '1/60ËÞ®³
' WINDLTWAIT=2
' OTWBGCL=29'193
 SCRSIZE_X=255
 SCRSIZE_Y=181'TSKBAR
 LOCATE 0,23
 TSKBARML=0'1024
RETURN
@OTWINI
 GOSUB @OTWSAFEMODE
 GOTO @OTWLOOP
RETURN
'''<summary>
''' -------------
''' ---Ò²ÝÙ-Ìß---
''' -------------
'''</summary>
@OTWLOOP

 WINACTV=WINFLG[TSK]>=2'R WINFLG[TSK]==3'TSK==0
 WINFLG=WINFLG[TSK]
 WINTTL$=WINTTL$[TSK]
 'MAINCouNTerLow
 TSKF=MAINCNTL
 GOSUB @FUNCTSK
 IF WINIDFLG==0THEN TSKF[TSKB]=MAINCNTL-TSKF
 IF !WINIFLG THEN WINFLG[TSK]=WINFLG:WINTTL$[TSK]=WINTTL$
 IF WINFLG[TSK]==0AND WINIDFLG==1THEN GOSUB @FOREND
 IF WINEND==0THEN GOSUB @SET_WXY ELSE WINENDF=1
 WINCLS=0:WIN_MODE=0
 IF TSK==0 AND WINIDFLG==0THEN WINIDFLG=1:TSK=-1
 IF TSK==TSKMAX-1 AND WINIDFLG==1THEN  WINIDFLG=0:TSK=TSKMAX:GOSUB @LOOPEND
 MOUSEF=1:GOSUB @MOUSE
 WINEND=0
 IF WINIDFLG==0THEN TSK=TSK-1
 IF WINIDFLG==1THEN TSK=TSK+1
 IF WINIDFLG==0AND TSK>=TSKMAX-1THEN GOSUB @FOREND1
' ?TSK"A";
'FPS
' IF MAINCNTL<FM THEN OFPS=OFPS+1 ELSE FPS=OFPS:OFPS=0:FM=MAINCNTL+60
' ?FPS
 IF RTFLG==1THEN RTFLG=0:RETURN
 RTFLG=0
GOTO @OTWLOOP
@SET_WXY
 WINX[TSK]=WINX
 WINY[TSK]=WINY
 WINX2[TSK]=WINX2
 WINY2[TSK]=WINY2
 WINSX[TSK]=WINSCX
 WINSY[TSK]=WINSCY
RETURN
'À½¸¦ ÖÌÞ
@FUNCTSK
 WINCLS=0
 IF WINFLG[TSK]==-1AND WINM[TSK]==1THEN GOSUB "@S_"+WINNAME$[TSK]:'WINFLG[TSK]=WINFLG
 IF WINFLG[TSK]==-1AND WINM[TSK]==0THEN GOSUB @WINFLAG:GOSUB@WINNEWSET:GOSUB "@S_"+WINNAME$[TSK]
 IF WINFLG[TSK]==-1AND WINM[TSK]==0AND WINCLS==1THEN WINM[TSK]=-1
 IF WINFLG[TSK]>0AND WINFLG[TSK]<10THEN GOSUB @FUNCWIN:RETURN
 IF WINFLG[TSK]>10THEN ELSE RETURN
 'ºÝ¿-Ù ±ÌßØ
 '11=Ë ±¸Ã¨ÌÞ
 '12=±¸Ã¨ÌÞ
 IF WINFLG[TSK]>=11THEN GOSUB @COMWIN:GOSUB "@COM_"+WINNAME$[TSK]:RETURN
 IF WINEXEFLG THEN WINEXEFLG=0:TSK=TSKMAX-1
RETURN
'WINDOWÖËÞ
 @FUNCWIN
  TSKB=TSK
  IF WINM[TSK]==0THEN GOSUB @FUNCWINSET
  IF WINIDFLG==0AND WINM[TSK]==0THEN GOSUB@WINDOW
  IF WINIDFLG==0AND WINM[TSK]==-1THEN WINCLS=1:GOSUB@WINDOW
  IF WINIDFLG==1AND WINM[TSK]==0THEN GOSUB@WINDOW:RETURN
  IF WINIDFLG==1AND WINM[TSK]==-1THEN WINCLS=1:GOSUB@WINDOW:RETURN
  GOSUB "@WIN_"+WINNAME$[TSK]
 WINDESIGN$=WINDFDESIGN$
 RETURN
  @FUNCWINSET
   WINX=WINX[TSK]
   WINY=WINY[TSK]
   WINX2=WINX2[TSK]
   WINY2=WINY2[TSK]
   WINSCX=WINSX[TSK]
   WINSCY=WINSY[TSK]
  RETURN
 @WINNEWSET
WINX=0WINY=0
  WINX2=64
 WINY2=64
  IF WINMOVSETY>=192-16THEN WINMOVSETY=192-16
  IF 256<=WINX2+WINMOVSETX THEN WINMOVSETX=256-WINX2
  WINSCX=WINMOVSETX
  WINSCY=WINMOVSETY
  WINMOVSETX=WINMOVSETX+8WINMOVSETY=WINMOVSETY+8
 RETURN
@FOREND
 TSK=TSKMAX-1:RETURN
RETURN
@FOREND1
 IF WINFLG[TSK]!=0THEN RETURN
 @FOREND2
 IF TSK==0THEN RETURN
 TSK=TSK-1
 IF WINFLG[TSK]==0AND TSK>-1THEN @FOREND2
RETURN
'¶ÞÒÝÉ¼®·¶ ÅÄÞ
@LOOPEND
 IDOUT=0
 GOSUB @KEY
 IF MOUSE!=OMOUSE THEN MOUSEI=MOUSE:GOSUB@MOUSECHR
 OMOUSE=MOUSE
 KEYFLG=0
 IF OTWSMENUF THEN GOSUB @OTWSMENU
 GOSUB @MOUSE
 IF OTWMENUF==1THEN GOSUB @OTWRMENU
 IF WINFLG[0]<2AND CLICKR==1AND OTWMENUF==0 THEN OTWMENUF=1:OTWRMX=MOUSEX:OTWRMY=MOUSEY
 GOSUB @OTWTSKBARL
 GLINE 0,182,255,182,1
 GLINE 0,183,255,183,15
 GFILL 0,184,255,191,13
 GPUTCHR 0,184,"BGF",7,1,1
 GPUTCHR 8,184,"BGF",8,1,1
 GPAGE 0,WINGPAGE,!WINGPAGE:WINGPAGE=(WINGPAGE+1)%2
 GCLS OTWBGCL
'IF MAINCNTL-TSKBARML>300 THEN GOSUB @OTWTSKBAR
IF TSKBARML THEN IF TSKBARML==1THEN GOSUB@OTWTSKBAR:TSKBARML=0ELSE TSKBARML=TSKBARML-1
 WINENDF=0
 IF MOUSEX>=0AND MOUSEX<=16AND MOUSEY>=184AND MOUSEY<=191AND CLICK3 THEN OTWSMENUF=1:CLICK=0
'190+3
 IF MAINCNTL<FM THEN OFPS=OFPS+1 ELSE FPS=OFPS:OFPS=0:FM=MAINCNTL+60
'?FPS
 MOUSE=0
RETURN

@OTWSMENU
 WFX=1
 WFY=180-31'65
 WFX2=73
 WFY2=180
' IF 0<=MOUSEX AND 74>=MOUSEX AND 191>=MOUSEY AND 64<=MOUSEY THEN ELSE IF CLICK THEN OTWSMENUF=0
 WINMK=OTWSMENUK
 WINMKS=OTWSMENUKS
 WINMX=-1
 WINMX2=74
 WINMY=0'24
 WINMC=13WINMC2=4WINMC3=14
 WINM$[0]="PROGRAM
 WINM$[1]="RUN
 WINM$[2]="HELP
 WINM$[3]="EXIT
 
 WINMMAX=3
 GOSUB @WINMENU2
 OTWSMENUK=WINMK
 OTWSMENUKS=WINMKS
 OTWSM=WINM==3
 IF CLICK THEN OTWSMENUF=0
 IF WINM==0 THEN GOTO@OTWSMENUP
 IF!WINMA THEN RETURN
 IF OTWSM AND CLICK THEN GOSUB @OTWPOWER:TSK=TSKMAX-1
 IF WINM==1AND CLICK THEN WINEXE$="RUN":GOTO@WINEXE
 IF WINM==2AND CLICK THEN WINEXE$="HELP":GOTO@WINEXE
RETURN
@OTWSMENUP
 WINMK=OTWSMENUMK2
 WINMKS=OTWSMENUMKS2
 WINMX=74
 WINMY=-8
 WINMX2=116
 WINMC=13WINMC2=4WINMC3=14
 WINMMAX=1
 WINM$[0]="GAME
 WINM$[1]="TOOL
 GOSUB@WINMENU2
 OTWSMENUMK2=WINMK
 OTWSMENUMKS2=WINMKS
 IF WINM==0THEN GOTO@OTWSMENUPG
 IF WINM==1THEN GOTO@OTWSMENUPT
RETURN
@OTWSMENUPT
 WINMK=OTWSMENUMKT
 WINMKS=OTWSMENUMKST
 WINMY=-16
 WINMX=116
 WINMX2=170
 WINMMAX=4
 WINMC=13WINMC2=4WINMC3=14
 WINM$[0]="PAINT
 WINM$[1]="SETTING
 WINM$[2]="CLOCK
 WINM$[3]="LED
 WINM$[4]="MEV
 GOSUB @WINMENU2
 OTWSMENUMKT=WINMK
 OTWSMENUMKST=WINMKS
 IF!WINMA THEN RETURN
 IF WINM==0AND CLICK THEN WINEXE$="HTNP":GOTO @WINEXE
 IF WINM!=-1AND CLICK THEN WINEXE$=WINM$[WINM]:GOSUB @WINEXE
RETURN
@OTWSMENUPG
 WINMK=OTWSMENUMKG
 WINMKS=OTWSMENUMKSG
 WINMY=-16
 WINMX=116
 WINMX2=162
 WINMMAX=4
 WINMC=13WINMC2=4WINMC3=14
 WINM$[0]="CAVE
 WINM$[1]="GAME1
 WINM$[2]="MINE
 WINM$[3]="INV
 WINM$[4]="POKO
 GOSUB @WINMENU2
 OTWSMENUMKG=WINMK
 OTWSMENUMKSG=WINMKS
 IF!WINMA THEN RETURN
 IF WINM!=4AND WINM!=-1AND CLICK THEN WINEXE$=WINM$[WINM]:GOSUB @WINEXE
 IF WINM==4AND CLICK THEN WINEXE$="POKOPOKO":GOSUB @WINEXE
RETURN
@OTWPOWER
 GCOPY WINGPAGE,0,0,255,191,0,0,1
 GPAGE 0,WINGPAGE,!WINGPAGE
 FOR I=-128TO 128GLINE I*2,0,(I*2)+255,255,14NEXT
 GPAGE 0,!WINGPAGE,WINGPAGE
 FOR I=-128TO 128GLINE I*2,0,(I*2)+255,255,14NEXT
 GPAGE 0,WINGPAGE,WINGPAGE
 OTWPOWERM=1
 FOR I=0TO 1
 I=F==3
 GPAGE 0,!WINGPAGE,WINGPAGE
 GOSUB @MOUSE
 GOSUB @WIN_POWER
 WINGPAGE=!WINGPAGE
 NEXT
 GPAGE 0,!WINGPAGE,WINGPAGE
RETURN
@WIN_POWER
 WINACTV=1
 WINFLG[TSKMAX]=2
 WINFLG=2
 WINDESIGN$="NORMAL"
 WIN_MODE=1
 WINX2=128
 WINY2=64
 WINX=0
 WINY=0
 WINSCX=64
 WINSCY=96-32
 WINIDFLG=0
 TSK=TSKMAX
 WINTTL$="OTYAX-EXIT"
 GOSUB @WINDOW
 WINSX=8:WINSY=0WINSTR$="OTYAXÉ¼­³Ø®³"WINSC=1
 GOSUB @WINSTRPUT
 WINRX=4
 WINRY=16
 WINRSTR$="ÌßÛ¸Þ×ÑÉ¼­³Ø®³
 WINRF=OTWPOWERM
 GOSUB @WINRADBTN
 OTWPOWERM=WINRF
 WINRX=4
 WINRY=26
 WINRSTR$="ÌßÛ¸Þ×ÑÉ»²·ÄÞ³
 WINRF=!OTWPOWERM
 GOSUB @WINRADBTN
 OTWPOWERM=!WINRF
 WINBX=54
 WINBY=35
 WINBSTR$="OK"
 GOSUB @WINBTN
 IF WINBTNF THEN 
 IF WINBTNF*OTWPOWERM THEN @OTWEXIT
 IF WINBTNF*!OTWPOWERM THEN GOSUB@OTWINISAV:ACLS:GOTO@SOF
 F=0
 IF MOUSEX>=WX2-9 AND MOUSEX<=WX2 THEN F=1
 IF F==1AND MOUSEY>=WY AND MOUSEY<=WY+8 THEN F=2
 IF F==2AND CLICK3 THEN F=3
RETURN

@OTWEXIT
 BGCLR
 GPAGE 0,0,0
 GCLS OTWBGCL
 GOSUB @WINDOW
 WINSX=0
 WINSY=0
 WINSTR$="¼­³Ø®³Á­³..."
 WINSC=1GOSUB @WINSTRPUT
 GOSUB @OTWINISAV
GOTO @ALLCLEAR

@OTWTSKBARL
 TSX=2
 FOR TSI=0TO TSKMAX-1
  TSF=0
  IF TSKBAR[TSI]==0THEN @OTWTSKBARLI
  IF MOUSEX>=TSX*8AND MOUSEX<=TSX*8+8*5 THEN TSF=1
  IF TSF==1 AND MOUSEY>=184AND MOUSEY<=191AND CLICK THEN TSF=2
  IF TSF==2THEN GOSUB @OTWTSKBARLJ
  TSX=TSX+5
@OTWTSKBARLI
 NEXT
RETURN
@OTWTSKBARLJ
WIN_ID=TSKBAR[TSI]
GOSUB @WINID2TSK
IF WINID_RESULT THEN RETURN

TSK=WINID_TSK
GOSUB@WINSWP
CLICK=0
CLICKF=0
CLICK2=0
CLICK3=0
TSI=TSKMAX
RETURN
 FOR TSI=0TO TSKBARM
  TSF=0
  IF MOUSEX>=TSI*5*8+16AND MOUSEX<=(TSI+1)*5*8+16 THEN TSF=1
  IF TSF==1 AND MOUSEY>=184AND MOUSEY<=191AND CLICK THEN TSF=2
  IF TSF==2THEN TSK=TSI:GOSUB@WINSWP:GOSUB @OTWTSKBAR:CLICK=0:CLICKF=0:CLICK2=0:CLICK3=0:
  IF TSF==2THEN TSI=TSKBARM
 NEXT
RETURN
@OTWTSKBAR
' TSKBARML=MAINCNTL
 TSX=2
 BGFILL 1,0,23,31,23,0,0,0,0
 FOR TSI=0TO TSKMAX-1
  IF TSKBAR[TSI]==0THEN @OTWTSKBARI_
  WIN_ID=TSKBAR[TSI]
  GOSUB @WINID2TSK
  IF WINID_RESULT THEN @OTWTSKBARI_
  IF LEN(WINTTL$[WINID_TSK])==0THEN @OTWTSKBARI_
  FOR TSJ=0TO 5
   BGPUT 1,TSJ+TSX,23,ASC(MID$(WINTTL$[WINID_TSK],TSJ,1)),WINFLG[WINID_TSK]<2,0,0
   IF LEN(WINTTL$[WINID_TSK])<=TSJ+1THEN TSJ=6
  NEXT
  TSX=TSX+5
@OTWTSKBARI_
 NEXT
RETURN
 GOSUB @TSKMAX
 BGFILL 1,0,23,31,23,0,0,0,0
 TSKBARM=TSKM-1
 FOR TSI=0TO TSKM-1
  @OTWTSKBARI
  FOR TSJ=0TO 5
   IF LEN(WINTTL$[TSI])<=TSJ THEN TSJ=6:GOTO @OTWTSKBARJ
   BGPUT 1,TSJ+TSI*5+2,23,ASC(MID$(WINTTL$[TSI],TSJ,1)),1,0,0
   @OTWTSKBARJ
  NEXT
 NEXT
RETURN
@OTWRMENU
 WFX=0
 WFX2=255
 WFY=0
 WFY2=191
 WINM=-1
 WINM$[0]="RUN.OTW"
 WINM$[1]="GAME
 WINM$[2]="STOP
 WINMMAX=2
 WINMK=OTWRMK
 WINMKS=OTWRMKS
 WINMX=OTWRMX
 WINMX2=OTWRMX+64
 WINMY=OTWRMY
 WINMY2=OTWRMY+8
 
 GOSUB @WINMENU2
 OTWRMK=WINMK
 OTWRMKS=WINMKS
 IF CLICKF==1THEN OTWMENUF=0
 IF WINM==0AND CLICK==1AND WINMA==1THEN WINEXE$="RUN":GOSUB @WINEXE:OTWMENUF=0
 IF WINM==2AND CLICK==1AND WINMA==1THEN GOSUB @STOP
 IF WINM==1THEN GOTO @OTWRMENUG
RETURN
@OTWRMENUG
 WINM$[0]="CAVE.OTW
 WINM$[1]="GAME1.OTW
 WINMMAX=1
 WINMK=OTWRGMK
 WINMKS=OTWRGMKS
 WINMX=OTWRMX+64
 WINMX2=WINMX+64+8
 WINMY=OTWRMY+8
 WINMY2=WINMY+8
 GOSUB @WINMENU2
 OTWRGMK=WINMK
 OTWRGMKS=WINMKS
 F=0
 IF WINM==0THEN WINEXE$="CAVE":F=1
 IF WINM==1THEN WINEXE$="GAME1":F=1
 IF F AND CLICK==1AND WINMA THEN GOSUB @WINEXE
RETURN
@MOUSESET
 FOR MSI=0TO MOUSEMAX-1
  CHRREAD("SPS1",MOUSE[MSI]*4),MSC$
  CHRREAD("SPS1",MOUSE[MSI]*4+1),MSC1$
  CHRREAD("SPS1",MOUSE[MSI]*4+2),MSC2$
  CHRREAD("SPS1",MOUSE[MSI]*4+3),MSC3$
  CHRSET "SPU",MSI*4,MSC$
  CHRSET "SPU",MSI*4+1,MSC1$
  CHRSET "SPU",MSI*4+2,MSC2$
  CHRSET "SPU",MSI*4+3,MSC3$
 NEXT
RETURN
@MOUSECHR
 SPCHR MOUSESP,MOUSEI
RETURN
@MOUSE
'WAIT96
'SE112
 IF MOUSEMODE==0THEN MOUSEX=TCHX:MOUSEY=TCHY:GOTO @MOUSEKIP
 TX=TCHX:TY=TCHY
 TC=TCHST
 IF TC==1AND OT==0THEN OX=TX:OY=TY:TF=1
 IF TCHST==0THEN TF=0
 IF TF==1 THEN MOUSEX=MOUSEX+(TX-OX):MOUSEY=MOUSEY+(TY-OY):OX=TX:OY=TY:TF=1
 IF MOUSEX<0THEN MOUSEX=0
 IF MOUSEY<0THEN MOUSEY=0
 IF MOUSEX>=255THEN MOUSEX=255
 IF MOUSEY>=191THEN MOUSEY=191
 OT=TC
@MOUSEKIP
SPOFS MOUSESP,MOUSEX,MOUSEY
 IF MOUSEF==1THEN MOUSEF=0:RETURN
 B=BUTTON()
 F=0
 CLICK=0
 CLICK3=0
 C=CLICKBTN
 IF (B AND C)==C AND (MOUSEOB AND C)!=C THEN F=1
 IF F==1 THEN CLICK=1MOUSEFL=MAINCNTL
 F=0IF(B AND C)!=C AND (MOUSEOB AND C)==C THEN F=1
 IF F==1 THEN CLICK3=1MOUSEFL=0
 CLICK2=0
 CLICKR2=0
 CLICKR3=0
 IF B AND C THEN CLICK2=1
 C=CLICKBTNR
 F=0
 IF (B AND C)==C AND (MOUSEOB AND C)!=C THEN F=1
 CLICKR=0
 IF F==1 THEN CLICKR=1MOUSERFL=MAINCNTL
 F=0IF(B AND C)!=C AND (MOUSEOB AND C)==C THEN F=1
 IF F==1 THEN CLICKR3=1MOUSERFL=0
 IF B AND C THEN CLICKR2=1
 
 MOUSEOB=BUTTON()
 CLICKF=CLICK OR CLICKR
RETURN
'---
@WIN_XY
 WINX=WINX[TSK]
 WINY=WINY[TSK]
 WINX2=WINX2[TSK]
 WINY2=WINY2[TSK]
 WINSCX=WINSX[TSK]
 WINSCY=WINSY[TSK]
RETURN
@WINDOW
 WINDEGW=0
 GOSUB "@DGS_"+WINDESIGN$
 IF WIN_MODE==0THEN GOSUB @WIN_XY
 WINDEGY=WINDEGY+1
 WX=WINX+WINSCX
 WY=WINY+WINSCY
 WX2=WINX2+WINSCX'+WINDEGX'+2
 WY2=WINY2+WINSCY'+WINDEGY'+10
 WFX=WX+WINDEGX
 WFY=WY+WINDEGY
 WFX2=WX2-WINDEGX2
 WFY2=WY2-WINDEGY2
 IF WINACTV==1THEN GOSUB @WINDOW_A
 IF WINIDFLG==1AND WINDEGW==0THEN @WINDOWS
 GOSUB "@DEG_"+WINDESIGN$
WINBG=WINDEFAUTBG
 RETURN
 @WINDOW_A
  WINACTVX=WX
  WINACTVY=WY
  WINACTVX2=WX2
  WINACTVY2=WY2
  WINACTVFX=WFX
  WINACTVFY=WFY
  WINACTVFX2=WFX2
  WINACTVFY2=WFY2
 RETURN
 @DGS_NORMAL
  WINDEGY=10WINDEGY2=1WINDEGX=1WINDEGX2=1
 RETURN
 @DEG_NORMAL
 GFILL WX+1,WY+10,WX2-1,WY2-1,WINBG
 GBOX WX,WY,WX2,WY2,13
 GLINE WX+1,WY+10,WX2-1,WY+10,13
 GFILL WX+1,WY+1,WX2-1,WY+9,4-(3*(WINACTV==0))
 GFILL WX2-1,WY+1,WX2-9,WY+9,13
 GLINE WX2-6,WY+2,WX2-1,WY+7,0
 GLINE WX2-7,WY+2,WX2-2,WY+7,0

 GLINE WX2-1,WY+2,WX2-6,WY+7
 GLINE WX2-2,WY+2,WX2-7,WY+7
 WINSTR$=WINTTL$
 IF LEN(WINTTL$)*8>=WINX2-11THEN WINSTR$=MID$(WINTTL$,0,(WINX2/8)-2)+"."
 WINSX=0:WINSY=-9:WINSC=0
 GOSUB @WINSTRPUT
 RETURN
 @DGS_VISUAL
  WINDEGY=10WINDEGY2=1WINDEGX=1WINDEGX2=1
 RETURN
 @DEG_VISUAL
 'GBOX WX,WY,WX2,WY2,4
 B=4+(2*(TSK!=0))
 GLINE WX+1,WY,WX2-1,WY,B
 GLINE WX+1,WY2,WX2-1,WY2,B
 GLINE WX,WY+1,WX,WY2-1,B
 GLINE WX2,WY+1,WX2,WY2-1,B
 GLINE WX+1,WY+10,WX2-1,WY+10,B
 GFILL WX+1,WY+1,WX2-1,WY+9,B
 GFILL WX+1,WY+10,WX2-1,WY2-1,WINBG

'xÎÞÀÝ 
 GFILL WX2-2,WY+1,WX2-8,WY+8,2
 GLINE WX2-2,WY+1,WX2-8,WY+1,2
 GLINE WX2-2,WY+8,WX2-8,WY+8,2
 GLINE WX2-1,WY+2,WX2-1,WY+7,2
 GLINE WX2-9,WY+2,WX2-9,WY+7,2
'x
 GLINE WX2-2,WY+2,WX2-7,WY+7,15
 GLINE WX2-3,WY+2,WX2-8,WY+7,15

 GLINE WX2-7,WY+2,WX2-2,WY+7,15
 GLINE WX2-8,WY+2,WX2-3,WY+7,15
 IF WINACTV==1THEN WINSC=1:WINSX=2WINSY=-8WINSTR$=WINTTL$GOSUB@WINSTRPUT
 IF WINACTV==1THEN WINSC=1:WINSX=3WINSY=-8WINSTR$=WINTTL$GOSUB@WINSTRPUT
 WINSC=15-(1*!WINACTV)
 IF WINACTV==1THEN  WINSX=1:WINSY=-10:WINSTR$=WINTTL$:GOSUB @WINSTRPUT
 WINSX=0:WINSY=-10:WINSTR$=WINTTL$:GOSUB @WINSTRPUT
 RETURN
 @WINDOWS
WINBG=WINDEFAUTBG
 '-²ÄÞ³ÌÞ-
'RESIZE
 F=0IF WINFLG==3OR WINFLG==4THEN F=1
 IF F AND MOUSEX>SCRSIZE_X THEN MOUSEX=SCRSIZE_X
 IF F AND MOUSEY>SCRSIZE_Y THEN MOUSEY=SCRSIZE_Y
 F=0
 IF WINFLG!=4AND WINR[TSK]==1AND MOUSEX>=WX2-4 AND MOUSEX<=WX2 THEN F=1
 IF WINACTV==1AND F==1AND MOUSEY>=WY2-4 AND MOUSEY<=WY2 THEN F=2:MOUSE=1
'BUGÉÀÒTSK=TSKMAX-1
 IF F==2AND CLICK==1THEN GOSUB @WINRESIZE:WINFLG=4:WINFLG[TSK]=4: WINIFLG=1TSK=TSKMAX-1:RETURN
 IF WINFLG==4THEN GOSUB @WINRESIZE
'x Button
 F=0
 IF MOUSEX>=WX2-9 AND MOUSEX<=WX2 THEN F=1
 IF F==1AND MOUSEY>=WY AND MOUSEY<=WY+8 THEN F=2
 IF F==2AND CLICK==1AND WINACTV==1THEN @WINCLOSEGT
 IF F==2AND CLICK==1AND WINACTV!=1THEN @WINSWP

 F=0:IF MOUSEX>=WX AND MOUSEX<=WX2-9 THEN F=1
 IF F==1 AND MOUSEY>=WY AND MOUSEY<=WFY THEN F=2
 IDF=0
 IF F==2 AND CLICK==1AND IDOUT==0THEN WINFLG=3:IDOUFLG=1:IDF=1GOSUB @WINSWP:RETURN
 IF WINFLG==3THEN IDOUT=1:GOSUB @WINIDOU2
 F=0:IDOUFLG=0:IF MOUSEX>=WX AND MOUSEX<=WX2 THEN F=1
 IF F==1 AND MOUSEY>=WFY AND MOUSEY<=WY2 THEN F=2
 IF F==2 AND CLICK==1THEN WINFLG[TSK]=2:IF !IDF THEN GOSUB @WINSWP
 F=0
 IF MOUSEX>=WX AND MOUSEX<=WX2 THEN ELSE F=2
 IF MOUSEY>=WY AND MOUSEY<=WY2 THEN ELSE F=2
 IF F==2AND CLICK==1AND WINFLG[TSK]>=2THEN WINFLG[TSK]=1:WINFLG=1
 WINCLS=0
 
RETURN

 'ÑØÔØ»¸¼Þ® ½ÍÞÃ NULL
        'NULLÊÅ²¶× FALSEÀÞ¯ÀØ
@WINCLOSE
'B-0
'09/02
 FOR WCI=0 TO TSKBAR_I
  IF WINID[FLG]==TSKBAR[WCI]THEN TSKBAR[WCI]=0
 NEXT
 TSKBAR_I=TSKBAR_I-1
 IF TSKBAR_I<0THEN TSKBAR_I=0
'-----
 WINMLT[TSK]=0
 WINFLG[TSK]=0
 WINTTL$[TSK]=""
 WINNAME$[TSK]=""
 WINM[TSK]=0
 WINX[TSK]=0
 WINY[TSK]=0
 WINX2[TSK]=0
 WINY2[TSK]=0
 WINSX[TSK]=0
 WINSY[TSK]=0
 WINID[TSK]=0
 WINMES_I[TSK]=0
 WINMESI=TSK
 GOSUB @WINNEW_MES
 WINR[TSK]=0
 WINIFLG=1

 FOR WCI=TSK TO TSKMAX-2
  WCJ=WCI+1
'B-0
  WINNAME$[WCI]=WINNAME$[WCJ]
  WINTTL$[WCI]=WINTTL$[WCJ]
  WINMLT[WCI]=WINMLT[WCJ]
  WINFLG[WCI]=WINFLG[WCJ]
 '---------------------
  WINM[WCI]=WINM[WCJ]
  WINX[WCI]=WINX[WCJ]
  WINY[WCI]=WINY[WCJ]
  WINX2[WCI]=WINX2[WCJ]
  WINY2[WCI]=WINY2[WCJ]
  WINSX[WCI]=WINSX[WCJ]
  WINSY[WCI]=WINSY[WCJ]
 '---------------------
  FOR WINNEW_MES=0TO WINMESMAX-1
   WINMES$[WCI,WINNES_MES]=WINMES$[WCJ,WINNES_MES]
   WINMES_ID[WCI,WINNES_MES]=WINMES_ID[WCJ,WINNES_MES]
  NEXT
  WINID[WCI]=WINID[WCJ]
  WINMES_I[WCI]=WINMES_I[WCJ]
  WINR[WCI]=WINR[WCJ]
@WINCS
 NEXT
WCI=0
WINEND=1
TSK=TSKMAX-1
 TSKBARML=1'1024
RETURN

 '¼­³Ø®³¼Ï½¡
@WINCLOSEGT
 IF WINCLS==1THEN WINCLBL$="@C_"+WINNAME$[TSK]:GOTO WINCLBL$
 GOSUB @WINCLOSE
 MOUSEI=2:GOSUB @MOUSECHR
 GPAGE 0,!WINGPAGE,!WINGPAGE
 GFILL (6*8)+4,128-64+4,6*8+19*8+4,128+4,1
 GFILL (6*8),128-64,6*8+19*8,128,13
 P$="·®³¾²¼­³Ø®³¼Ã²Ï½..."
 P=6*8
 FOR WCIP=0TO LEN(P$)-1
  GPUTCHR P,128-40,"BGF",ASC(MID$(P$,WCIP,1)),1,1
  P=P+8
 NEXT
 FOR WCIP=0TO WINDLTWAIT-1
  GOSUB @MOUSE
  WAIT 1
 NEXT
 GPAGE 0,WINGPAGE,!WINGPAGE
 MOUSEI=0:GOSUB @MOUSECHR
RETURN

@WINIDOU2
'?WINSX[TSK]
'?TSK
 IF CLICK==1THEN WINSABX=WINSCX-MOUSEX:WINSABY=WINSCY-MOUSEY
 IF WINMOVMODE>0THEN @WINIDOU21
 WINSCX=WINX+MOUSEX+WINSABX
 WINSCY=WINX+MOUSEY+WINSABY
 IF CLICK2==0THEN WINFLG[0]=2:MX=0:MY=0
 'WINIDFLG=0:GOSUB @WINDOW:WINIDFLG=1
 'GCOPY !M,WX,WY,WX2,WY2,WINX+WINSCX,WINY+WINSCY,1
 GBOX WINX+WINSCX,WINY+WINSCY,WINX2+WINSCX,WINY2+WINSCY,WINMOVBOXC
RETURN
@WINIDOU21
'?WINSABX,WINSABY
' GBOX WINX+MOUSEX,WINY+MOUSEY,WINX2+MOUSEX,WINY2+MOUSEY,WINMOVBOXC
 GBOX WINX+MOUSEX+WINSABX,WINY+MOUSEY+WINSABY,WINX2+MOUSEX+WINSABX,WINY2+MOUSEY+WINSABY,WINMOVBOXC
 IF WINMOVMODE==2THEN GCOPY WINGPAGE,WX,WY,WX2,WY2,WINX+MOUSEX+WINSABX,WINY+MOUSEY+WINSABY,1
 IF CLICK2==0THEN WINFLG[0]=2:MX=0:MY=0: WINSCX=MOUSEX+WINSABX:WINSCY=MOUSEY+WINSABY
RETURN

@WINRESIZE
 IF CLICK2==0THEN WINFLG[TSK]=2WINFLG=2
 IF CLICK==1THEN WINSABX=WINSCX+MOUSEX-(WINSCX+WINX2):WINSABY=WINSCY+MOUSEY-(WINSCY+WINY2):RETURN
 F=0
 GBOX WINSCX,WINSCY,WINSCX+WINX2,WINSCY+WINY2,WINMOVBOXC
 IF MOUSEX-WINSABX<28THEN F=1
 IF MOUSEY-WINSABY<WINDEGY+4 THEN F=F+2
IF F AND 1THEN WINX2=28 ELSE  WINX2=MOUSEX-WINSABX
IF F AND 2THEN WINY2=WINDEGY+4 ELSE  WINY2=MOUSEY-WINSABY
RETURN

 123
1   
2   
'¾ÝÄ³Å×À¹
'      „¾  „y„¾·
'   __  „¾„¾„y„¾„¾
'  |  |   „¾„¾„¾
' |    |  „y„¾„¾
'„y„z„z„z„z„z„z„x „y„¾„¾
'  „y¥¥„x   „y„¾„¾
'  „y „z„x   „y„¾„¾
'„¼„¹„¹ „x„w„x  |„¾„¾
'  „y„y„z „x„z-„¾„¾„¾
'„¾„¾„¾„¾„¾„¾„¾„¾„¾„¾„¾„¾
'„¾„¾„¾„¾„¾„¾„¾„¾„¾„¾„¾„¾
 „z„z  „z„z„z„z„z„z„z„z„z„z„z
„y„¹ „x„y           „x
„y „¹„x„y ±ËËËËËËËË „x
 „|„{ „y           „x
     „w„w„w„w„w„w„w„w„w„w„w
@WINSWP
 MX=MOUSEX:MY=MOUSEY
 'À½¸¦¾ÝÄ³Í
 '½ÃÞÆ ¾ÝÄ³Å× ½·¯Ìß
 IF TSK==0THEN @WINSWPSKP

 '5     7         5      
 'SWAPÊ ¶ÅØ×¸ÀÞ¶Þ Ì¼¾ÞÝÀÞ
' SWAP WINFLG[0],WINFLG[TSK]
' SWAP WINTTL$[0],WINTTL$[TSK]
' SWAP WINNAME$[0],WINNAME$[TSK]
 WINSSSF=WINFLG[TSKB]
 WINSSST$=WINTTL$[TSKB]
 WINSSSN$=WINNAME$[TSKB]
'B-0 
 WINSSSL=WINMLT[TSKB]
 WINSSSM=WINM[TSKB]
 WINSSSX=WINX[TSKB]
 WINSSSY=WINY[TSKB]
 WINSSSX2=WINX2[TSKB]
 WINSSSY2=WINY2[TSKB]
 WINSSSCX=WINSX[TSKB]
 WINSSSCY=WINSY[TSKB]
 WINSSSID=WINID[TSKB]
 WINSSSMES_I=WINMES_I[TSKB]
 WINSSSR=WINR[TSKB]
 FOR WINNEW_MES=0TO WINMESMAX-1
  WINMESBUF$[WINNES_MES]=WINMES$[TSKB,WINNES_MES]
  WINMESBUF_ID[WINNES_MES]=WINMES_ID[TSKB,WINNES_MES]
 NEXT
'2
 FOR WS=TSKB TO 1STEP -1
'B-0
  WINSSL=WINMLT[WS-1]
  WINSSF=WINFLG[WS-1]
  WINSST$=WINTTL$[WS-1]
  WINSSN$=WINNAME$[WS-1]
  WINSSM=WINM[WS-1]
  WINSSX=WINX[WS-1]
  WINSSY=WINY[WS-1]
  WINSSX2=WINX2[WS-1]
  WINSSY2=WINY2[WS-1]
  WINSSCX=WINSX[WS-1]
  WINSSCY=WINSY[WS-1]
  WINSSID=WINID[WS-1]
  WINSSMES_I=WINMES_I[WS-1]
  WINSSR=WINR[WS-1]
  IF WINSSF>=2THEN WINSSF=1
'B-0
  WINMLT[WS]=WINSSL
  WINFLG[WS]=WINSSF
  WINTTL$[WS]=WINSST$
  WINNAME$[WS]=WINSSN$
  WINM[WS]=WINSSM
  WINX[WS]=WINSSX
  WINY[WS]=WINSSY
  WINX2[WS]=WINSSX2
  WINY2[WS]=WINSSY2
  WINSX[WS]=WINSSCX
  WINSY[WS]=WINSSCY
  FOR WINNEW_MES=0TO WINMESMAX-1
   WINMES$[WS,WINNES_MES]=WINMES$[WS-1,WINNES_MES]
   WINMES_ID[WS,WINNES_MES]=WINMES_ID[WS-1,WINNES_MES]
  NEXT
  WINID[WS]=WINSSID
  WINMES_I[WS]=WINSSMES_I
  WINR[WS]=WINSSR
 NEXT
' WINFLG[1]=WINFLG[0]
'WINTTL$[1]=WINTTL$[0]
'WINNAME$[1]=WINNAME$[0]
' WINM[1]=WINM[0]
' WINX[1]=WINX[0]
' WINY[1]=WINY[0]
' WINX2[1]=WINX2[0]
' WINY2[1]=WINY2[0]
' WINSX[1]=WINSX[0]
' WINSY[1]=WINSY[0]

'B-0
 WINMLT[0]=WINSSSL
 WINFLG[0]=2'WINSSSF
 WINTTL$[0]=WINSSST$
 WINNAME$[0]=WINSSSN$
 WINM[0]=WINSSSM
 WINX[0]=WINSSSX
 WINY[0]=WINSSSY
 WINX2[0]=WINSSSX2
 WINY2[0]=WINSSSY2
 WINSX[0]=WINSSSCX
 WINSY[0]=WINSSSCY
 FOR WINNEW_MES=0TO WINMESMAX-1
  WINMES$[0,WINNES_MES]=WINMESBUF$[WINNES_MES]
  WINMES_ID[0,WINNES_MES]=WINMESBUF_ID[WINNES_MES]
 NEXT
 WINID[0]=WINSSSID
 WINMES_I[0]=WINSSSMES_I
 WINR[0]=WINSSSR
' FOR WS=TSK+1 TO TSKMAX-2
'  WINFLG[WS]=WINFLG[WS+1]
'  WINTTL$[WS]=WINTTL$[WS+1]
'  WINNAME$[WS]=WINNAME$[WS+1]
'  WINM[WS]=WINM[WS+1]
'  WINX[WS]=WINX[WS+1]
'  WINY[WS]=WINY[WS+1]
'  WINX2[WS]=WINX2[WS+1]
'  WINY2[WS]=WINY2[WS+1]
'  WINSX[WS]=WINSX[WS+1]
'  WINSY[WS]=WINSY[WS+1]
' NEXT

 @WINSWPSKP
' IF TSK==0AND IDOUFLG!=1 THEN  WINIFLG=1RETURN
 TSKBARML=1'1024
 WINEND=1
 WINIFLG=1
 TSK=TSKMAX-1
 WINIFLG=1
 IF IDOUFLG!=1 THEN RETURN
 WINFLG[0]=3
 GOSUB @WINIDOU2
 TSK=TSKMAX-1
 MX=MOUSEX:MY=MOUSEY
RETURN

@WINFLAG
 WINM[TSK]=WIN_MODE
 WINR[TSK]=WIN_R
 WIN_MODE=0WIN_R=0
 FOR WFI=0TO TSKMAX-1
  IF WINFLG[WFI]==2THEN WFF=1
 NEXT
 WINIFLG=0
 IF WFF==0THEN WINFLG=2 ELSE WINFLG=1
 WINFLG=2
 RETURN
RETURN

@WINEXE
' IF WINFLG[TSKMAX-1]!=0THEN RETURN
 WEK=0
 IF LEN(WINEXE$)<=0OR LEN(WINEXE$)>12THEN BEEP 2RETURN
 FOR WE=0TO LEN(WINEXE$)-1
  WEM=0
  WE$=MID$(WINEXE$,WE,1)
  WEA=ASC(WE$)
IF WEA>=97AND WEA<=122THEN WEA=WEA-32:WEM=1:WE$=CHR$(WEA)
IF WEM THEN WINEXE$=MID$(WINEXE$,0,(WE-1>0)*(WE-1))+WE$+MID$(WINEXE$,WE,256*(LEN(WINEXE$)-1!=WE))
  IF(WEA>=65 AND WEA<=90)OR WEA==95OR (WEA>=48 AND WEA<=57)THEN ELSE WEK=1
 NEXT
 IF WEK==1THEN BEEP 2RETURN
 WJ=1'10/24
 FOR WE=0TO TSKMAX-1
  IF WINFLG[WE]!=0THEN WJ=WJ+1
 NEXT
 IF WJ>=TSKMAX THEN BEEP 2:RETURN
'±...±±...
 WINIFLG=1
'³´´
 FOR WE=TSKMAX-2TO 0STEP -1
  WINEEN$=WINNAME$[WE+0]
  WINEET$=WINTTL$[WE+0]
'B-0
  WINEEL=WINMLT[WE+0]
  WINEEF=WINFLG[WE+0]
  WINEEM=WINM[WE+0]
  WINEEX=WINX[WE+0]
  WINEEY=WINY[WE+0]
  WINEEX2=WINX2[WE+0]
  WINEEY2=WINY2[WE+0]
  WINEESX=WINSX[WE+0]
  WINEESY=WINSY[WE+0]
  WINEER=WINR[WE+0]

'«¯©
'B-0
  WINNAME$[WE+1]=WINEEN$
  WINTTL$[WE+1]=WINEET$
  WINMLT[WE+1]=WINEEL
  IF WINEEF>=2THEN WINEEF=1
  WINFLG[WE+1]=WINEEF
  WINM[WE+1]=WINEEM
  WINX[WE+1]=WINEEX
  WINY[WE+1]=WINEEY
  WINX2[WE+1]=WINEEX2
  WINY2[WE+1]=WINEEY2
  WINSX[WE+1]=WINEESX
  WINSY[WE+1]=WINEESY
  FOR WINNEW_MES=0TO WINMESMAX-1
   WINMES$[WE+1,WINNEW_MES]=WINMES$[WE,WINNEW_MES]
   WINMES_ID[WE+1,WINNEW_MES]=WINMES_ID[WE,WINNEW_MES]
  NEXT
  WINID[WE+1]=WINID[WE]
  WINMES_I[WE+1]=WINMES_I[WE]
  WINR[WE+1]=WINEER
 NEXT


'B-0
 WINNAME$[0]=WINEXE$
 WINTTL$[0]=""
 WINFLG[0]=-1
 WINMLT[0]=-1
 WINM[0]=0
 WINX[0]=0
 WINY[0]=0
 WINX2[0]=0
 WINY2[0]=0
 WINSX[0]=0
 WINSY[0]=0
 WINMESI=0
 GOSUB @WINNEW_MES
 WINID=(WINID+1)%524287'over flowÀ²»¸
 WINID[0]=WINID
 WINMES_I[0]=-1
 WINR[0]=WINR
'09/02
 IF TSKBAR[TSKBAR_I]!=0THEN @WINEXE_BAR

 TSKBAR$[TSKBAR_I]=WINEXE$
 TSKBAR[TSKBAR_I]=WINID
 GOTO @WINEXE_BAR_
 @WINEXE_BAR
 FOR WE=0TO TSKMAX-1
  IF TSKBAR[WE]==0THEN WE=TSKMAX: TSKBAR$[WE]=WINEXE$:TSKBAR[WE]=WINID
 NEXT
 @WINEXE_BAR_
 TSKBAR_I=(TSKBAR_I+1)%TSKMAX
 TSKBARML=2'1024
'-----
 WINEXEFLG=1
' TSK=TSKMAX-1
 WINEND=1
RETURN
@TSKMAX
 TSKM=0
 FOR TI=0TO TSKMAX-1
  TSKM=TSKM+!!WINFLG[TI]
  IF WINFLG[TI]==0THEN TI=TSKMAX
 NEXT
RETURN
@WINBUFFC
 WINBUFF[BF]=0
RETURN
@WINEXCBUFF
 GOSUB @WINBUFF
 IF BF==0THEN RETURN
GOTO RETLBL$
@WINBUFF
 BF=0
 FOR WINBUFF=2TO 3
  IF WINBUFF[WINBUFF]==0THEN BF=WINBUFF:WINBUFF[BF]=1:WINBUFF=4
 NEXT
 IF BF==0THEN GOSUB@SYS_ERR_BUFF:RETURN
RETURN
@WINBUFFP
 GPAGE 0,BF,WINGPAGE
RETURN
@WINBUFFP2
 GPAGE 0,!WINGPAGE,WINGPAGE
RETURN
@WINBUFFGCLS
 GPAGE 0,BF,WINGPAGE
 GCLS BFC
 GPAGE 0,!WINGPAGE,WINGPAGE
RETURN
@WINBUFFCPY
 IF WFX<0THEN @WINBUFFCPY_
 GCOPY BF,BF_X,BF_Y,BF_X2,BF_Y2,WFX,WFY,0
RETURN
@WINBUFFCPY_
 GCOPY BF,BF_X-WFX,BF_Y,BF_X2,BF_Y2,0,WFY,0
RETURN
@WINBUFFCPY2
 IF WFX+BF_X3<0THEN @WINBUFFCPY2_
 GCOPY BF,BF_X,BF_Y,BF_X2,BF_Y2,BF_X3+WFX,BF_Y3+WFY,0
RETURN
@WINBUFFCPY2_
 GCOPY BF,BF_X-WFX+BF_X3,BF_Y,BF_X2,BF_Y2,0,WFY+BF_Y3,0
RETURN
'WIN MESSAGE API
@WINNAME2ID
' WINIDNAME$
' WINID_RESULT
 WINID_RESULT=1
 FOR WINIDI=0TO TSKMAX-1
  IF WINIDNAME$==WINNAME$[WINIDI]THEN WINIDN=WINID[WINIDI]:WINIDI=TSKMAX+1:WINID_RESULT=0
 NEXT
'WINIDN
RETURN
@WINID2TSK
' WIN_ID
' WINID_RESULT
 WINID_RESULT=1
 IF WINIDMLT!=-1THEN @WINID2TSK_MLT
 FOR WINIDI=0TO TSKMAX-1
  IF WIN_ID==WINID[WINIDI]THEN WINID_TSK=WINIDI:WINIDI=TSKMAX+1:WINID_RESULT=0
 NEXT
 WINIDMLT=-1
RETURN
@WINID2TSK_MLT
 WINMLT_FLG=0
 FOR WINIDI=0TO TSKMAX-1
  IF WINIDMLT==WINMLT[WINIDI] AND WIN_ID==WINID[WINIDI]THEN WINMLT_FLG=1
  IF WINMLT_FLG THEN WINID_TSK=WINIDI:WINIDI=TSKMAX+1WINID_RESULT=0
 NEXT
 WINIDMLT=-1
RETURN
'WINMES¦ ¼®·¶
@WINNEW_MES
 FOR WINNEW_MES=0TO WINMESMAX-1
  WINMES$[WINMESI,WINNEW_MES]=""
  WINMES_ID[WINMESI,WINNEW_MES]=0
 NEXT
RETURN
@WINSEND_MES
 'WINSEND_ID
 'WINSEND_RESULT

'TSKNAME -> ID
 WINIDNAME$=WINSEND$
 GOSUB @WINNAME2ID
 WINSEND_ID=WINIDN
 WINSEND_RESULT=WINID_RESULT
 IF WINSEND_RESULT THEN RETURN
'ID -> TSK
 WIN_ID=WINSEND_ID
 GOSUB @WINID2TSK
'?WINNAME$[WINID_TSK]
 WINSEND_TSK=WINID_TSK
 WINSEND_RESULT=WINID_RESULT
 IF WINSEND_RESULT THEN RETURN
 'µ¸ÚÅ²
 IF WINMES_I[WINID_TSK]==WINMESMAX-1 THEN WINSEND_RESULT=1:RETURN
 WINMES_I[WINID_TSK]=WINMES_I[WINID_TSK]+1
 WINMES$[WINID_TSK,WINMES_I[WINID_TSK]]=WINSEND_MES$
 WINMES_ID[WINID_TSK,WINMES_I[WINID_TSK]]=WINID[TSK]
RETURN
@WINRECV_MES
 WINRECV_RESULT=WINMES_I[TSK]<0
 IF !WINRECV_RESULT THEN WINRECVRESULT$=WINMES$[TSK,WINMES_I[TSK]]
 IF !WINRECV_RESULT THEN WINRECVRESULTID=WINMES_ID[TSK,WINMES_I[TSK]]
 IF WINMES_I[TSK]>=0 THEN WINMES_I[TSK]=WINMES_I[TSK]-1
RETURN
'APPLICATION SUB
'Ó¼ Ë®³¼Þ
@WINSTRPUT
 'WINSTR$,WINSX,WINSY
 WINSX2=WINX+WINSCX+WINSX+1:WINSY2=WINY+WINSCY+WINSY+10
 WINSX2=WINSX+WFX:WINSY2=WINSY+WFY
 FOR SWI=0TO LEN(WINSTR$)-1
  GPUTCHR WINSX2,WINSY2,"BGF0",ASC(MID$(WINSTR$,SWI,1)),WINSC,1
  WINSX2=WINSX2+8
  IF WINSX2>(WFX2-7) THEN SWI=999
 NEXT
 WINSC=0
RETURN

@WINBTN
 WINBTNF=0
  'WINBX,WINBY,WINBX2,WINBY2
 WINSTR$=WINBSTR$
 WINBX2=WINBX+(LEN(WINBSTR$)*8)+2+1
 WINBY=WINBY'+10'WY-WFY
 WINBY2=WINBY+10'WY-WFY
 'WINBY2=9
 F=0
 IF (WINBX+WFX)<=MOUSEX AND (WINBX2+WFX)>=MOUSEX THEN F=1
 IF WINFLG==2 AND F==1AND WINBY+WFY<=MOUSEY AND WINBY2+WFY>=MOUSEY THEN F=2MOUSE=1
 WINBTNF2=0
 '8/31 WINACTV¶×WINFLG==2ÆÍÝº³ ²ÄÞ³Á­³ÆÊÝÉ³¼Å²Ö³Æ
 IF F==2THEN IF CLICK3==1THEN WINBTNF=WINFLG==2 ELSE WINBTNF2=WINFLG==2
 IF WINBX2+WFX>WFX2 THEN WINBX2=WINX2
 GFILL WINBX+WFX,WINBY+WFY,WINBX2+WFX,WINBY2+WFY,13-(WINBTNF*12)
 GBOX WINBX+WFX,WINBY+WFY,WINBX2+WFX,WINBY2+WFY,1+13*WINBTNF2
 WINSX=WINBX+2:WINSY=WINBY+2:WINSC=1:GOSUB @WINSTRPUT
RETURN

@WINSTSSTP
RETURN
@WINPROGBAR
'WINPX,WINPY,WINPY2,WINPX2,WINPS
 IF WINPS!=0THEN WINPSX=((WINPX2-WINPX)/100*(WINPS))
 WINPX=WINPX+WFX
 WINPX2=WINPX2+WFX
 WINPY=WINPY+WFY
 WINPY2=WINPY2+WFY
 GFILL WINPX,WINPY,WINPX2,WINPY2,13
 IF WINPS!=0THEN GFILL WINPX,WINPY,WINPSX+WINPX,WINPY2,4
RETURN
@WINTXTBOX
'WINTX,WINTY,WINTX2,WINTM,[WINTY2]
'WINTM=1 Ï½¹-ÄÞ***
'WINTXTP$„@„A„A„V„V„~
'->WINTXT$
 WINTA=WINTA*WINACTV
 _WINTA=WINTA
 WINTX=WINTX+WFX
 WINTX2=WINTX2+WFX
 WINTY=WINTY+WFY
 WINTXT$=WINTXTP$
 GFILL WINTX,WINTY,WINTX2,WINTY+8,15-(2*WINTR)
 GBOX WINTX,WINTY,WINTX2,WINTY+8,14
 WINSC=1
 WINSTR$=WINTXTP$:WINSX=WINTX-WFX+1
 IF WINTM==1THEN WINSTR$="*"*LEN(WINTXTP$)
 WINSY=WINTY-WFY+1:GOSUB @WINSTRPUT
 F=0
 IF MOUSEX>=WINTX AND MOUSEX<=WINTX2 THEN F=1
 IF F==1AND MOUSEY>=WINTY AND MOUSEY<=WINTY+8 THEN F=2
 IF F==2AND CLICK==1THEN WINTA=1
 IF F!=2AND CLICK==1THEN WINTA=0
 IF WINTA==0THEN WINTXT$=WINTXTP$:RETURN
 KEYFLG=KEYFLG+(WINTR==0)
 IF WINTR==0THEN INK$=KEYBF$:KEYBF$=""'INKEY$()
 IF WINTSX==0AND INK$!="" THEN WINTXT$=INK$+MID$(WINTXTP$,WINTSX,256)
 IF WINTSX!=0AND INK$!="" THEN WINTXT$=MID$(WINTXTP$,0,WINTSX)+INK$+MID$(WINTXTP$,WINTSX,256)
 IF INK$!=""THEN WINTSX=WINTSX+LEN(INK$)
 B=BUTTON()
 IF B==4THEN WINTSX=WINTSX-1
 IF B==8THEN WINTSX=WINTSX+1
 O=128
 B=B+WINTR
IF B==O AND WINTSX>0THEN WINTXT$=MID$(WINTXTP$,0,WINTSX-1)+MID$(WINTXTP$,WINTSX,256)WINTSX=WINTSX-1
 IF WINTSX>LEN(WINTXT$)THEN WINTSX=LEN(WINTXT$)
 IF WINTSX<0THEN WINTSX=0
 IF !WINACTV THEN RETURN '8/30 ²¯¼­ÝÀÞ¹ Ë®³¼Þ»ÚÙ ÓÝÀÞ²¦ ¼­³¾² 8/31½º¼¶²Ø®³
 IF MAINCNTL%63>31 THEN GFILL WINTX+WINTSX*8,WINTY+6,WINTX+WINTSX*8+8,WINTY+7,14
 '8/31 Ï³½ÃÞ¶-¿Ù¼Ã²
 IF CLICK THEN WINTSX=0OR (MOUSEX-WINTX)/8:IF WINTSX>LEN(WINTXT$)THEN WINTSX=LEN(WINTXT$)
 'WINTXT$=WINTXTP$
RETURN
@WINCHKBOX
'WINCX,WINCY,WINCSTR$,WINCHKF
'->WINCHKF
 WINCX2=WINCX+8
 WINCY2=WINCY+8
 WINCWX=WINCX+WX
 WINCWX2=WINCX2+WX
 WINCWY=WINCY+WY+10
 WINCWY2=WINCY2+WY+10
 GFILL WINCWX,WINCWY,WINCWX2,WINCWY2,15
 GBOX WINCWX,WINCWY,WINCWX2,WINCWY2,13
 IF WINCHKF==1THEN GLINE WINCWX2-0,WINCWY+1,WINCWX+3,WINCWY2-2,14
 IF WINCHKF==1THEN GLINE WINCWX+3,WINCWY2-2,WINCWX+1,WINCWY2-4,14
 F=0
 IF MOUSEX>=WINCWX AND MOUSEX<=WINCWX2+LEN(WINCSTR$)*8 THEN F=1
 IF F==1AND MOUSEY>=WINCWY AND MOUSEY<=WINCWY2 THEN F=2MOUSE=1
 IF F==2AND CLICK==1THEN WINCHKF=!WINCHKF*WINACTV
 WINSX=WINCX2
 WINSY=WINCY
 WINSC=1
 WINSTR$=WINCSTR$
 GOSUB @WINSTRPUT
RETURN

@WINRADBTN
'WINRX,WINCY
'->WINRADF
 WINRX2=WINRX+8
 WINRY2=WINRY+8
 WINRWX=WINRX+WX
 WINRWX2=WINRX2+WX
 WINRWY=WINRY+WY+10
 WINRWY2=WINRY2+WY+10
 GCIRCLE WINRWX+4,WINRWY+4,4,13
 IF WINRF==1THEN GCIRCLE WINRWX+4,WINRWY+4,2,14
 IF WINRF==1THEN GCIRCLE WINRWX+4,WINRWY+4,1,14:GPSET WINRWX+4,WINRWY+4,14

 WINSX=WINRX+8
 WINSY=WINRY
 WINSC=1:WINSTR$=WINRSTR$
 GOSUB @WINSTRPUT
 F=0
 IF WINRWX<=MOUSEX AND WINRWX+LEN(WINRSTR$)*8+8>=MOUSEX THEN F=1
 IF F==1AND WINRWY<=MOUSEY AND WINRWY2>=MOUSEY THEN F=2MOUSE=1
 WINNRF=0
 IF F==2AND CLICK==1AND WINACTV==1THEN WINRF=1*WINACTV:WINNRF=1*WINACTV
RETURN

@WINMENU
 WINM=-1
 WINMX=WINMX+WFX
 WINMY=WINMY+WFY
 IF WINMX2==0THEN WINMX2=WFX2 ELSE WINMX2=WFX+WINMX2
 IF WINMY2==0THEN WINMY2=WFY+9
 GFILL WINMX,WINMY,WINMX2,WINMY2,WINMC
 GLINE WINMX,WINMY2,WINMX2,WINMY2,WINMC3
 WINMSX=WINMX-WFX
 WINSX=WINMX-WFX
 WINF2=0
 IF MOUSEX>=WINMX AND MOUSEX<=WINMX2 AND MOUSEY>=WINMY AND MOUSEY<=WINMY2 THEN WINMK=0
 FOR WINI=0TO WINMMAX
  WINF=0
  IF MOUSEX>=WFX+WINMSX AND MOUSEX<=WFX+WINMSX+LEN(WINM$[WINI])*8THEN WINF=1
  IF WINF==1AND MOUSEY>=WINMY AND MOUSEY<=WINMY+8THEN WINF=2
  IF WINF==1AND WINMENUF[WINI]==1AND MOUSEY>=WINMY AND MOUSEY<=WINMY+8+WINMENU[WINI]THEN WINF=2
  WINF=WINF*!WINF2
  IF WINMK==1THEN IF WINMKS==WINI THEN WINF=2ELSE WINF=0
  IF WINF==2AND WINMK==0THEN WINMKS=WINI:WINMK=1
IF WINF==2THEN WINF2=1GFILL WFX+WINMSX,WINMY,WFX+WINMSX+LEN(WINM$[WINI])*8,WINMY+8,WINMC2:WINM=WINI
  IF WINF==2THEN WINMENUF[WINI]=1ELSE WINMENUF[WINI]=0
  WINSY=WINMY-WFY
  WINSTR$=WINM$[WINI]
  WINSC=1*WINF!=2
  GOSUB @WINSTRPUT
  WINSX=WINMSX+LEN(WINM$[WINI])*8
  WINMSX=WINSX
 NEXT
 WINMSX=0
 WINMX2=0
 WINMY2=0
 WINMMAX=-1
 WINMC=15
WINMC2=14
WINMC3=14
 IF CLICK== 1THEN WINMK=0
RETURN
@WINMENU2
 WINM=-1
 WINMX=WINMX+WFX
 WINMX2=WFX+WINMX2
 WINMY=WINMY+WFY
 WINMY2=WINMY+8+WINMMAX*8
 WINMA=0
 IF MOUSEX>=WINMX AND MOUSEX<=WINMX2 AND MOUSEY>=WINMY AND MOUSEY<=WINMY2 THEN WINMK=0:WINMA=1
 GFILL WINMX,WINMY,WINMX2,WINMY2,WINMC
 GBOX WINMX,WINMY,WINMX2,WINMY2,WINMC3
 WINMSY=WINMY-WFY
 WINF2=0
 WINM=-1
 FOR WINI=0TO WINMMAX
  WINSY=WINMSY
  WINSX=WINMX-WFX
  WINF=0
  IF MOUSEX>=WINMX AND MOUSEX<=WINMX2 THEN WINF=1
  IF WINF==1AND MOUSEY>=WINMSY+WFY AND MOUSEY<=WINMSY+WFY+8THEN WINF=2
  WINF=WINF*!WINF2
  IF WINMK==1THEN IF WINMKS==WINI THEN WINF=2ELSE WINF=0
  IF WINF==2AND WINMK==0THEN  WINMKS=WINI:WINMK=1
  IF WINF==2THEN WINF2=1GFILL WINMX,WINMSY+WFY,WINMX2,WINMSY+WFY+8,WINMC2:WINM=WINI
  WINSC=1*WINF!=2
  WINSTR$=WINM$[WINI]
  GOSUB @WINMSTRPUT
  WINMSY=WINMSY+8
 NEXT
 IF CLICK==1THEN WINMK=0
 WINMSX=0
 WINMX2=0
 WINMY2=0
 WINMMAX=-1 
' IF MOUSEX>=WINMX AND MOUSEX<=WINMX2 AND MOUSEY>=WINMY AND MOUSEY<=WINMY2 THEN WINMK=0
 WINMC=15
WINMC2=14
WINMC3=14
RETURN
@WINMSTRPUT
 FOR WS=0TO LEN(WINSTR$)-1
  GPUTCHR WINSX+WFX,WINSY+WFY,"BGF",ASC(MID$(WINSTR$,WS,1)),WINSC,1
  WINSX=WINSX+8
 NEXT
RETURN

@WINSCRBARX
WINSCRBS=((WINBX2-WINBX-24))-((WINBX2-WINBX-24)/WINBM*(WINBM-WINBY2))+8
 WINBX3=(WINBX2-WINBX)/2
 WINBX=WINBX+WFX
 WINBX2=WINBX2+WFX
 WINBY=WINBY+WFY
 GFILL WINBX,WINBY,WINBX2,WINBY+8,13
 GBOX WINBX,WINBY,WINBX2,WINBY+8,29
 GFILL WINBX+WINSCRBS,WINBY,WINBX+8+WINSCRBS,WINBY+8,14
 GPUTCHR WINBX,WINBY,"BGF",ASC("©"),1,1
 GPUTCHR WINBX2-8,WINBY,"BGF",ASC("¨"),1,1
 WINSCRBARF=0
 IF MOUSEY>=WINBY AND MOUSEY<=WINBY+8THEN WINSCRBARF=1
 IF WINSCRBARF==1 AND MOUSEX>=WINBX AND MOUSEX<=WINBX+WINBX3 THEN WINSCRBARF=2
 IF WINSCRBARF==2 AND CLICK2 AND 0<WINBY2 THEN WINBY2=WINBY2-1
 WINSCRBARF=0
 IF MOUSEX>=WINBX+WINBX3 AND MOUSEX<=WINBX2 THEN WINSCRBARF=1
 IF WINSCRBARF==1 AND MOUSEY>=WINBY AND MOUSEY<=WINBY+8 THEN WINSCRBARF=2
 IF WINSCRBARF==2 AND CLICK2 AND WINBM>WINBY2 THEN WINBY2=WINBY2+1
RETURN
@WINSCRBARY
 WINSCRBARF=0
WINSCRBS=((WINBY2-WINBY-24))-((WINBY2-WINBY-24)/WINBM*(WINBM-WINBX2))+8
' WINSCRBS=(WINBY2-WINBY)/(WINBM-WINBX2)
 WINBX=WINBX+WFX
 WINBY3=(WINBY2-WINBY)/2
 WINBY=WINBY+WFY
 WINBY2=WINBY2+WFY
 GFILL WINBX,WINBY,WINBX+8,WINBY2,13
 GBOX WINBX,WINBY,WINBX+8,WINBY2,29
 GFILL WINBX,WINBY+WINSCRBS,WINBX+8,WINBY+WINSCRBS+8,14
 GPUTCHR WINBX,WINBY,"BGF",ASC("ª"),1,1
 GPUTCHR WINBX,WINBY2-8,"BGF",ASC("«"),1,1
 IF MOUSEX>=WINBX AND MOUSEX<=WINBX+8THEN WINSCRBARF=1
 IF WINSCRBARF AND MOUSEY>=WINBY AND MOUSEY<=WINBY+WINBY3 THEN WINSCRBARF=2
 IF WINSCRBARF==2 AND CLICK2 AND 0<WINBX2 THEN WINBX2=WINBX2-1
 IF MOUSEX>=WINBX AND MOUSEX<=WINBX+8THEN WINSCRBARF=1
 IF WINSCRBARF AND MOUSEY>=WINBY+WINBY3 AND MOUSEY<=WINBY+WINBY3*2 THEN WINSCRBARF=2
 IF WINSCRBARF==2 AND CLICK2 AND WINBM>WINBX2 THEN WINBX2=WINBX2+1
RETURN

@WINTRKBAR
RETURN

@WINCMBOX
RETURN

@WINDMUPDWN
RETURN

@WINNUMUPDWN
 WINNSP=(MAINCNTL-MOUSEFL)/100
 IF WINNSP>1THEN WINNSP=1
 IF !WINNY2 THEN WINNY2=8
 WINNY3=0OR(WINNY2-WINNY)/2
 WINNX=WINNX+WFX
 WINNX2=WINNX2+WFX
 WINNY=WINNY+WFY
 WINNY2=WINNY2+WFY
 GFILL WINNX,WINNY,WINNX2,WINNY2,15
 GBOX WINNX,WINNY,WINNX2,WINNY2,14
 GLINE WINNX+8,WINNY,WINNX+8,WINNY2,14
 GFILL WINNX+1,WINNY+1,WINNX+7,WINNY2-1,13
 GLINE WINNX+1,WINNY+WINNY3,WINNX+7,WINNY+WINNY3,14
 ON WINACTV GOTO @WINNUMUPDWNS
 WINNF=0
 IF MOUSEX>=WINNX AND MOUSEX<=WINNX+8THEN WINNF=1
 IF WINNF==1AND MOUSEY>=WINNY AND MOUSEY<=WINNY+WINNY3-1THEN WINNF=2
 IF WINNF==2AND CLICK2==1THEN WINN=WINN+WINNSP:GFILL WINNX+1,WINNY+1,WINNX+7,WINNY+WINNY3-1,29
 WINNF=0
 IF MOUSEX>=WINNX AND MOUSEX<=WINNX+8THEN WINNF=1
 IF WINNF==1AND MOUSEY>=WINNY+WINNY3 AND MOUSEY<=WINNY2-1THEN WINNF=2
 IF WINNF==2AND CLICK2==1THEN WINN=WINN-WINNSP:GFILL WINNX+1,WINNY+WINNY3+1,WINNX+7,WINNY2-1,29
 IF WINNM<WINN THEN WINN=WINNM
 IF WINN<WINNS THEN WINN=WINNS
 @WINNUMUPDWNS
 WINSX=WINNX-WFX+8
 WINSY=(WINNY2-WFY)/2-4
 WINSC=1
 WINSTR$=STR$(0OR WINN)
 GOSUB @WINSTRPUT
 WINNY2=0
 WINNS=0
 WINNSP=0.5
RETURN

@WINLNKLBL
 WINLBLX=WINLBLX+WFX
 WINLBLY=WINLBLY+WFY
 GLINE WINLBLX,WINLBLY+7,WINLBLX+LEN(WINLBL$)*8,WINLBLY+7,4
WLF=0WINLBLF=0
IF(WINLBLX<=MOUSEX)*(WINLBLX+LEN(WINLBL$)*8>=MOUSEX)*(WINLBLY<=MOUSEY)*(WINLBLY+8>MOUSEY)THEN WLF=1
IF WINACTV*WLF THEN IF CLICK3 THEN WINLBLF=1 ELSE MOUSE=1
 FOR WLI=0TO LEN(WINLBL$)-1
  GPUTCHR WINLBLX+WLI*8,WINLBLY,"BGF",ASC(MID$(WINLBL$,WLI,1)),11,1
 NEXT
RETURN
@KEY
 IF KEYFLG>0 THEN FOR I=0TO 1INK$=INKEY$()KEYBF$=KEYBF$+INK$I=INK$==""NEXT
 IF KEYFLG==0THEN FOR I=0TO 1I=INKEY$()==""NEXT
RETURN

@SKIP
 SKIPI=0
 RTS=LEN(SKIP$)
 FOR SKIP=0TO LEN(SKIP$)-1
  IF MID$(SKIP$,SKIP,LEN(SKIPS$))==SKIPS$ THEN SKIPI=SKIPI+1
  IF SKIPI==SKIPMAX+1 THEN RTS=SKIP:SKIP=9999
 NEXT
 SKIPMAX=0
RETURN
@SPACESKIP
 IF MID$(S$,I,1)==" "THEN I=I+1:GOTO @SPACESKIP
RETURN
@CMDLINE
 FOR I=0TO CMDLINEMAX-1
  CMD$[I]=""
 NEXT
 S$=C$
 I=0
 GOSUB @SPACESKIP
 C$=MID$(C$,I,256)I=0
 IF INSTR(C$," ")==-1THEN CMD$[0]=C$:RETURN
 SKIP$=C$
 SKIPS$=" "
 GOSUB @SKIP
 CMDMAX=0
 CMD$[CMDMAX]=MID$(C$,I,RTS)
 @CMDLINEF
 IF C$!=""THEN GOSUB@CMDLINE_SS:GOTO @CMDLINEF
 
RETURN
 @CMDLINE_SS
  I=0
  SKIP$=C$
  SKIPS$=" "
  GOSUB @SKIP
  I=RTS
  S$=MID$(C$,I,256)
  C$=S$
  I=0
  GOSUB @SPACESKIP
  C$=MID$(C$,I,256)I=0 
  SKIP$=C$
  SKIPS$=" "
  GOSUB @SKIP
  I=RTS
  CMDMAX=CMDMAX+1
  CMD$[CMDMAX]=MID$(C$,0,RTS)

 RETURN

'CMD$ÆºÏÝÄÞ
'CMDL$Æ×ÍßÙ,CMD$[]ÆË·½³
'NOCMD
@CMDRUN
 C$=CMD$
 GOSUB @CMDLINE
 'CMD$[]¶Þ ¸Ù-- ¸Ù¯¸- ()>
 'CMD$[]              =]
 '                    ~
 NOCMD=1
 FOR I=0TO COMMANDMAX-1
  IF CMD$[0]==COMMAND$[I]THEN CMDL$=COMMANDL$[I]:I=COMMANDMAX:NOCMD=0
 NEXT
RETURN
@CMDREAD
 RESTORE @COMMANDDAT
 FOR I=0TO 1
  READ C$
  IF C$!="0"THEN COMMANDMAX=COMMANDMAX+1:I=0:READ CL$
 NEXT
 DIM COMMAND$[COMMANDMAX]
 DIM COMMANDL$[COMMANDMAX]
 RESTORE @COMMANDDAT
 FOR I=0TO COMMANDMAX-1
  READ COMMAND$[I]
  READ COMMANDL$[I]
 NEXT
RETURN
@COMMANDDAT
DATA COMMAND,@COM_COM
DATA DIR,@COM_DIR
DATA VER,@COM_VER
DATA HELP,@COM_HELP
DATA NULL,@COM_NULL
DATA S,@COM_S
DATA GOSUB,@COM_SUB
DATA RETURN,@COM_RT
DATA AUTOSUB,@COM_AUTOSUB
DATA 0

@COM_COM
 COMP$="OTYAX"+VER$:GOSUB COMPRT$
 COMP$="COMMAND":GOSUB COMPRT$
RETURN
@COM_DIR
 COMP$="ÐÀ²µ³":GOSUB COMPRT$
RETURN
@COM_VER
 COMP$="BASIC"+HEX$(VERSION):GOSUB COMPRT$
 COMP$="OTYAX"+VER$:GOSUB COMPRT$
RETURN
@COM_HELP
 RESTORE @COM_HELP_DAT
 IF CMD$[1]!="" THEN @COM_HELP2
 FOR COM_I=0TO 1'COMMANDMAX-1
  READ COM_HELP$
  IF COM_HELP$!="0"THEN COM_I=0 ELSE @COM_HELPS
  READ COM_HELP_S$
  COMP$=COM_HELP$:GOSUB COMPRT$
  COMP$=COM_HELP_S$:GOSUB COMPRT$
  @COM_HELPS
 NEXT
RETURN
@COM_HELP2
 IF CMD$[1]=="ME" THEN COMP$="NO!":GOSUB COMPRT$:RETURN
 FOR COM_I=0TO 1'COMMANDMAX-1
  READ COM_HELP$
  IF COM_HELP$!="0"THEN COM_I=0 ELSE @COM_HELP2S
  READ COM_HELP_S$
  IF COM_HELP$==CMD$[1]THEN COMP$=COM_HELP$:GOSUB COMPRT$:COMP$=COM_HELP_S$:GOSUB COMPRT$
  @COM_HELP2S
 NEXT
RETURN
@COM_HELP_DAT
DATA DIR,¶ÚÝÄÃÞ¨Ú¸ÄØÉÌ§²Ù²Á×Ý¦¼­Ä¸¼Ï½¡
DATA COMMAND,ºÏÝÄÞ²ÝÀÌßØÀ¦»²·ÄÞ³¼Ï½¡
DATA VER,¹ÞÝ»Þ²ÉÊÞ-¼Þ®Ý¦Ë®³¼Þ¼Ï½¡
DATA HELP,ÍÙÌß¦Ë®³¼Þ¼Ï½¡
DATA 0
RETURN
@COM_NULL
 FOR COM_I=0TO VAL(CMD$[1])
  COMP$=CMD$[2]:GOSUB COMPRT$
 NEXT
RETURN
@COM_S
 CMDMAX=CMDMAX-1
 FOR CMD_I=0TO CMDMAX
  CMD$[CMD_I]=CMD$[CMD_I+1]
 NEXT
 CMD$[CMDMAX]=""
 CMDMAX=CMDMAX-1
 GOSUB "@COM_"+CMD$[0]
RETURN
@COM_RT
 RTFLG=1
RETURN
@COM_SUB
 CMDMAX=CMDMAX-1
 FOR CMD_I=0TO CMDMAX
  CMD$[CMD_I]=CMD$[CMD_I+1]
 NEXT
 CMD$[CMDMAX]=""
 CMDMAX=CMDMAX-1
 GOSUB "@"+CMD$[0]
RETURN
@COM_AUTOSUB
 SYSBEEP=0
 LOAD "MEM:OTYAXINI",0
 SYSBEEP=1
 AUTOSUB$=CMD$[1]
 AUTOSUBM$=CMD$[1]+CHR$(0)*(16-LEN(CMD$[1]))
 MEM$=AUTOSUBM$+MID$(MEM$,16,256)
 SAVE "MEM:OTYAXINI
RETURN
@COM_TST
 COMP$="Hello,World"+"!"*CMDMAX:GOSUB COMPRT$
RETURN
@COM_PUT
 COMP$=COMP$+CMD$[1]:GOSUB COMPRT$
RETURN
@COM_SAMPLE
 COMP$="„F¶½Þ±Ã¹Þ-Ñ„G":GOSUB COMPRT$
 COM_SAMPLE=RND(100)
 FOR CMD_I=0TO 1
 COMP$="(0?99)ÏÃÞ":GOSUB COMPRT$
 GOSUB COMINPUT$
 GOSUB COMPRT$
 IF VAL(COMI$)>COM_SAMPLE THEN CMD_I=0:COMP$="µµ·²":GOSUB COMPRT$
 IF VAL(COMI$)<COM_SAMPLE THEN CMD_I=0:COMP$="Á²»²":GOSUB COMPRT$
 NEXT
 COMP$="±ÀØ!":GOSUB COMPRT$
RETURN
@COMMANDINI
 COMPRT$="@CMD_PRT"
 COMINPUT$="@CMD_INPUT"
 COMINI=1
RETURN
@COMMAND
 IF COMINI==0THEN GOSUB @COMMANDINI
 RTFLG=0
 COMKF=0
 COMP$=CD$+">":GOSUB COMPRT$
 GOSUB COMINPUT$
' LINPUT CMD$
 CMD$=COMI$
 ?
 GOSUB @CMDRUN
 IF NOCMD==0THEN COMINI=0:GOSUB CMDL$ ELSE COMP$="Bad Command":GOSUB COMPRT$
 IF RTFLG==1THEN COMINI=0:RETURN
GOTO @COMMAND
@CMD_INPUT
 CMD_IN_MX=CSRX
' CMD_IN_X=CSRX
 CMD_IN=0
CMD_INPUT$=""
CMD_IN_CSRY=CSRY

@CMD_INPUT_L
 CMD_IN_B=BUTTON()%16
 GFILL (CMD_IN_X+CMD_IN_MX)*8,CMD_IN_CSRY*8+8,(CMD_IN_MX+CMD_IN_X)*8+8,CMD_IN_CSRY*8+7,0
 IF CMD_IN_B==4AND 0<CMD_IN_X THEN CMD_IN_X=CMD_IN_X-1
 IF CMD_IN_B==8AND CMD_IN_X<32 THEN CMD_IN_X=CMD_IN_X+1
 IF CMD_IN_X>LEN(CMD_INPUT$)THEN CMD_IN_X=LEN(CMD_INPUT$)
 GFILL ((CMD_IN_X+CMD_IN_MX)*8),CMD_IN_CSRY*8+8,((CMD_IN_MX+CMD_IN_X)*8)+8,CMD_IN_CSRY*8+7,15
FOR CMD_IN_I=0TO 3
 CMD_IN_INK$=INKEY$()
 CMD_IN_KEY=KEYBOARD
 IF CMD_IN_KEY THEN GOSUB @CMD_INPUT_KEY
 IF LEN(CMD_IN_INK$) THEN GOSUB @CMD_INPUT_INK
 IF CMD_IN==1THEN COMI$=MID$(CMD_INPUT$,0,LEN(CMD_INPUT$)-1+(LEN(CMD_INPUT$)==0)):RETURN
' LOCATE CMD_IN_MX,CMD_IN_CSRY:?CMD_INPUT$;
 VSYNC 1
NEXT
 LOCATE CMD_IN_MX,CMD_IN_CSRY:?" "*(32-CMD_IN_MX);
 LOCATE CMD_IN_MX,CMD_IN_CSRY:?CMD_INPUT$;
' GFILL (CMD_IN_X+CMD_IN_MX)*8,CMD_IN_CSRY*8+8,(CMD_IN_MX+CMD_IN_X)*8+8,CMD_IN_CSRY*8+7,0
' GFILL ((CMD_IN_X+CMD_IN_MX)*8),CMD_IN_CSRY*8+8,((CMD_IN_MX+CMD_IN_X)*8)+8,CMD_IN_CSRY*8+7,15
GOTO @CMD_INPUT_L
RETURN
@CMD_INPUT_KEY
 IF CMD_IN_KEY==60THEN CMD_IN=1:WAIT 20:RETURN
 IF CMD_IN_KEY==15THEN GOSUB @CMD_INPUT_BS:RETURN
 IF CMD_IN_KEY==67THEN GOSUB @CMD_INPUT_DL:RETURN
RETURN
01234567
ABCFDEFG

@CMD_INPUT_BS
 IF 0<CMD_IN_X THEN ELSE RETURN
 CMD_INPUT$=MID$(CMD_INPUT$,0,CMD_IN_X-1)+MID$(CMD_INPUT$,CMD_IN_X,256)
 GFILL (CMD_IN_X+CMD_IN_MX)*8,CMD_IN_CSRY*8+8,(CMD_IN_MX+CMD_IN_X)*8+8,CMD_IN_CSRY*8+7,0
 IF 0<CMD_IN_X THEN CMD_IN_X=CMD_IN_X-1
RETURN
@CMD_INPUT_DL
 CMD_INPUT$=MID$(CMD_INPUT$,0,CMD_IN_X)+MID$(CMD_INPUT$,CMD_IN_X+1,256)
RETURN
@CMD_INPUT_INK
 CMD_INPUT$=MID$(CMD_INPUT$,0,CMD_IN_X)+CMD_IN_INK$+MID$(CMD_INPUT$,CMD_IN_X,256)
' LOCATE CMD_IN_MX,CMD_IN_CSRY:?CMD_INPUT$;
 GFILL (CMD_IN_X+CMD_IN_MX)*8,CMD_IN_CSRY*8+8,(CMD_IN_MX+CMD_IN_X)*8+8,CMD_IN_CSRY*8+7,0
 IF CMD_IN_X<32 THEN CMD_IN_X=CMD_IN_X+1
RETURN
@CMD_PRT
?COMP$;
IF COMKF==1THEN ?
COMKF=1
COMP$=""
RETURN
@CHRNEW
 CHRE=0
 FOR CHRI=0TO 255
  CHRSET CHRL$,"0"*64
 NEXT
 FILEN$=CHRN$
 GOSUB @FILENAMECHK
 IF FILE==1THEN CHRE=1:RETURN.
 SAVE CHRL$+":"+CHRN$
 IF RESULT==CANCEL OR RESULT==FALSE THEN CHRE=1
RETURN
@CHRRENAME
 CHRE=0
 FILEN$=CHRN$
 GOSUB @FILENAMECHK
 IF FILE==1THEN CHRE=1:RETURN.
 RENAME CHRL$+":"+CHRN$
 IF RESULT==CANCEL OR RESULT==FALSE THEN CHRE=1 
RETURN
@CHRDELETE
RETURN
@CHRSAVE
RETURN
@CHRREAD
RETURN
@STACK
 
RETURN
@FILENAMECHK
 FILE=0
 IF LEN(FILEN$)>8OR LEN(FILEN$)==0THEN FILE=1:RETURN
 FOR FILEI=0TO LEN(FILEN$)
  FILEM=ASC(MID$(FILEN$,FILEI,1)
  IF(FILEM>==ASC("A")AND FILEM<=ASC("Z"))OR FILEM==ASC("_")THEN ELSE FILE=1
 NEXT
RETURN
@INIARRAY
' DIM STACK[128],STACK$[128]
 DIM CHAR$[32]
 DIM CHAR2$[32]
RETURN
@INI
 IF INI==0THEN GOSUB @INIARRAY
 INI=1
 CHRL$="SPU7"
 SYSBEEP=0
 LOAD"MEM:OTYAXINI",0
 SYSBEEP=1
 IF RESULT!=TRUE THEN GOSUB @INSTALL
 AUTOSUB$=""
 FOR I=0TO 15
  M$=MID$(MEM$,I,1)
  IF M$==CHR$(0)THEN I=16ELSE AUTOSUB$=AUTOSUB$+M$
 NEXT
RETURN
@INSTALL
 ?"OTYAX INSTALL
 ?"SAVE OTYAXINI.MEM
 MEM$="OTW"+CHR$(0)*13
 SAVE"MEM:OTYAXINI"
 IF RESULT==TRUE THEN ?"¶ÝÍß·È!" ELSE GOTO @INSTALL2
RETURN
@INSTALL2
 AUTOSUB$="COMMAND
 ?"INSTALL
RETURN
@ALLCLEAR
CLEAR
BGMSTOP 
GPAGE 0,2,2GCLS
GPAGE 0,3,3GCLS
FOR P=0TO 1
 GPAGE !P
 SPPAGE !P
 BGPAGE !P
 CHRINIT "BGF0"
 CHRINIT "BGU0"
 CHRINIT "BGU1"
 CHRINIT "BGU2"
 CHRINIT "BGU3"
 CHRINIT "SPU0"
 CHRINIT "SPU1"
 CHRINIT "SPU2"
 CHRINIT "SPU3"
 CHRINIT "SPU4"
 CHRINIT "SPU5"
 CHRINIT "SPU6"
 CHRINIT "SPU7"
 CHRINIT "SPS0"
 CHRINIT "SPS1"
 CHRINIT "BGD0"
 CHRINIT "BGD1"
 CHRINIT "SPD0"
 CHRINIT "SPD1"
 CHRINIT "SPD2"
 CHRINIT "SPD3"
NEXT
ACLS
KEY 1,"FILES"
KEY 2,"LOAD"+CHR$(34)
KEY 3,"SAVE"+CHR$(34)
KEY 4,"CONT"
KEY 5,"RUN"
END
@DBG
INPUT "ERROR¶ÞÃÞÙ?(Y/N)";DBG$
IF DBG$=="Y"THEN GOSUB @DBGERR
RETURN
@DBGERR
 ?"À²¼®¼Ï½¡"
 CMD$[1]="OTW
 GOSUB @COM_AUTOSUB
 GOSUB @SOF
RETURN
END
'END OF FILE
'END OF PROGRAM
@S_HELLO
 GOSUB @WINFLAG
 WINX2=64:WINY2=19
 WINTTL$="HELLO"
RETURN
@WIN_HELLO
 WINSX=0:WINSY=0:WINSC=1
 WINSTR$="Hello!":GOSUB@WINSTRPUT
RETURN

@S_HELLO2
 WIN_MODE=1
 GOSUB @WINFLAG
 HELLO2_X2=LEN("WindowsÃÞºÝËß­-À-É")*8
 HELLO2_Y2=64+18+16+8
 HELLO2_SCY=8
 HELLO2_SCX=8
 WINTTL$="HELLOFONT"
 WINTTL$="Form1"
 HELLOTXT$="WINDOWS"
 HELLORF[0]=1
 HELLO2_RADMAX=4-1
RETURN
@WIN_HELLO2
 WIN_MODE=1
 WINCLS=1
 WINTTL$="Form1 - "+STR$(HELLOBC)
 WINX2=HELLO2_X2
 WINY2=HELLO2_Y2
 WINSCX=HELLO2_SCX
 WINSCY=HELLO2_SCY
 GOSUB @WINDOW
 HELLO2_SCX=WINSCX
 HELLO2_SCY=WINSCY
 IF WINIDFLG==1THEN RETURN
 WINSX=0:WINSY=0:WINSC=1
 WINSTR$=WINTXT$+"ÃÞºÝËß­-À-É
 IF LEN(WINSTR$)*8>HELLO2_X2 THEN  HELLO2_X2=HELLO2_X2+1
 IF LEN(WINSTR$)*8<HELLO2_X2 THEN  HELLO2_X2=HELLO2_X2-1
 IF HELLOCHKF==1AND LEN(WINSTR$)*8!=HELLO2_X2 THEN HELLO2_X2=LEN(WINSTR$)*8
 GOSUB @WINSTRPUT
 WINSX=0:WINSY=8:WINSC=1
 WINSTR$="¾¶²¶ÞËÛ¶ÞØÏ½¡
 GOSUB @WINSTRPUT
 WINBX=37:WINBY=16:WINBSTR$="button1"
 GOSUB @WINBTN
 IF WINBTNF==1THEN HELLO2F=1:HELLOBC=HELLOBC+1
 IF HELLO2F==1THEN WINSX=0:WINSY=26:WINSC=4:WINSTR$="„F„G"+STR$(HELLOBC)+"ÎÞÀÝµ»ÚÀ":GOSUB@WINSTRPUT
 WINPX=5:WINPY=26+8:WINPX2=HELLO2_X2:WINPY2=26+16:WINPS=HELLOBC
 GOSUB @WINPROGBAR
 WINTR=HELLORF[1]+HELLORF[3]
 WINTM=HELLORF[2]+HELLORF[3]
 WINTX=0:WINTX2= HELLO2_X2:WINTY=26+16:WINTXTP$=HELLOTXT$
 WINTSX=HELLOTSX:WINTA=HELLOAC
 GOSUB @WINTXTBOX
 HELLOTSX=WINTSX
 HELLOTXT$=WINTXT$
 HELLOAC=WINTA
 WINCX=2:WINCY=26+25
 WINCSTR$="checkBox1
 WINCHKF=HELLOCHKF
 GOSUB @WINCHKBOX
 HELLOCHKF=WINCHKF
 WINRX=2:WINRY=26+25+8
 WINRSTR$="radioButton1
 WINRF=HELLORF[0]
 GOSUB @WINRADBTN
 HELLORF[0]=WINRF
 IF WINNRF==1THEN HELLO2_RAD=0:GOSUB @HELLO2_RAD

 WINRF=HELLORF[1]
 WINRX=2:WINRY=26+25+8+8
 WINRSTR$="Readonly
 GOSUB @WINRADBTN
 HELLORF[1]=WINRF
 IF WINNRF==1THEN HELLO2_RAD=1:GOSUB @HELLO2_RAD

 WINRF=HELLORF[2]
 WINRX=2:WINRY=26+25+8+8+8
 WINRSTR$="Masked
 GOSUB @WINRADBTN
 HELLORF[2]=WINRF
 IF WINNRF==1THEN HELLO2_RAD=2:GOSUB @HELLO2_RAD

 WINRF=HELLORF[3]
 WINRX=2:WINRY=26+25+8+8+8+8
 WINRSTR$="MaskedReadonly
 GOSUB @WINRADBTN
 HELLORF[3]=WINRF
 IF WINNRF==1THEN HELLO2_RAD=3:GOSUB @HELLO2_RAD
RETURN

@HELLO2_RAD
  HELLORF[HELLO2_RAD]=1
 FOR I=0TO HELLO2_RADMAX
  IF HELLO2_RAD!=I THEN HELLORF[I]=0
 NEXT
RETURN

'-¼­³Ø®³-
'(×¼ÞµÎÞÀÝ¦¼®·¶)
@C_HELLO2
 FOR I=1TO HELLO2_RADMAX
  HELLORF[I]=0
 NEXT
  HELLORF[0]=1
 HELLOCHKF=0
 GOSUB @WINCLOSE
RETURN
@S_SETTING
 WIN_MODE=1
 GOSUB @WINFLAG
 SETTING_X2=64+48
 SETTING_Y2=74
 WINTTL$="SETTING"
 SETTING_RF[0]=MODE==0
 SETTING_RF[1]=MODE==1
 SETTING_RADMAX=2-1 
RETURN
@WIN_SETTING
 WIN_MODE=1
 WINX2=SETTING_X2
 WINY2=SETTING_Y2
 WINSCX=SETTING_SCX
 WINSCY=SETTING_SCY
 GOSUB @WINDOW
 SETTING_SCX=WINSCX
 SETTING_SCY=WINSCY
 IF WINIDFLG==1THEN RETURN
 WINSX=0:WINSY=0:WINSC=1:WINSTR$="Ï³½":GOSUB @WINSTRPUT

 WINRF=SETTING_RF[0]:WINRX=0WINRY=8
 WINRSTR$="MODE0"
 GOSUB @WINRADBTN
 SETTING_RF[0]=WINRF
 IF WINNRF==1THEN SETTING_RF[1]=0:MOUSEMODE=0
 WINRF=SETTING_RF[1]:WINRX=0WINRY=16
 WINRSTR$="MODE1"
 GOSUB @WINRADBTN
 SETTING_RF[1]=WINRF
 IF WINNRF==1THEN SETTING_RF[0]=0:MOUSEMODE=1

 WINSX=8:WINSY=24:WINSC=1:WINSTR$="ÎÞÀÝ":GOSUB @WINSTRPUT
 WINCHKF=SETTING_CHKF
 WINCX=0:WINCY=32:WINCSTR$="AÃÞ¸Ø¯¸
 GOSUB @WINCHKBOX
 SETTING_CHKF=WINCHKF
 IF SETTING_CHKF==1THEN CLICKBTN=16 ELSE CLICKBTN=256
 P$=STR$(FPS/60)
 WINSX=0:WINSY=40:WINSC=1:WINSTR$="ÊßÌ«-ÏÝ½:"+P$:GOSUB @WINSTRPUT
RETURN

@S_FREE
 GOSUB @WINFLAG:WINX2=48
 WINY2=32:WINTTL$="FREE
RETURN
@WIN_FREE
 WINSTR$=STR$(FREEVAR):WINSX=0
 WINSY=0:WINSC=1
 GOSUB @WINSTRPUT
RETURN
@S_RUN
 WIN_MODE=1WIN_R=1
 WINMLT[TSK]=RUN_P
 GOSUB @WINFLAG:WINX2=80
 WINY2=40:WINTTL$="RUN
 RUN_P=RUN_P+1
RETURN
@WIN_RUN
 GOSUB @WINDOW
 IF WINY2<40THEN WINY2=40
 IF WINX2<48THEN WINX2=48
 IF WINIDFLG==1THEN RETURN
 P=WINMLT[TSK]
 WINTX2=WINX2-3
 WINTA=RUNTA[P]
 WINTX=1:WINTY=8:WINTXTP$=RUNNAME$[P]
 WINTSX=RUNSX[P]
 GOSUB @WINTXTBOX
 IF LEN(WINTXT$)>14THEN WINTXT$=MID$(WINTXT$,0,14)
 IF WINTSX>14THEN WINTSX=14
 RUNSX[P]=WINTSX
 RUNNAME$[P]=WINTXT$
 RUNTA[P]=WINTA
 WINBX=2:WINBY=18:WINBSTR$="RUN"
 GOSUB@WINBTN
 RUNBTNF=WINBTNF
 IF RUNBTNF==1THEN GOSUB @RUN_EXE
RETURN
@RUN_EXE
 WINEXE$=RUNNAME$[P]:GOSUB @WINEXE
 CLICK=0
 CLICK2=0
 CLICK3=0
 CLICKR=0
 CLICKR2=0
 CLICKR3=0
 CLICKF=0
'TSK=TSKMAX-1
RETURN
'¶Ý² ´ÃÞ¨À
@S_LED
WINTTL$="´ÃÞ¨À
WINX2=130:WINY2=41
LED_LINE=1
RETURN
@WIN_LED
 WINBX=2:WINBY=1
 WINBSTR$="LD"
 GOSUB @WINBTN
 IF WINBTNF==1THEN LED_FL=1
 WINBX=24:WINBY=1
 WINBSTR$="SV"
 GOSUB @WINBTN
 IF WINBTNF==1THEN LED_FL=2
 WINBX=46:WINBY=1
 WINBSTR$="UP"
 GOSUB @WINBTN
 LED_F=0
 IF WINBTNF==1THEN LED_F=2
 WINBX=68:WINBY=1
 WINBSTR$="DW":GOSUB @WINBTN
 IF WINBTNF==1THEN LED_F=1
 WINSX=1:WINSY=13:WINSTR$="line:"+STR$(LED_LINE)
 WINSC=1
 GOSUB @WINSTRPUT
 LED_B$=LED_LINES$
 WINTX2=WINX2-1
 WINTX=0:WINTY=22:WINTA=LED_A:WINTXTP$=LED_LINES$
 WINTSX=LED_TSX
 GOSUB @WINTXTBOX
 LED_A=WINTA:LED_LINES$=WINTXT$
 IF LED_B$!=WINTXT$ THEN GOSUB @LED_APP
 LED_TSX=WINTSX
 IF LED_F==1THEN LED_UP=0:GOSUB @LED_DW
 IF LED_F==2THEN LED_UP=1:GOSUB @LED_DW
 IF LED_FL!=0THEN GOSUB @LED_FIL
RETURN
@LED_FIL
 WINY2=74
 WINSTR$="LOAD"*(LED_FL==1)+"SAVE"*(LED_FL==2)
 WINSX=0:WINSY=32:WINSC=1:GOSUB@WINSTRPUT
 
 WINTXTP$=LED_FIL$
 WINTX=0:WINTY=40:WINTSX=LED_FLSX
 WINTX2=WINX2-1
 WINTA=LED_FLA
 GOSUB @WINTXTBOX
 LED_FLA=WINTA
 LED_FIL$=WINTXT$
 LED_FLSX=WINTSX
 
 WINBX=2:WINBY=50:WINBSTR$="LOAD"*(LED_FL==1)+"SAVE"*(LED_FL==2)
 GOSUB @WINBTN
 IF WINBTNF==1THEN GOSUB @LED_L_S
RETURN
 @LED_L_S
  IF LED_FL==1THEN LOAD"MEM:"+LED_FIL$,0:LED$=MEM$
  IF LED_FL==2THEN MEM$=LED$:SAVE"MEM:"+LED_FIL$
  LED_I=0
  GOSUB @LED_DW
 RETURN
 @LED_APP
  LED$=LEDB$+LED_LINES$+LEDC$
 RETURN
 @LED_DW
C$=CHR$(13)
  L=0:F=0:J=0:I=0
  IF LED_LINE<2THEN RETURN'10/24
  IF LED_LINE<1THEN LED_LINE=0
  IF LED_UP==0THEN LED_LINE=LED_LINE+1 ELSE LED_LINE=LED_LINE-1
  LED_UP=0
  FOR I=0TO LEN(LED$)-1
   M$=MID$(LED$,I,1)
   IF M$==CHR$(13)THEN L=L+1:LED_LS$=MID$(LED$,J,I-J):J=I+1
   IF LED_LINE==L AND F==0 THEN F=1:LED_I=I:LED_LINES$=LED_LS$
  NEXT
  IF F==0THEN LED_LINES$=MID$(LED$,J,I-J):LED_LINE=L+1:LED_I=J
  IF LED_LINE==0THEN LED_LINE=0:GOTO @LED_DW
  LEDB$=MID$(LED$,0,LED_I-1)
  LEDC$=MID$(LED$,LED_I+LEN(LED_LINES$),256)
 RETURN

@S_MEV
 WINX2=128:WINY2=77
 WINTTL$="MEMViewer"
 MEV_OF=0
RETURN
@WIN_MEV
 WINTX=0:WINTY=0:WINTXTP$=MEV_F$
 WINTSX=MEV_X:WINTA=MEVA:WINTX2=8*8
 GOSUB @WINTXTBOX
 MEVA=WINTA
 MEV_X=WINTSX
 MEV_F$=WINTXT$

 WINBX=66:WINBY=-1:WINBSTR$="LOAD"
 GOSUB @WINBTN
 IF WINBTNF==1THEN GOSUB @MEV_F
' IF MEV$==""THEN RETURN
 X=WX+1:Y=WY+19+2
 C=0:K=0:F=0
 FOR I=0TO LEN(MEV$)-1
'  M$=MID$(CHR$(13)+MEV$+CHR$(13),I,1)
  M$=MID$(MEV$,I,1)
  IF I>=MEV_C THEN K=J:I=99998:GOTO @MEV_SKK
  IF M$==CHR$(13)THEN C=C+1:J=I:F=1
@MEV_SKK
 NEXT
 IF F==0THEN K=0ELSE K=K+1
 MEV_D=K'INSTR(J,MID$(MEV$,0,MEV_C)+CHR$(13),CHR$(13)) 
 IF MEV_D==-1THEN MEV_D=0
 Z=MEV_D
' FOR I=MEV_D TO LEN(MEV$)-1
 FOR I=0 TO LEN(MEV$)-1
  M$=MID$(MEV$,I,1)
  IF X>=WX2 THEN X=WX+1:Y=Y+8
  IF Y>=WY2 THEN I=9999:GOTO @MEVSK
  GPUTCHR X,Y,"BGF",ASC(M$),1,1
  IF!MEV_OF AND Z==MEV_C THEN GFILL X,Y+7,X+8,Y+8,14
  IF MEV_OF AND Z==MEV_C THEN GFILL X+8,Y+7,X+8+8,Y+8,14
  X=X+8:Z=Z+1
  IF M$==CHR$(13)THEN Y=Y+8:X=WX+1:'I=I+1:M$=MID$(MEV$,I,1)
  @MEVSK
 NEXT
 B=BUTTON()
 IF B==4THEN MEV_C=MEV_C-1:MEV_OF=0
 IF B==8THEN MEV_C=MEV_C+1
 IF B==128THEN GOSUB@MEV_BS
 IF MEV_C<0THEN MEV_C=0
 IF MEV_C>=LEN(MEV$)THEN MEV_C=LEN(MEV$)-1:MEV_OF=1:'EEP
 KEYFLG=KEYFLG+(WINACTV==1)
 IF WINACTV==1THEN @MEV_ED
RETURN
@MEV_BS
 IF LEN(MEV$)==0THEN RETURN
 IF MEV_OF THEN MEV$=MID$(MEV$,0,LEN(MEV$)-1)
 IF!MEV_OF THEN MEV$=MID$(MEV$,0,MEV_C-1)+MID$(MEV$,MEV_C,256)
 MEV_C=MEV_C-1
RETURN
@MEV_ED
 INK$=KEYBF$:KEYBF$=""
 IF MEV_OF AND KEYFLG==1AND INK$!=""THEN MEV$=MEV$+INK$
 IF!MEV_OF AND KEYFLG==1AND INK$!=""THEN MEV$=MID$(MEV$,0,MEV_C)+INK$+MID$(MEV$,MEV_C,256)
MEV_C=MEV_C+LEN(INK$)
RETURN
@MEV_F
 LOAD "MEM:"+MEV_F$,0
 MEV$=MEM$
RETURN
'08/31 RESIZE À²µ³
@S_CLOCK
 WIN_MODE=1
WIN_R=1
GOSUB @WINFLAG
 WINX2=66
 WINY2=75
 WINTTL$="CLOCK
 WINCLS=1
 CLOCKDF1=(WINY2-WINDEGY)/2
 CLOCKDF2=WINX2/2
 CLOCKDF3=0
 IF CLOCKDF2>CLOCKDF1 THEN _E=_C
 IF CLOCKDF1>=CLOCKDF2 THEN _E=_D
RETURN
@WIN_CLOCK
 WINTTL$="CLOCK "+TIME$
 GOSUB @WINDOW
 IF WINY2<28THEN WINY2=28
 IF WINIDFLG==1THEN RETURN
 _C=(WINY2-WINDEGY)/2
 _D=WINX2/2
 _E=0
 IF _D>_C THEN _E=_C
 IF _C>=_D THEN _E=_D
 GCIRCLE WX+WINX2/2,WY+(WINY2+WINDEGY)/2,_E,7
 TMREAD(TIME$),A,B,C
 B=B+C/60
 A=A%12
 E=_D+WX+COS(RAD((180+90+C*6)%360))*(_E-4)'+2
 D=_C+WY+SIN(RAD((180+90+C*6)%360))*(_E-4)'+10
 GLINE E+2,D+10,WX+_D+2,WY+_C+10,13
 E=_D+WX+COS(RAD((180+90+B*6)%360))*(_E-(_E/10))'+2
 D=_C+WY+SIN(RAD((180+90+B*6)%360))*(_E-(_E/10))'+10
 GLINE E+2,D+WINDEGY,WX+_D+2,WY+_C+WINDEGY,14
 E=_D+WX+COS(RAD((180+90+A*30+B*0.5)%360))*(_E-(_E/4))'+2
 D=_C+WY+SIN(RAD((180+90+A*30+B*0.5)%360))*(_E-(_E/4))'+10
 GLINE E+2,D+WINDEGY,WX+_D+2,WY+_C+WINDEGY,14
RETURN
@C_CLOCK
 GOSUB @WINCLOSE
RETURN
@S_MONO
 GOSUB @OTWCOL
 WINCLS=1 
 FOR I=0TO 255
  COLREAD("SP",I),R,G,B
  C=(R+G+B)/3
  COLSET "GRP",I,HEX$(C,2)*3
  COLSET "SP",I,HEX$(C,2)*3
  COLSET "BG",I,HEX$(C,2)*3
 NEXT
RETURN
@WIN_MONO
RETURN
@C_MONO
 GOSUB @OTWCOL
 GOSUB @WINCLOSE
RETURN
@S_MONO3
 GOSUB @S_MONO
 WINCLS=1 
 FOR I=0TO 255
  COLREAD("SP",I),R,G,B
  C=(R+G+B)/3
  C=0OR (C+1)/128
  C=C*127
  COLSET "GRP",I,HEX$(C,2)*3
  COLSET "SP",I,HEX$(C,2)*3
  COLSET "BG",I,HEX$(C,2)*3
 NEXT
RETURN
@WIN_MONO3
RETURN
@C_MONO3
 GOSUB @WINCLOSE
 GOSUB @OTWCOL
RETURN
@S_MONO2
 GOSUB @OTWCOL
WINCLS=1
FOR I=0TO 255
 COLREAD("SP",I),R,G,B
 C=(R+G+B)/3
 IF C>127THEN C=255 ELSE C=0
  COLSET "GRP",I,HEX$(C,2)*3
  COLSET "SP",I,HEX$(C,2)*3
  COLSET "BG",I,HEX$(C,2)*3

NEXT
RETURN
@WIN_MONO2
RETURN
@C_MONO2
GOSUB @WINCLOSE
GOSUB @OTWCOL
RETURN
@S_COL2
 WINCLS=1
 GOSUB @OTWCOL
 FOR COL_I=0TO 255
  COLREAD("SP",COL_I),R,G,B
  IF R<64THEN R=0
  IF R>64AND R<128THEN R=128
  IF R>128AND R<192 THEN R=192
  IF R>192 THEN R=255

  IF G<64THEN G=0
  IF G>64AND G<128THEN G=128
  IF G>128 AND G<192THEN G=192
  IF G>192 THEN G=255

  IF B<64THEN B=0
  IF B>64AND B<128THEN B=128
  IF B>128 AND B<192THEN B=192
  IF B>192 THEN B=255
'  COMP$=STR$(R)+":"+STR$(G)+":"+STR$(B):GOSUB COMPRT$
  COLSET "SP",COL_I,HEX$(R,2)+HEX$(G,2)+HEX$(B,2)
  COLSET "GRP",COL_I,HEX$(R,2)+HEX$(G,2)+HEX$(B,2)
  COLSET "BG",COL_I,HEX$(R,2)+HEX$(G,2)+HEX$(B,2)
 NEXT
RETURN
@WIN_COL2
RETURN
@C_COL2
 GOSUB @OTWCOL
 GOSUB @WINCLOSE
RETURN
@S_COL
WINCLS=1
GOSUB @OTWCOL
D=128
FOR I=0TO 255
 COLREAD("SP",I),R,G,B
' R=(0OR (R/D))*D
' G=(0OR (G/D))*D
' B=(0OR (B/D))*D
 IF R>128THEN R=255
 IF R<128THEN R=0
 IF G>128THEN G=255
 IF G<128THEN G=0
 IF B>128THEN B=255
 IF B<128THEN B=0
 COLSET "SP",I,HEX$(R,2)+HEX$(G,2)+HEX$(B,2)
 COLSET "BG",I,HEX$(R,2)+HEX$(G,2)+HEX$(B,2)
 COLSET "GRP",I,HEX$(R,2)+HEX$(G,2)+HEX$(B,2)
NEXT
RETURN
@WIN_COL
RETURN
@C_COL
GOSUB @WINCLOSE
GOSUB @OTWCOL
RETURN
@S_DBG
 WINY2=25
 WINTTL$="DBG"
RETURN
@WIN_DBG
 WINSX=0:WINSY=0:WINSC=1
 WINSTR$="X:"+STR$(MOUSEX-WINSX[0])
 GOSUB @WINSTRPUT
 WINSX=0:WINSY=8:WINSC=1
 WINSTR$="Y:"+STR$(MOUSEY-WINSY[0])
 GOSUB @WINSTRPUT
RETURN
@S_M
 WIN_MODE=1
 WINTTL$="µÃÞº ËÛ²
 WINX2=100:WINY2=45
 GOSUB @WINFLAG
RETURN
@DGS_WIN_M
 WINDEGY=20
 WINDEGY2=1
 WINDEGX=1
 WINDEGX2=1
RETURN
@DEG_WIN_M
GFILL WX,WY,WX2,WY2,0
GFILL WX,WY,WX2,WY+19,15
GBOX WX,WY,WX2,WY2,13
 WINSX=8:WINSY=-20:WINSC=1:WINSTR$=WINTTL$[TSK]
 GOSUB @WINSTRPUT
RETURN
@WIN_M
 WINDESIGN$="WIN_M"
 GOSUB @WINDOW:IF WINIDFLG==1THEN RETURN
 WINSX=5:WINSY=0:WINSC=0:WINSTR$="ÄÞ¸¼ÞWINDOW
 GOSUB @WINSTRPUT
RETURN
@S_DT
 WIN_MODE=1
 GOSUB @WINFLAG
RETURN
@WIN_DT
 WINDESIGN$="WIN_M"
 GOSUB @WINDOW:IF WINIDFLG==1THEN RETURN
 WINBX=0:WINBY=0:WINBSTR$="TST
  GOSUB @WINBTN
 IF WINBTNF==1THEN TALK "³Ü±±±±±µ»ÚÀ±±±±
 WINTX=0
 WINTY=12
 WINTX2=WINX2
 WINTXTP$=WINDT$
 WINTA=WINDT_A
 WINTSX=WINDT_SX
  GOSUB @WINTXTBOX
 WINDT$=WINTXT$
 WINDT_A=WINTA
 WINDT_SX=WINTSX
RETURN
@S_W3
 WINTTL$="WWW
 WIN_MODE=1
 GOSUB @WINFLAG
RETURN
@DGS_W3
 WINDEGY=9
 WINDEGX=8
 WINDEGY2=8
 WINDEGX2=8
RETURN
@DEG_W3
 GFILL WX,WY,WX2,WY2,WINBG
 GFILL WX,WY,WX2,WY+8,1
 GFILL WX,WY+9,WX+8,WY2,13
 GFILL WX+9,WY2-8,WX2,WY2,13
 GFILL WX2-8,WY+9,WX2,WY2-8,13
 GBOX WX2-8,WY,WX2,WY+8,15
 GFILL WX2-7,WY+1,WX2-1,WY+7,13
 GLINE WX2-6,WY+2,WX2-2,WY+6,14
 GLINE WX2-2,WY+2,WX2-6,WY+6,14
 WINSX=-8:WINSY=-8:WINSTR$=WINTTL$:WINSC=0
 GOSUB @WINSTRPUT
RETURN
@WIN_W3
 WINDESIGN$="W3"
 GOSUB @WINDOW:IF WINIDFLG==1THEN RETURN
 WINSX=0:WINSY=0:WINSC=1:WINSTR$="WWWDS
 GOSUB @WINSTRPUT
RETURN
@S_SEIUN
 WINY2=32
 WINTTL$="¾²³Ý
RETURN
@WIN_SEIUN
 WINTXTP$=STR$(WINSEIUN)
 WINTA=SEIUN_A
 WINTSX=SEIUN_X
 WINTX=0
 WINTX2=62
 WINTY=0
 GOSUB @WINTXTBOX
 SEIUN_X=WINTSX
 SEIUN_A=WINTA
 WINSEIUN=VAL(WINTXT$)
 WINBX=0:WINBY=12:WINBSTR$="OK
 GOSUB @WINBTN
 IF WINBTNF==1 THEN WINSTAR=WINSEIUN
RETURN
@S_STAR
 WIN_MODE=1:GOSUB @WINFLAG
 WINX2=128:WINY2=64
 WINSTAR=7
RETURN
@WIN_STAR
 WINTTL$="O"+STR$(WINSTAR)+"¾²³Ý
 WINBG=14:GOSUB @WINDOW:IF WINIDFLG==1THEN RETURN
 R=0:S=0
 FOR I=0TO 10
  S=((S+15)*WINSTAR)AND 4095
  R=S/4096
  S=((S+15)*WINSTAR)AND 4095
  T=S/4096
  GPSET WFX+R*128,WFY+T*54,15
 NEXT
RETURN
@S_CAVEM
 CAVE_MU=1
 WINNAME$[TSK]="CAVE
 GOTO @S_CAVE
RETURN
@S_CAVE
 GOSUB@WINFLAG
 GOSUB @WINBUFF
 IF BF==0THEN GOSUB@SYS_ERR_BUFF:RETURN
 CAVE_BF=BF
' CAVE_MU=0
 WINTTL$="CAVE-OCHAME"+"„I"*CAVE_MU
 GOSUB@INI_CAVE
RETURN
@INI_CAVE
CAVE_S=0
CAVE_Y=30
 CAVE_V=RND(122)
 CAVE_P=0
 CAVE_W=0
 WINY2=191/2+11
 WINX2=125
 BFC=14:GOSUB@WINBUFFGCLS
' GPAGE 0,CAVE_BF,WINGPAGE:GCLS 14:GPAGE 0,!WINGPAGE,WINGPAGE
 CAVE_SI=2
 WINCLS=1
 CAVE_U=0
 CAVE_X=0
 CAVE_CLEAR=0
RETURN
@C_CAVE
 CAVE_MU=0
 GOSUB @WINCLOSE
 CAVE_GV=0
 CAVE_S=0
 BF=CAVE_BF:GOSUB @WINBUFFC
RETURN
@WIN_CAVE
 BF=CAVE_BF
 BF_X=4
 BF_Y=0
 BF_X2=255/CAVE_SI
 BF_Y2=191/CAVE_SI
 GOSUB @WINBUFFCPY
'GCOPY CAVE_BF,4,0,255/CAVE_SI,191/CAVE_SI,WFX,WFY,0
 WINSX=0:WINSY=0WINSC=0
 WINSTR$=STR$(0OR CAVE_S)
 GOSUB @WINSTRPUT
 WINSX=0
 WINSY=8
 IF CAVE_S>=500000 THEN WINSTR$="CLEAR!"CAVE_CLEAR=1GOSUB @WINSTRPUT:RETURN
 WINSTR$="RESET CLICK"
 IF CAVE_GV THEN GOSUB @WINSTRPUT
 IF CAVE_GV==1AND WINACTV==1AND CLICK3==1AND WINFLG[TSK]==2THEN  GOSUB@INI_CAVE:CAVE_GV=0
 IF CAVE_GV==1THEN RETURN
 BF=CAVE_BF
 GOSUB @WINBUFFP:'GPAGE 0,CAVE_BF,M
 CAVE_P=CAVE_P+1:CAVE_W=70-CAVE_P/20
 GCOPY CAVE_BF,8/CAVE_SI,0,255/CAVE_SI,191/CAVE_SI,0,0,1
 GFILL (254-6)/CAVE_SI,0,255/CAVE_SI,191/CAVE_SI,7
 GFILL (254-6)/CAVE_SI,CAVE_V/CAVE_SI,255/CAVE_SI,(CAVE_V+CAVE_W)/CAVE_SI,14
 CAVE_I=(GSPOIT(34/CAVE_SI,(CAVE_Y)/CAVE_SI+2)<14)CAVE_S=CAVE_S+1/CAVE_SI
 IF CAVE_I==1AND CAVE_MU==0THEN CAVE_GV=1
 GFILL 30/CAVE_SI,CAVE_Y/CAVE_SI,34/CAVE_SI,(CAVE_Y+4)/CAVE_SI,2
 CAVE_X=CAVE_X-(16 AND BUTTON())%5+0.5
 CAVE_S=CAVE_S+(0OR ABS(CAVE_X))CAVE_U=RND(2)*4-2
 CAVE_V=CAVE_V+CAVE_U*(CAVE_U+CAVE_V>0)*(CAVE_U+CAVE_V+CAVE_W<191)
 CAVE_Y=CAVE_Y+CAVE_X/CAVE_SI
 GOSUB@WINBUFFP2:'GPAGE 0,!M,M
RETURN
@S_PAINT
 WINMLT[TSK]=PAINT_M
 BF=0
 GOSUB @WINBUFF
 IF BF==0THEN GOSUB@SYS_ERR_BUFF:RETURN
 PAINT_BF[PAINT_M]=BF
 BFC=15
 GOSUB @WINBUFFGCLS
 PAINTF[PAINT_M]=0
 WINTTL$="PAINT
 PAINT_M=(PAINT_M+1)%2
 WINCLS=1
RETURN
@C_PAINT
 BF=PAINT_BF[WINMLT[TSK]]
 GOSUB @WINBUFFC
 GOSUB @WINCLOSE
RETURN
@WIN_PAINT
 P=WINMLT[TSK]'PAINT_C
' PAINT_C=(PAINT_C+1)%PAINT_M
 PAINTF2=0
 IF PAINTF[P]==0THEN PAINTF[P]=1:RETURN
 IF WINACTV==0OR WINFLG[0]==3THEN PAINTF2=1
 BF=PAINT_BF[P]BF_X=0BF_Y=0BF_X2=62BF_Y2=52
 GOSUB @WINBUFFCPY
' GCOPY PAINT_BF[P],0,0,62,52,WFX,WFY,1
 BF=PAINT_BF[P]
 GOSUB @WINBUFFP
 IF PAINTF2==0AND CLICK==0AND CLICK2==1THEN GLINE MOUSEX-WFX,MOUSEY-WFY,PAINTX[P],PAINTY[P],14
 PAINTX[P]=MOUSEX-WFX
 PAINTY[P]=MOUSEY-WFY
' PAINT_O=CLICK2
' GPSET MOUSEX-WFX,MOUSEY-WFY,14
 GOSUB @WINBUFFP2

RETURN
@INI_GAME1
 GAME1_X=16
 GAME1_Y=95-20
 GAME1_N=10
 GAME1_GV=0
RETURN
@S_GAME1
 WINCLS=1
 WINX2=130
 WINY2=192/2+11
 GOSUB @WINBUFF
 IF BF==0THEN GOSUB@SYS_ERR_BUFF:RETURN
 BFC=6
 GAME1_BF=BF
 GOSUB @WINBUFFGCLS
 GOSUB @WINBUFFP
  GFILL 0,96-16,128,96,7
 GOSUB @WINBUFFP2
 GOSUB @INI_GAME1
 WINTTL$="GAME1
RETURN
@WIN_GAME1
 BF=GAME1_BF:BF_X=0BF_Y=0BF_X2=128BF_Y2=96GOSUB@WINBUFFCPY
' GCOPY GAME1_BF,0,0,128,96,WFX,WFY,1
 GFILL GAME1_X-4+WFX,WFY+GAME1_Y-4,WFX+GAME1_X+4,GAME1_Y+4+WFY,4
 IF GAME1_GV==1AND WINACTV==1AND CLICK3==1AND WINFLG[TSK]==2THEN GOSUB@INI_GAME1
 IF GAME1_GV==1THEN RETURN
 IF BUTTON()AND 4THEN GAME1_X=GAME1_X-1
 IF BUTTON()AND 8THEN GAME1_X=GAME1_X+4
 IF(BUTTON()AND 16)==16AND GAME1_J==0THEN GAME1_J=1
 IF GAME1_J==1THEN GAME1_Y=GAME1_Y*0.9
 IF GAME1_J==2THEN GAME1_Y=GAME1_Y*1.1
 IF GAME1_J==1AND GAME1_Y<=16THEN GAME1_J=2
 IF GAME1_J==2AND GAME1_Y>=95-20THEN GAME1_J=0: GAME1_Y=95-20
 GAME1_X=GAME1_X-2-!!JMPFLG
 IF GAME1_X<0THEN GAME1_X=0
 BF=GAME1_BF
 GOSUB @WINBUFFP
  GCOPY GAME1_BF,2,0,128,96,0,0,1
  GAME1_A1=GSPOIT(GAME1_X-4,GAME1_Y+8)
  GAME1_A2=GSPOIT(GAME1_X,GAME1_Y+8)
  GAME1_A3=GSPOIT(GAME1_X+4,GAME1_Y+8)
  IF !(GAME1_A1+GAME1_A2+GAME1_A3)THEN GAME1_GV=1
  GAME1_R=RND(GAME1_N)
  GAME1_A=GSPOIT(GAME1_X,GAME1_Y)
  IF GAME1_A==2THEN GAME1_GV=1
  GFILL 128-ABS(RND(15-GAME1_N)),96-16,128,96,!!GAME1_R*7
  GAME1_B=RND(24)
  GAME1_BH=RND(20)
  IF GAME1_BH==0THEN GFILL 126,GAME1_B+8,128,GAME1_B,2
  IF GAME1_BH!=0THEN GFILL 126,0,128,79,6
  GAME1_N=GAME1_N-0.001
 GOSUB @WINBUFFP2
RETURN
@C_GAME1
 BF=GAME1_BF
 GOSUB @WINBUFFC
GOSUB @WINCLOSE
GAME1_GV=0
RETURN
@S_MAC
 WIN_MODE=1:GOSUB @WINFLAG
 WINTTL$="MAC
RETURN
@WIN_MAC
 WINDESIGN$="MAC
 GOSUB @WINDOW
RETURN
@DGS_MAC
 WINDEGW=1
 WINDEGX=1
 WINDEGX2=1
 WINDEGY=10
 WINDEGY2=1
RETURN
@DGW_MAC
 IF WINFLG[TSK]==4THEN @DGW_MAC_S
 F=0IF MOUSEX>=WX AND MOUSEX<=WX2 AND MOUSEY>=WY AND MOUSEY<=WY2 THEN F=1
 IF F==0AND CLICKF==1THEN WINFLG[TSK]=1:WINACTV=0:WINFLG=1:RETURN
 F=0:IF MOUSEX>=WX+11 AND MOUSEX<=WX2 THEN F=1
 IF F==1 AND MOUSEY>=WY AND MOUSEY<=WFY THEN F=2
 IDF=0
 IF F==2 AND CLICK==1AND IDOUT==0THEN WINFLG=3:IDOUFLG=1:IDF=1GOSUB @WINSWP:RETURN
 IF F==2 AND CLICKF==1AND IDOUT==0THEN WINFLG[TSK]=2GOSUB @WINSWP:RETURN
 IF WINFLG==3THEN IDOUT=1:GOSUB @WINIDOU2

 F=0:IDOUFLG=0:IF MOUSEX>=WX AND MOUSEX<=WX2 THEN F=1
 IF F==1 AND MOUSEY>=WFY AND MOUSEY<=WY2 THEN F=2
 IF F==2 AND CLICKF==1THEN WINFLG[TSK]=2:GOSUB @WINSWP:RETURN
 F=0:IDOUFLG=0
 IF MOUSEX>=WX AND MOUSEX<=WX+11 THEN F=1
 IF F==1 AND MOUSEY>=WY AND MOUSEY<WFY THEN F=2
 IF F==2 AND CLICKF==1THEN WINFLG[TSK]=2:GOSUB @WINSWP:'RETURN

@DGW_MAC_S
 F=0
 IF MOUSEX>=WX+4  AND MOUSEX<=WX+9 THEN F=1
 IF F==1 AND MOUSEY>=WY+3 AND MOUSEY<WFY-3 THEN F=2
 IF (F==2AND CLICK==1)OR WINFLG[TSK]==4THEN WINCS=0GOTO@DGM_MAC
WINCS=0
RETURN
@DGM_MAC
 WINFLG[0]=4
 GFILL WX+4,WFY-2,WX+56,WFY+10,15
 GBOX WX+4,WFY-2,WX+56,WFY+10,14
 F=0
 IF MOUSEX<WX+4OR MOUSEX>WX+56 THEN F=1
 IF MOUSEY<WY+3OR MOUSEY>WFY+10THEN F=1
 IF CLICK==1AND F==1THEN WINFLG[TSKB]=2
 F=0
 IF MOUSEX>=WX+5AND  MOUSEX<=WX+45 THEN F=1
 IF F==1AND MOUSEY>=WFY AND MOUSEY<=WFY+8THEN F=2
 IF F==2AND CLICK==1THEN GOSUB @WINCLOSEGT
 IF F==2THEN GFILL WX+4,WFY-1,WX+55,WFY+8,14
 WINSX=4
 WINSY=0
 WINSTR$="CLOSE"
 WINSC=1*F!=2
 GOSUB @WINSTRPUT
RETURN
@DEG_MAC
 IF WINDEGW==1AND WINIDFLG==1THEN GOTO @DGW_MAC
 GFILL WX,WY,WX2,WFY,15
 GFILL WFX,WFY,WFX2,WFY2,WINBG
 GBOX WX,WY,WX2,WY2,14
 GLINE WX,WY+10,WX2,WY+10,14
 IF WINACTV==1THEN GOSUB @DEGMAC
 WINSTR$=WINTTL$
 WINSX=(WINX2/2+6.5)-(LEN(WINTTL$[TSK])/2)*8-1
 IF WINSX<12THEN WINSX=12
 WINSY=-9
 WINSX2=WINSX+WX+LEN(WINTTL$)*8
 IF WINSX2>WX2 THEN WINSX2=WX2-2
 GFILL WINSX+WX,WY+1,WINSX2,WY+9,15
 WINSC=1
 GOSUB @WINSTRPUT
 GFILL WX+3,WY+3,WX+10,WY+7,15
 GBOX WX+4,WY+3,WX+9,WY+7,14
RETURN
@DEGMAC
GLINE WX+2,WY+3,WX2-2,WY+3,14GLINE WX+2,WY+5,WX2-2,WY+5,14GLINE WX+2,WY+7,WX2-2,WY+7,14
RETURN
@S_LONG
 WINTTL$="A"*256
RETURN
@WIN_LONG
RETURN

@S_MENU
 WINTTL$="MENUBAR
 WINX2=64+8
RETURN
@WIN_MENU
 WFX2=WFX2+800
 WINMK=OTYAMKF
 WINMKS=OTYAMKFS
 WINMX=0WINMY=0:WINMX2=64
 WINMMAX=3
 WINM$[0]="MENU1"
' WINMENU[0]=16
 WINM$[1]="2"
 WINM$[2]="3"
 WINM$[3]="4"
 GOSUB @WINMENU
 OTYAMKF=WINMK:OTYAMKFS=WINMKS
 IF WINM==-1THEN OTYAMK2=0:
 IF WINM==-1GOTO@WIN_MENU_S:' ELSE OTYAMKF=1:OTYAMKFS=WINM
 WINMX=0WINMY=8
 GOSUB "@WIN_MENU_"+STR$(WINM)
 WINMK=OTYAMK2:WINMKS=OTYAMKS2
 GOSUB @WINMENU2
 OTYAMK2=WINMK:OTYAMKS2=WINMKS
 WINMK=0:WINMKS=0
 IF WINM==1THEN OTYAMENU=1ELSE OTYAMENU=0
 IF WINM==1THEN GOSUB @WIN_MENU__

@WIN_MENU_S
 WFX2=WFX2-800
RETURN
@WIN_MENU__
 OTYAMK2=1
 OTYAMKS2=1
 WINM$[0]="FILES
 WINM$[1]="LOAD"
 WINM$[2]="RUN"
 WINM$[3]="CONT"
 WINM$[4]="SAVE"
 WINMX2=80
 WINMK=OTYAMK3:WINMKS=OTYAMKS3
 WINM=-9
 WINMX=40WINMY=16:WINMMAX=4:GOSUB @WINMENU2
 OTYAMK3=WINMK:OTYAMKS3=WINMKS
 IF WINM==0THEN GOSUB @WIN_MENU___
 IF WINM==1THEN GOSUB @WIN_MENU___
 IF WINM==4THEN GOSUB @WIN_MENU___
 IF WINM==2THEN GOSUB @WIN_MENU___R
RETURN
@WIN_MENU___
 WINM$[0]="PRG
 WINM$[1]="MEM
 WINM$[2]="CHR
 WINM$[3]="GRP

 WINMX2=120
 WINMK=OTYAMK4:WINMKS=OTYAMKS4
 WINMX=80WINMY=8:WINMMAX=3:GOSUB @WINMENU2
 OTYAMK4=WINMK:OTYAMKS4=WINMKS
 WINM=-1
RETURN
@WIN_MENU___R
 WINM$[0]="@COMMAND
 WINM$[1]="@OTW
 WINMX2=143
 WINMK=OTYAMK4R:WINMKS=OTYAMKS4R
 WINMX=80WINMY=24:WINMMAX=1:GOSUB @WINMENU2
 
 OTYAMK4R=WINMK:OTYAMKS4R=WINMKS
RETURN
@WIN_MENU_0
 WINMX2=40
 WINM$[0]="MENU"
 WINM$[1]="MENU2"
 WINMMAX=1
RETURN
@WIN_MENU_1
RETURN
@WIN_MENU_2
RETURN
@WIN_MENU_3
RETURN

@C_MINE
 BF=MINE_BF
 GOSUB @WINBUFFC
 GOSUB @WINCLOSE
 MINE_F=0
 FOR I=0TO 63
 FOR J=0TO 63
 MINE_M[I,J]=0
 MINE_F[I,J]=0
 NEXT
 NEXT
RETURN
'DRAW DATA
@N_MINE_N0
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,13
 
 GLINE MINE_NX,MINE_NY,MINE_NX+6,MINE_NY,15
 GLINE MINE_NX,MINE_NY+1,MINE_NX+6,MINE_NY+1,15
 GLINE MINE_NX,MINE_NY+2,MINE_NX,MINE_NY+6,15
 GLINE MINE_NX+1,MINE_NY+2,MINE_NX+1,MINE_NY+6,15
 
 GLINE MINE_NX+7,MINE_NY+1,MINE_NX+7,MINE_NY+7,1
 GLINE MINE_NX+6,MINE_NY+2,MINE_NX+6,MINE_NY+7,1
 GLINE MINE_NX+2,MINE_NY+6,MINE_NX+5,MINE_NY+6,1
 GLINE MINE_NX+1,MINE_NY+7,MINE_NX+5,MINE_NY+7,1
RETURN
@N_MINE_N11
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,1
 GFILL MINE_NX+1,MINE_NY+1,MINE_NX+7,MINE_NY+7,13
RETURN
@N_MINE_N1
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,1
 GFILL MINE_NX+1,MINE_NY+1,MINE_NX+7,MINE_NY+7,13
 GLINE MINE_NX+4,MINE_NY+1,MINE_NX+4,MINE_NY+7,4
 GLINE MINE_NX+2,MINE_NY+2,MINE_NX+3,MINE_NY+2,4
 GLINE MINE_NX+2,MINE_NY+7,MINE_NX+6,MINE_NY+7,4
RETURN
@N_MINE_N2
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,1
 GFILL MINE_NX+1,MINE_NY+1,MINE_NX+7,MINE_NY+7,13
 GLINE MINE_NX+3,MINE_NY+1,MINE_NX+5,MINE_NY+1,10
 GPSET MINE_NX+2,MINE_NY+2,10
 GLINE MINE_NX+6,MINE_NY+2,MINE_NX+6,MINE_NY+3,10
 GLINE MINE_NX+5,MINE_NY+4,MINE_NX+2,MINE_NY+7,10
 GLINE MINE_NX+3,MINE_NY+7,MINE_NX+6,MINE_NY+7,10 
RETURN
@N_MINE_N3
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,1
 GFILL MINE_NX+1,MINE_NY+1,MINE_NX+7,MINE_NY+7,13
 GPSET MINE_NX+2,MINE_NY+2,2
 GLINE MINE_NX+3,MINE_NY+1,MINE_NX+5,MINE_NY+1,2
 GLINE MINE_NX+6,MINE_NY+2,MINE_NX+6,MINE_NY+3,2
 GLINE MINE_NX+4,MINE_NY+4,MINE_NX+5,MINE_NY+4,2
 GLINE MINE_NX+6,MINE_NY+5,MINE_NX+6,MINE_NY+6,2
 GLINE MINE_NX+3,MINE_NY+7,MINE_NX+5,MINE_NY+7,2
 GPSET MINE_NX+2,MINE_NY+6,2
RETURN
@N_MINE_N4
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,1
 GFILL MINE_NX+1,MINE_NY+1,MINE_NX+7,MINE_NY+7,13
 GLINE MINE_NX+5,MINE_NY+1,MINE_NX+2,MINE_NY+4,194
 GLINE MINE_NX+5,MINE_NY+2,MINE_NX+5,MINE_NY+7,194
 GLINE MINE_NX+2,MINE_NY+6,MINE_NX+6,MINE_NY+6,194
 GPSET MINE_NX+2,MINE_NY+5,194
RETURN
@N_MINE_N5
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,1
 GFILL MINE_NX+1,MINE_NY+1,MINE_NX+7,MINE_NY+7,13
 GLINE MINE_NX+2,MINE_NY+1,MINE_NX+6,MINE_NY+1,49
 GLINE MINE_NX+2,MINE_NY+2,MINE_NX+2,MINE_NY+4,49
 GLINE MINE_NX+3,MINE_NY+3,MINE_NX+5,MINE_NY+3,49
 GLINE MINE_NX+6,MINE_NY+4,MINE_NX+6,MINE_NY+6,49
 GLINE MINE_NX+3,MINE_NY+7,MINE_NX+5,MINE_NY+7,49
 GPSET MINE_NX+2,MINE_NY+6,49
RETURN
@N_MINE_N6
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,1
 GFILL MINE_NX+1,MINE_NY+1,MINE_NX+7,MINE_NY+7,13
 GLINE MINE_NX+4,MINE_NY+1,MINE_NX+5,MINE_NY+1,27
 GLINE MINE_NX+2,MINE_NY+3,MINE_NX+2,MINE_NY+6,27
 GLINE MINE_NX+3,MINE_NY+4,MINE_NX+5,MINE_NY+4,27
 GLINE MINE_NX+6,MINE_NY+5,MINE_NX+6,MINE_NY+6,27
 GLINE MINE_NX+3,MINE_NY+7,MINE_NX+5,MINE_NY+7,27
 GPSET MINE_NX+3,MINE_NY+2,27
RETURN
@N_MINE_N7
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,1
 GFILL MINE_NX+1,MINE_NY+1,MINE_NX+7,MINE_NY+7,13
 GLINE MINE_NX+2,MINE_NY+1,MINE_NX+6,MINE_NY+1,14
 GLINE MINE_NX+6,MINE_NY+2,MINE_NX+4,MINE_NY+4,14
 GLINE MINE_NX+4,MINE_NY+5,MINE_NX+4,MINE_NY+7,14
 GPSET MINE_NX+2,MINE_NY+2,14
RETURN
@N_MINE_N8
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,1
 GFILL MINE_NX+1,MINE_NY+1,MINE_NX+7,MINE_NY+7,13
 GLINE MINE_NX+3,MINE_NY+1,MINE_NX+5,MINE_NY+1,29
 GLINE MINE_NX+2,MINE_NY+2,MINE_NX+2,MINE_NY+3,29
 GLINE MINE_NX+6,MINE_NY+2,MINE_NX+6,MINE_NY+3,29
 GLINE MINE_NX+3,MINE_NY+4,MINE_NX+5,MINE_NY+4,29
 GLINE MINE_NX+2,MINE_NY+5,MINE_NX+2,MINE_NY+6,29
 GLINE MINE_NX+6,MINE_NY+5,MINE_NX+6,MINE_NY+6,29
 GLINE MINE_NX+3,MINE_NY+7,MINE_NX+5,MINE_NY+7,29
RETURN
'BOMB
@N_MINE_N9
 GFILL MINE_NX,MINE_NY,MINE_NX+7,MINE_NY+7,1
 GFILL MINE_NX+1,MINE_NY+1,MINE_NX+7,MINE_NY+7,13
 GPSET MINE_NX+2,MINE_NY+2,14
 GPSET MINE_NX+3,MINE_NY+3,15
 GLINE MINE_NX+2,MINE_NY+4,MINE_NX+6,MINE_NY+4,14
 GLINE MINE_NX+4,MINE_NY+2,MINE_NX+4,MINE_NY+6,14
 GLINE MINE_NX+3,MINE_NY+5,MINE_NX+2,MINE_NY+6,14
 GLINE MINE_NX+5,MINE_NY+5,MINE_NX+6,MINE_NY+6,14
 GLINE MINE_NX+6,MINE_NY+2,MINE_NX+5,MINE_NY+3,14
RETURN
@N_MINE_N10 '?
 GOSUB @N_MINE_N0
 GLINE MINE_NX+1,MINE_NY+1,MINE_NX+2,MINE_NY+0,14 
 GLINE MINE_NX+4,MINE_NY+1,MINE_NX+3,MINE_NY+0,14 
 GLINE MINE_NX+4,MINE_NY+2,MINE_NX+3,MINE_NY+3,14 
 GPSET MINE_NX+3,MINE_NY+5,14 
RETURN
@N_MINE_N12
 GOSUB @N_MINE_N0
 GPSET MINE_NX+2,MINE_NY+2,2
 GLINE MINE_NX+3,MINE_NY+1,MINE_NX+3,MINE_NY+3,2
 GLINE MINE_NX+4,MINE_NY+1,MINE_NX+4,MINE_NY+3,2
 GPSET MINE_NX+4,MINE_NY+4,14
 GLINE MINE_NX+3,MINE_NY+5,MINE_NX+5,MINE_NY+5,14
RETURN
@N_MINE_N13
 GOSUB @N_MINE_N9
 GPAINT MINE_NX+1,MINE_NY+1,2
RETURN
@N_MINE_N14
 GOSUB @N_MINE_N9
 GLINE MINE_NX+2,MINE_NY+2,MINE_NX+6,MINE_NY+6,2
 GLINE MINE_NX+6,MINE_NY+2,MINE_NX+2,MINE_NY+6,2
RETURN
'0=Å¼
'1=1
'2=2
'8=8
'9=BOM
'10=?
'11=FLG
'12=OPEN
'13ÊÞ¸ÊÂ
'14Ì¾¶ÞÚÀ
@N_MINE
 BF=MINE_BF
 GOSUB @WINBUFFP
 FOR I=0TO MINE_X-1
  FOR J=0TO MINE_Y-1
   MINE_F[I,J]=0
   MINE_M[I,J]=(RND(MINE_BOM)==0)*9
   MINE_BOMB=MINE_BOMB+(MINE_M[I,J]==9)
   MINE_NX=I*8
   MINE_NY=J*8
   GOSUB @N_MINE_N0
  NEXT
 NEXT
 '½³¼Þ¾¯Ä
 FOR I=0TO MINE_X-1
  FOR J=0TO MINE_Y-1
   IF MINE_M[I,J]==9AND I>0THEN IF MINE_M[I-1,J]!=9THEN MINE_M[I-1,J]=MINE_M[I-1,J]+1
   IF MINE_M[I,J]==9AND I<MINE_X-1 THEN IF MINE_M[I+1,J]!=9THEN MINE_M[I+1,J]=MINE_M[I+1,J]+1
   IF MINE_M[I,J]==9AND J>0THEN IF MINE_M[I,J-1]!=9THEN MINE_M[I,J-1]=MINE_M[I,J-1]+1
   IF MINE_M[I,J]==9AND J<MINE_Y-1 THEN IF MINE_M[I,J+1]!=9THEN MINE_M[I,J+1]=MINE_M[I,J+1]+1
   F=0
   IF MINE_M[I,J]==9AND I<MINE_X-1AND J>0THEN IF MINE_M[I+1,J-1]!=9THEN F=1
   IF F==1THEN MINE_M[I+1,J-1]=MINE_M[I+1,J-1]+1
   F=0
   IF MINE_M[I,J]==9AND J<MINE_Y-1AND I>0THEN IF MINE_M[I-1,J+1]!=9THEN F=1
   IF F==1THEN MINE_M[I-1,J+1]=MINE_M[I-1,J+1]+1
   F=0
   IF MINE_M[I,J]==9AND J>0AND I>0THEN IF MINE_M[I-1,J-1]!=9THEN F=1
   IF F==1THEN MINE_M[I-1,J-1]=MINE_M[I-1,J-1]+1
   F=0
   IF MINE_M[I,J]==9AND J<MINE_Y-1AND I<MINE_X-1THEN IF MINE_M[I+1,J+1]!=9THEN F=1
   IF F==1THEN MINE_M[I+1,J+1]=MINE_M[I+1,J+1]+1
  NEXT

 NEXT
RETURN
 FOR I=0TO MINE_X-1
  FOR J=0TO MINE_Y-1
   MINE_NX=I*8
   MINE_NY=J*8
   GOSUB "@N_MINE_N"+STR$(MINE_M[I,J])
   
  NEXT
 NEXT
 GOSUB @WINBUFFP2
RETURN
@GV_MINE
 FOR I=0TO MINE_X-1
  FOR J=0TO MINE_Y-1
   MINE_NX=I*8
   MINE_NY=J*8
   IF MINE_M[I,J]==9THEN IF MINE_F[I,J]==-1THEN MINE_M[I,J]=14 ELSE MINE_M[I,J]=13
   IF MINE_M[I,J]==0THEN MINE_M[I,J]=11
   GOSUB "@N_MINE_N"+STR$(MINE_M[I,J])
  NEXT
 NEXT
RETURN
@P_MINE
' IF MINE_M[MINE_PX,MINE_PY]==3THEN 
IF MINE_F[MINE_PX,MINE_PY]==-1THEN RETURN
MINE_NX=MINE_PX*8:MINE_NY=MINE_PY*8
IF MINE_N==0THEN GOSUB @P_MINE_O:RETURN
IF MINE_M[MINE_PX,MINE_PY]==9THEN MINE_GV=1
IF MINE_F[MINE_PX,MINE_PY]==0THEN MINE_SPACE=MINE_SPACE-1
IF MINE_F[MINE_PX,MINE_PY]==-2THEN MINE_SPACE=MINE_SPACE-1
MINE_F[MINE_PX,MINE_PY]=1
GOSUB "@N_MINE_N"+STR$(MINE_N)
RETURN
@P_MINE_O
 P=0:MINE_OX[0]=MINE_PX:MINE_OY[0]=MINE_PY
 @P_MINE_OL
  IF P==-1THEN RETURN
  IF MINE_M[MINE_OX[P],MINE_OY[P]]==0THEN MINE_M[MINE_OX[P],MINE_OY[P]]=11
  MINE_NX=MINE_OX[P]*8:MINE_NY=MINE_OY[P]*8
  BF=MINE_BF
'  GOSUB @WINBUFFP
'------
 GPAGE 0,BF,!WINGPAGE
'------
  GOSUB "@N_MINE_N11"'+STR$(MINE_M[MINE_OX[P],MINE_OY[P]])
'-------

'  GOSUB @WINBUFFP2
 GPAGE 0,!WINGPAGE,!WINGPAGE
GCOPY MINE_BF,0,0,MINE_X*8-1,MINE_Y*8-1,WFX,WFY,1
 GPAGE 0,BF,!WINGPAGE
'  GOSUB @WINBUFFP
'------
  IF MINE_F[MINE_OX[P],MINE_OY[P]]==0THEN MINE_SPACE=MINE_SPACE-1
  IF MINE_F[MINE_OX[P],MINE_OY[P]]==-2THEN MINE_SPACE=MINE_SPACE-1
  MINE_F[MINE_OX[P],MINE_OY[P]]=1
  IF MINE_OX[P]<1THEN @P_MINE_OL2
  G=MINE_M[MINE_OX[P]-1,MINE_OY[P]]
  IF MINE_F[MINE_OX[P]-1,MINE_OY[P]]==-1THEN  @P_MINE_OL2
  IF G==0 OR G==0 THEN MINE_OX[P+1]=MINE_OX[P]-1:MINE_OY[P+1]=MINE_OY[P]P=P+1:GOTO @P_MINE_OL
  F=0
  IF G>0AND G<9AND MINE_F[MINE_OX[P],MINE_OY[P]]==0 THEN MINE_SPACE=MINE_SPACE-1
  IF G>0AND G<9AND MINE_F[MINE_OX[P],MINE_OY[P]]==-2THEN MINE_SPACE=MINE_SPACE-1
  IF G>0AND G<9 THEN MINE_NX=MINE_NX-8:GOSUB "@N_MINE_N"+STR$(G):MINE_F[MINE_OX[P]-1,MINE_OY[P]]=1
  MINE_NX=MINE_OX[P]*8:MINE_NY=MINE_OY[P]*8
 @P_MINE_OL2
  IF MINE_OY[P]<1THEN @P_MINE_OL3
  G=MINE_M[MINE_OX[P],MINE_OY[P]-1]
  IF MINE_F[MINE_OX[P],MINE_OY[P]-1]==-1THEN  @P_MINE_OL3
  IF G==0 OR G==0 THEN MINE_OX[P+1]=MINE_OX[P]:MINE_OY[P+1]=MINE_OY[P]-1P=P+1:GOTO @P_MINE_OL
  IF G>0AND G<9AND MINE_F[MINE_OX[P],MINE_OY[P]]==0 THEN MINE_SPACE=MINE_SPACE-1
  IF G>0AND G<9AND MINE_F[MINE_OX[P],MINE_OY[P]]==-2THEN MINE_SPACE=MINE_SPACE-1
  IF G>0AND G<9 THEN MINE_NY=MINE_NY-8:GOSUB"@N_MINE_N"+STR$(G):MINE_F[MINE_OX[P],MINE_OY[P]-1]=1
  MINE_NX=MINE_OX[P]*8:MINE_NY=MINE_OY[P]*8
 @P_MINE_OL3
  IF MINE_OX[P]>=MINE_X-1THEN @P_MINE_OL4
  G=MINE_M[MINE_OX[P]+1,MINE_OY[P]]
  IF MINE_F[MINE_OX[P]+1,MINE_OY[P]]==-1THEN  @P_MINE_OL4
  IF G==00OR G==0 THEN MINE_OX[P+1]=MINE_OX[P]+1:MINE_OY[P+1]=MINE_OY[P]P=P+1:GOTO @P_MINE_OL
  IF G>0AND G<9AND MINE_F[MINE_OX[P],MINE_OY[P]]==0 THEN MINE_SPACE=MINE_SPACE-1
  IF G>0AND G<9AND MINE_F[MINE_OX[P],MINE_OY[P]]==-2THEN MINE_SPACE=MINE_SPACE-1
  IF G>0AND G<9 THEN MINE_NX=MINE_NX+8GOSUB"@N_MINE_N"+STR$(G):MINE_F[MINE_OX[P]+1,MINE_OY[P]]=1
  MINE_NX=MINE_OX[P]*8:MINE_NY=MINE_OY[P]*8
 @P_MINE_OL4
  IF MINE_OY[P]>=MINE_Y-1THEN @P_MINE_OL5
  IF MINE_F[MINE_OX[P],MINE_OY[P]+1]==-1THEN  @P_MINE_OL5
  G=MINE_M[MINE_OX[P],MINE_OY[P]+1]
  IF G==00OR G==0 THEN MINE_OX[P+1]=MINE_OX[P]:MINE_OY[P+1]=MINE_OY[P]+1P=P+1:GOTO @P_MINE_OL
  IF G>0AND G<9AND MINE_F[MINE_OX[P],MINE_OY[P]]==0 THEN MINE_SPACE=MINE_SPACE-1
  IF G>0AND G<9AND MINE_F[MINE_OX[P],MINE_OY[P]]==-2THEN MINE_SPACE=MINE_SPACE-1
  IF G>0AND G<9 THEN MINE_NY=MINE_NY+8GOSUB "@N_MINE_N"+STR$(G):MINE_F[MINE_OX[P],MINE_OY[P]+1]=1
  MINE_NX=MINE_OX[P]*8:MINE_NY=MINE_OY[P]*8
 @P_MINE_OL5
  P=P-1
 GOTO @P_MINE_OL
RETURN
@MINEKEY
KEY 1,"MINE_
END
@A_MINE
 MINE_X=16
 MINE_Y=16
 MINE_SPACE=MINE_X*MINE_Y
 MINE_BOM=32'¶¸ØÂ
 DIM MINE_M[64,64]
 'Ì×¸ÞÏ¯Ìß
 DIM MINE_F[64,64]
 DIM MINE_DX[64]
 DIM MINE_DY[64]
 DIM MINE_OX[64*64]
 DIM MINE_OY[64*64]
 MINE_=1
RETURN
@SB_MINE
 GOSUB @WINBUFF
 IF BF==0THEN RETURN
 MINE_BF=BF
RETURN
@S_MINE
 WINCLS=1
 IF MINE_F==1THEN GOSUB@WINCLOSE:RETURN
 IF MINE_==0THEN GOSUB @A_MINE
 IF MINE_B==0THEN GOSUB@SB_MINE
 MINE_B=0
 BF=MINE_BF
 BFC=13:GOSUB @WINBUFFGCLS
 GOSUB @N_MINE
 MINE_F=1
 WINCLS=1
 WINY2=MINE_Y*8+11
 WINX2=MINE_X*8+3
 GOSUB @WINBUFFP
  GBOX 0,0,MINE_X*8,MINE_Y*8,255
 GOSUB @WINBUFFP2
 MINE_GV=0
 MINE_GV2=0
 MINE_CL=0
 WINTTL$="MINE
 
RETURN
@WIN_MINE
 BF=MINE_BF:BF_X=0BF_Y=0BF_X2=MINE_X*8-1BF_Y2=MINE_Y*8-1GOSUB@WINBUFFCPY
' GCOPY MINE_BF,0,0,MINE_X*8-1,MINE_Y*8-1,WFX,WFY,1
'GAMEOVER
IF MINE_GV+MINE_CL THEN WINSX=0WINSY=0:WINSTR$="„@ TO RESTART"WINSC=1GOSUB@WINSTRPUT
 BF=MINE_BF
 GOSUB @WINBUFFP
 IF MINE_CL AND WINACTV AND BUTTON()==16AND WINFLG[TSK]==2THEN MINE_B=1MINE_F=0GOSUB@S_MINE
 IF MINE_CL GOTO @SKP_MINE
 IF MINE_GV==1 THEN BGMPLAY 6:MINE_GV=2:GOTO @SKP_MINE
 IF MINE_GV==100AND !MINE_GV2 THEN GOSUB@GV_MINE:MINE_GV=2:MINE_GV2=1:GOTO @SKP_MINE
 IF MINE_GV AND WINACTV AND BUTTON()==16 AND WINFLG[TSK]==2THEN MINE_B=1MINE_F=0GOSUB@S_MINE
 IF MINE_GV THEN MINE_GV=MINE_GV+1:GOTO @SKP_MINE
 IF WINFLG!=2THEN GOTO @SKP_MINE
' IF MINE_CL==1THEN BGMPLAY 5:MINE_CL=2GOTO @SKP_MINE
' IF MINE_CL THEN MINE_CL=2GOTO @SKP_MINE
 MINE_MX=0OR(MOUSEX-WFX)/8
 MINE_MY=0OR(MOUSEY-WFY)/8
 F=0
 IF MINE_MX>=0AND MINE_MY>=0THEN F=1
 IF F AND MINE_MX<=MINE_X-1 AND MINE_MX<=MINE_Y-1THEN MINE_MF=1 ELSE MINE_MF=0
'IF MINE_MF THEN ?MINE_M[MINE_MX,MINE_MY]
 IF CLICK*MINE_MF THEN MINE_PX=MINE_MX:MINE_PY=MINE_MY:MINE_N=MINE_M[MINE_MX,MINE_MY]GOSUB@P_MINE
'ÓÄÞ½ µ´-
 F=0S=0
 IF CLICKR*MINE_MF THEN IF(MINE_F[MINE_MX,MINE_MY]==-2)THEN F=1
 IF F==1THEN MINE_F[MINE_MX,MINE_MY]=0:MINE_NX=MINE_MX*8:MINE_NY=MINE_MY*8:GOSUB @N_MINE_N0:S=1
'?
 F=0
 IF CLICKR*MINE_MF THEN IF(MINE_F[MINE_MX,MINE_MY]==-1)THEN F=1
 IF F==1THEN GOSUB @HTN_MINE
'FLAG
 F=0
 IF CLICKR*MINE_MF THEN IF(MINE_F[MINE_MX,MINE_MY]==0)THEN F=1
 IF !S*F THEN GOSUB @FLG_MINE
 IF MINE_BOMB<=0THEN MINE_CL=1BEEP 34
@SKP_MINE
 F=0
 GOSUB @WINBUFFP2

RETURN
@HTN_MINE
 IF MINE_M[MINE_MX,MINE_MY]==9THEN MINE_BOMB=MINE_BOMB+1
 IF MINE_M[MINE_MX,MINE_MY]!=9THEN MINE_BOMB=MINE_BOMB-1
 MINE_F[MINE_MX,MINE_MY]=-2
 MINE_NX=MINE_MX*8
 MINE_NY=MINE_MY*8:GOSUB @N_MINE_N10
RETURN
@FLG_MINE
 MINE_F[MINE_MX,MINE_MY]=-1
 MINE_NX=MINE_MX*8
 MINE_NY=MINE_MY*8
 GOSUB @N_MINE_N12
 IF MINE_M[MINE_MX,MINE_MY]==9THEN MINE_BOMB=MINE_BOMB-1
 IF MINE_M[MINE_MX,MINE_MY]!=9THEN MINE_BOMB=MINE_BOMB+1
RETURN


@C_INV
 BF=INV_BF
 GOSUB @WINBUFFC
 GOSUB @WINCLOSE
 INV_F=0
 INV_GV=0
 INV_CL=0
 INV_ME=0
RETURN
@ST_INV
 BF=INV_BF
 GOSUB @WINBUFFP
 FOR I=0TO INV_EM-1
  FOR J=0TO INV_EM2-1
   INV_F[I,J]=0
   INV_E[I,J]=1
   GPUTCHR I*8+32,J*8,"BGF",ASC("„E"),0,1
  NEXT
 NEXT
 GOSUB @WINBUFFP2
RETURN
@A_INV
 INV_MX=8*8
 INV_MY=4*8
 INV_EM=8
 INV_EM2=4
 DIM INV_E[INV_EM,INV_EM2]
 DIM INV_F[INV_EM,INV_EM2]
 DIM INV_TEX[INV_EM,INV_EM2]
 DIM INV_TEY[INV_EM,INV_EM2]
 INV_A=1
RETURN
@S_INV
 IF INV_F==1THEN RETURN
 INV_F=1
 WINCLS=1
 GOSUB @WINBUFF
 IF !BF THEN RETURN
 INV_BF=BF
 BFC=14
 GOSUB @WINBUFFGCLS
 IF INV_A==0THEN GOSUB @A_INV
 WINX2=130
 WINY2=96+10+1
 @INV_INI
 GOSUB @ST_INV
 INV_SCO=0
 INV_SX=32
 INV_SY=0
 INV_SF=0
 INV_SP=1
 INV_GV=0
 INV_CF=0
 INV_PX=64
 INV_PY=96
 INV_ME=INV_EM*INV_EM2
 WINTTL$="INV
RETURN
@GV_INV
 IF INV_GV==1 THEN BGMPLAY 6:INV_GV=2
 F=0
 IF CLICK3 AND WINACTV AND WINFLG[TSK]==2THEN F=1
 IF F THEN BF=INV_BF:BFC=14:GOSUB@WINBUFFGCLS:GOSUB@INV_INI
 WINSX=0WINSY=8WINSC=RND(16)WINSTR$="CLICK TO REPLAY"GOSUB @WINSTRPUT
 GPUTCHR INV_PX+WFX,WFY+96-8,"BGF",42,0,1
RETURN
@CL_INV
 WINSX=0WINSY=8WINSC=0WINSTR$="CLICK TO REPLAY"GOSUB @WINSTRPUT
 F=0
 IF CLICK3 AND WINACTV AND WINFLG[TSK]==2THEN F=1
 IF F THEN BF=INV_BF:BFC=14:GOSUB@WINBUFFGCLS:GOSUB@INV_INI
RETURN
@WIN_INV
 BF=INV_BF:BF_X=0BF_Y=0BF_X2=128BF_Y2=96GOSUB@WINBUFFCPY
' GCOPY INV_BF,0,0,128,96,WFX,WFY,1
 WINSX=0WINSY=0WINSC=0WINSTR$="SCORE:"+STR$(INV_SCO)+"0"GOSUB@WINSTRPUT
 IF INV_GV THEN @GV_INV
 IF INV_ME<=0AND !INV_CF THEN INV_CF=1BGMPLAY 4
 IF INV_CF THEN @CL_INV
 BF=INV_BF
 GOSUB @WINBUFFP
 INV_OSX=INV_SX
 INV_OSY=INV_SY
 INV_OSF=INV_SF
 F=0
 IF !INV_SF THEN INV_SX=INV_SX-INV_SP
 IF INV_SF THEN INV_SX=INV_SX+INV_SP
 IF INV_SX<=1THEN INV_SX=1INV_SF=1:INV_SY=INV_SY+4F=1:BGMPLAY"@151Q1C8":INV_SP=INV_SP*1.2
 IF INV_SX>=128-64 THEN INV_SX=64INV_SF=0:INV_SY=INV_SY+4F=1:BGMPLAY"@151Q1C8":INV_SP=INV_SP*1.2
 GCOPY INV_OSX,INV_OSY,INV_OSX+64,INV_OSY+INV_MY*8,INV_SX,INV_SY,1
  IF INV_SF*INV_OSF THEN GFILL INV_OSX-INV_SP,INV_OSY,INV_OSX,INV_SY+INV_MX*8,14
  IF (!INV_SF*!INV_OSF) THEN GFILL INV_OSX+64,INV_OSY,128,INV_SY+INV_MX*8,14
  IF F THEN GFILL 0,INV_OSY,127,INV_OSY+3,14
  IF INV_SY>128THEN INV_GV=1
 GOSUB @WINBUFFP2
'GFILL INV_PX+WFX,WFY+96-8,WFX+INV_PX+8,WFY+96,6
 GPUTCHR INV_PX+WFX,WFY+96-8,"BGF",5,0,1
 B=BUTTON()
 IF B AND 4THEN INV_PX=INV_PX-2
 IF B AND 8THEN INV_PX=INV_PX+2
 TP=INV_TP
 F=0
 G=(B AND 16)==16AND (INV_B AND 16)!=16
 IF G AND !INV_TF[TP]THEN INV_TF[TP]=1:BGMPLAY"@151Q1<C":F=1
 IF F THEN INV_TX[TP]=INV_PX:INV_TY[TP]=96-8:INV_TP=(INV_TP+1)%5
 FOR I=0TO INV_EM-1
  FOR J=0TO INV_EM2-1
   IF INV_E[I,J]==2OR INV_F[I,J]==1THEN @INV_SKPP
   IF INV_E[I,J]==0THEN @INV_SKPPP
   F=0
   IF !RND(100)AND INV_E[I,J]==1THEN BGMPLAY"@151Q1<<C"F=1INV_F[I,J]=1
   IF F THEN INV_TEX[I,J]=INV_SX+I*8:INV_TEY[I,J]=INV_SY+J*8 ELSE @INV_SKPPP
@INV_SKPP
   INV_TEY[I,J]=INV_TEY[I,J]+3
   GFILL WFX+INV_TEX[I,J],WFY+INV_TEY[I,J],WFX+INV_TEX[I,J]+1,WFY+INV_TEY[I,J]+2,15
   IF INV_TEY[I,J]>94THEN INV_F[I,J]=0
   F=0
   IF INV_TEY[I,J]>=96-8AND INV_TEY[I,J]<=96THEN F=1
   IF F AND INV_TEX[I,J]>=INV_PX AND INV_TEX[I,J]<=INV_PX+8THEN INV_GV=1
@INV_SKPPP
  NEXT
 NEXT
 FOR I=0TO 5'INV_TP
  TP=I
  F=0
  IF !INV_TF[TP]THEN @INV_SKP
  IF INV_TF[TP] THEN INV_TY[TP]=INV_TY[TP]-2:F=1
  IF F THEN GFILL WFX+INV_TX[TP],INV_TY[TP]+WFY,INV_TX[TP]+2+WFX,INV_TY[TP]-4+WFY,15
  IF INV_TF[TP]*(INV_TY[TP]<0)THEN INV_TF[TP]=0
 F=0
IF INV_TX[I]>=INV_SX AND INV_TX[I]<=INV_SX+64AND INV_TY[I]>=INV_SY AND INV_TY[I]<=INV_SY+42THEN F=1
A=0OR (INV_TX[TP]-INV_SX)/8
C=0OR (INV_TY[TP]-INV_SY)/8
 IF F AND A>=0AND A<INV_MX/8 AND C>=0AND C<INV_MY/8 THEN IF INV_E[A,C]>0THEN F=2
 IF F==2THEN INV_ECX=A:INV_ECY=C:GOSUB@INV_EC:INV_TF[TP]=0:INV_SCO=INV_SCO+1+(0OR INV_SP)
 @INV_SKP
 NEXT
 INV_B=B
RETURN
@INV_EC
 GOSUB @WINBUFFP
 GFILL 0OR INV_ECX*8+INV_SX,0OR INV_ECY*8+INV_SY,0OR INV_ECX*8+INV_SX+7,0OR INV_ECY*8+INV_SY+7,14
 INV_E[INV_ECX,INV_ECY]=0
 GOSUB @WINBUFFP2
 INV_ME=INV_ME-1
RETURN

@C_REV
 BF=REV_BF
 GOSUB@WINBUFFC
 GOSUB@WINCLOSE
RETURN
@D_REV
 GCIRCLE X*8+3,Y*8+3,3,C
 GCIRCLE X*8+3,Y*8+3,2,C
 GCIRCLE X*8+3,Y*8+3,1,C
 GPSET X*8+3,Y*8+3,C
RETURN
@P_REV
 GOSUB@WINBUFFP
  GCLS 29
  FOR I=0TO 7
   GLINE I*8-1,0,I*8-1,64,14
   GLINE 0,I*8-1,64,I*8-1,14
  NEXT
 FOR I=0TO 7
  FOR J=0TO 7
   REV_M[I,J]=0
  NEXT
 NEXT
 REV_M[3,3]=1
 REV_M[4,4]=1
 REV_M[4,3]=2
 REV_M[3,4]=2
 C=2X=3Y=3GOSUB @D_REV
 C=2X=4Y=4GOSUB @D_REV
 C=4X=4Y=3GOSUB @D_REV
 C=4X=3Y=4GOSUB @D_REV
 GOSUB@WINBUFFP2 
RETURN
'                     ('¥w¥`) ÏÝÄÞ¸¾
'                           FOR,Ê²ÚÂÅÄÞ¦ÓÁ²À× ×¸ÆÅÙ¶ÓÀÞ¶Þ
@O_8REV
 X=REV_MX:Y=REV_MY
@OL_8REV
 X=X-1Y=Y+1
 IF X<0 THEN RETURN
 IF Y>7THEN RETURN
 IF REV_M[X,Y]==0 THEN RETURN
 IF REV_M[X,Y]==REV_J THEN GOSUB@OS_8REV:RETURN
GOTO@OL_8REV
@OS_8REV
 F=1:K=0
 IF REV_OF==1THEN RETURN
 K=REV_MY
 D=REV_MX
 Z=X
 FOR I=Z+1 TO REV_MX-1
  K=K+1
  D=D-1
  Y=K:X=D:C=REV_JC:GOSUB @D_REV
  REV_M[X,Y]=REV_J
 NEXT
RETURN
@O_7REV
 X=REV_MX:Y=REV_MY
@OL_7REV
 X=X+1Y=Y-1
 IF X>7THEN RETURN
 IF Y<0 THEN RETURN
 IF REV_M[X,Y]==0 THEN RETURN
 IF REV_M[X,Y]==REV_J THEN GOSUB@OS_7REV:RETURN
GOTO@OL_7REV
@OS_7REV
 F=1:K=0
 IF REV_OF==1THEN RETURN
 K=REV_MY
 Z=X
 FOR I=REV_MX+1 TO Z-1
  K=K-1
  Y=K:X=I:C=REV_JC:GOSUB @D_REV
  REV_M[X,Y]=REV_J
 NEXT
RETURN
@O_6REV
 X=REV_MX:Y=REV_MY
@OL_6REV
 X=X+1Y=Y+1
 IF X>7THEN RETURN
 IF Y>7THEN RETURN
 IF REV_M[X,Y]==0 THEN RETURN
 IF REV_M[X,Y]==REV_J THEN GOSUB@OS_6REV:RETURN
GOTO@OL_6REV
@OS_6REV
 F=1:K=0
 IF REV_OF==1THEN RETURN
 K=REV_MY
 Z=X
 FOR I=REV_MX+1 TO Z-1
  K=K+1
  Y=K:X=I:C=REV_JC:GOSUB @D_REV
  REV_M[X,Y]=REV_J
 NEXT
RETURN
@O_5REV
 X=REV_MX:Y=REV_MY
@OL_5REV
 X=X-1Y=Y-1
 IF X<0 THEN RETURN
 IF Y<0 THEN RETURN
 IF REV_M[X,Y]==0 THEN RETURN
 IF REV_M[X,Y]==REV_J THEN GOSUB@OS_5REV:RETURN
GOTO@OL_5REV
@OS_5REV
 F=1:K=0
 IF REV_OF==1THEN RETURN
 K=REV_MY
 Z=X
 FOR I=REV_MX-1 TO Z+1 STEP -1
  K=K-1
  Y=K:X=I:C=REV_JC:GOSUB @D_REV
  REV_M[X,Y]=REV_J
 NEXT
RETURN
@O_4REV
 X=REV_MX:Y=REV_MY
@OL_4REV
 Y=Y+1IF Y>7THEN RETURN
 IF REV_M[X,Y]==0 THEN RETURN
 IF REV_M[X,Y]==REV_J THEN GOSUB@OS_4REV:RETURN
GOTO@OL_4REV
@OS_4REV
 F=1:Z=Y
 IF REV_OF==1THEN RETURN
 FOR I=REV_MY+1 TO Z-1
  X=REV_MX:Y=I:C=REV_JC:GOSUB @D_REV
  REV_M[X,Y]=REV_J
 NEXT
RETURN
@O_3REV
 X=REV_MX:Y=REV_MY
@OL_3REV
 X=X+1IF X>7THEN RETURN
 IF REV_M[X,Y]==0 THEN RETURN
 IF REV_M[X,Y]==REV_J THEN GOSUB@OS_3REV:RETURN
GOTO@OL_3REV
@OS_3REV
 F=1:Z=X
 IF REV_OF==1THEN RETURN
 FOR I=REV_MX+1 TO Z-1
  Y=REV_MY:X=I:C=REV_JC:GOSUB @D_REV
  REV_M[X,Y]=REV_J
 NEXT
RETURN
@O_2REV
 X=REV_MX:Y=REV_MY
@OL_2REV
 Y=Y-1IF Y<0 THEN RETURN
 IF REV_M[X,Y]==0 THEN RETURN
 IF REV_M[X,Y]==REV_J THEN GOSUB@OS_2REV:RETURN
GOTO @OL_2REV
@OS_2REV
 F=1:Z=Y
 IF REV_OF==1THEN RETURN
 FOR I=Z+1 TO REV_MY-1
  X=REV_MX:Y=I:C=REV_JC:GOSUB @D_REV
  REV_M[X,Y]=REV_J
 NEXT
RETURN
@O_1REV
 X=REV_MX
 Y=REV_MY
@OL_1REV
 X=X-1
 IF X<0 THEN RETURN
 IF REV_M[X,Y]==0 THEN RETURN
 IF REV_M[X,Y]==REV_J THEN GOSUB@OS_1REV:RETURN
GOTO @OL_1REV
@OS_1REV
 F=1
 IF REV_OF==1THEN RETURN
 Z=X
 FOR I=Z+1 TO REV_MX-1
  X=I:Y=REV_MY:C=REV_JC:GOSUB @D_REV
  REV_M[X,Y]=REV_J
 NEXT
RETURN
@O_REV
 F=0
 IF REV_M[REV_MX,REV_MY]!=0THEN RETURN
 IF REV_MX==0THEN @O_REV2
 IF REV_M[REV_MX-1,REV_MY]==REV_C THEN GOSUB@O_1REV
@O_REV2
 IF REV_MY==0THEN @O_REV3
 IF REV_M[REV_MX,REV_MY-1]==REV_C THEN GOSUB@O_2REV
@O_REV3
 IF REV_MX==7THEN @O_REV4
 IF REV_M[REV_MX+1,REV_MY]==REV_C THEN GOSUB@O_3REV
@O_REV4
 IF REV_MY==7THEN @O_REV5
 IF REV_M[REV_MX,REV_MY+1]==REV_C THEN GOSUB@O_4REV
'„|  
' › 
'   
@O_REV5
 IF REV_MX==0THEN @O_REV6
 IF REV_MY==0THEN @O_REV6
 IF REV_M[REV_MX-1,REV_MY-1]==REV_C THEN GOSUB@O_5REV
@O_REV6
 IF REV_MX==7THEN @O_REV7
 IF REV_MY==7THEN @O_REV7
 IF REV_M[REV_MX+1,REV_MY+1]==REV_C THEN GOSUB@O_6REV
@O_REV7
 IF REV_MX==7THEN @O_REV8
 IF REV_MY==0THEN @O_REV8
 IF REV_M[REV_MX+1,REV_MY-1]==REV_C THEN GOSUB@O_7REV
@O_REV8
 IF REV_MX==0THEN @O_REV9
 IF REV_MY==7THEN @O_REV9
 IF REV_M[REV_MX-1,REV_MY+1]==REV_C THEN GOSUB@O_8REV
@O_REV9
 REV_OF=0
RETURN
@A_REV
 DIM REV_M[8,8]  'Ê²ÚÂ¾Ý¹ÞÝ
 DIM REV_J[8,8]  'Ê²ÚÂ¾Ý¹ÞÝ
 DIM REV_C[8,8]  'Ê²ÚÂ¾Ý¹ÞÝ
 DIM REV_D[8,8]  'Ê²ÚÂ¾Ý¹ÞÝ
RETURN
@S_REV
 GOSUB@WINBUFF  'ÊÞ¯Ì§¶¸Î
 IF BF==0 THEN RETURN   '´×-¼®Ø
 REV_BF=BF
 BFC=29 'GCLS½Ù²Û
 GOSUB@WINBUFFGCLS
 WINCLS=1  '@C_Ê¿Ý»Þ²¼Ã²Ï½
 IF REV_A==0 THEN GOSUB@A_REV
 REV_A=1
 REV_END=0
 REV_PASS=0
 REV_CPASS=0
 WINX2=64
 WINY2=74
 REV_J=1REV_JC=2REV_C=2REV_CC=4
 GOSUB@P_REV
 WINTTL$="REV
RETURN
@WIN_REV
 BF=REV_BF
 BF_X=0BF_Y=0BF_X2=62BF_Y2=62GOSUB@WINBUFFCPY
' GCOPY REV_BF,0,0,62,62,WFX,WFY,1
 GOSUB@WINBUFFP
  REV_MX=0OR(MOUSEX-WFX)/8
  REV_MY=0OR(MOUSEY-WFY)/8
  IF REV_MX<0OR REV_MX>7OR REV_MY<0OR REV_MY>7THEN @SKP_REV
F=0
'  IF REV_PASS THEN GOSUB @REV_COM:REV_OKEN=0:REV_PASS=0
'  IF REV_CPASS THEN REV_CPASS=0:REV_COKEN=0
G=0
' IF CLICKR AND REV_M[X,Y]==REV_J THEN X=REV_MX:Y=REV_MY:C=29:GOSUB @D_REV:REV_M[X,Y]=0G=1
' IF CLICKR AND REV_M[X,Y]==REV_C THEN X=REV_MX:Y=REV_MY:C=REV_JC:GOSUB @D_REV:REV_M[X,Y]=REV_J:G=1
X=REV_MX Y=REV_Y
 IF CLICKR AND REV_M[X,Y]==0 THEN X=REV_MX:Y=REV_MY:C=REV_CC:GOSUB @D_REV:REV_M[X,Y]=REV_C:G=1
 REV_J=1REV_JC=2REV_C=2REV_CC=4
  IF CLICK THEN GOSUB@O_REV
  IF G  GOTO @SKP_REV

IF F THEN X=REV_MX:Y=REV_MY:C=REV_JC:GOSUB @D_REV:REV_M[X,Y]=REV_J
 IF F THEN GOSUB@REV_COM
 @SKP_REV
 GOSUB@WINBUFFP2
RETURN
@OKC_REV
KKK=0
FOR I=0TO 7
 FOR J=0TO 7
  REV_MX=I
  REV_OF=1
  F=0
  GOSUB @O_REV
  REV_J[I,J]=F
  KKK=KKK+F
 NEXT
NEXT
REV_OKEN=!KKK
RETURN
@REV_COM
GPAGE 0,WINGPAGE,WINGPAGE
GCOPY REV_BF,0,0,62,62,WFX,WFY,1
GOSUB @OKC_REV
KKK=0
KKD=0
SWAP REV_J,REV_C:SWAP REV_JC,REV_CC
FOR I=0TO 7
 FOR J=0TO 7
  REV_MX=I
  REV_MY=J
  REV_OF=1
  F=0
  GOSUB @O_REV
  REV_C[I,J]=F
  REV_D[I,J]=F==1AND REV_J[I,J]==1
  KKK=KKK+F
  KKD=KKD+REV_D[I,J]
 NEXT
NEXT
REV_COKEN=!KKK
 GOSUB@WINBUFFP
'IF REV_COKEN THEN REV_CPASS=1 ELSE REV_CPASS=0
'IF REV_COKEN THEN SWAP REV_J,REV_C:SWAP REV_JC,REV_CC:RETURN
@REV_COML
'GPAGE 0,M,M
'GCOPY REV_BF,0,0,62,62,WFX,WFY,1
 REV_OF=0
RX=RND(8)
RY=RND(8)
REV_MX=RX
REV_MY=RY
F=0
GOSUB@O_REV
IF F THEN X=REV_MX:Y=REV_MY:C=REV_JC:GOSUB @D_REV:REV_M[X,Y]=REV_J
IF F THEN @REV_COM2
GOTO @REV_COML
@REV_COM2
SWAP REV_J,REV_C:SWAP REV_JC,REV_CC
'GPAGE 0,M,M
'GFILL WFX+X*8,WFY+Y*8,WFX+X*8+2,Y*8+2+WFY,REV_CC
'WAIT 50
 GOSUB @OKC_REV
 IF REV_OKEN THEN REV_PASS=1ELSE REV_PASS=0
 GOSUB@WINBUFFP
 FOR I=0TO 7
 FOR J=0TO 7
  X=I:Y=J
  C=29
  IF REV_M[I,J]==REV_C THEN C=REV_CC
  IF REV_M[I,J]==REV_J THEN C=REV_JC
  GOSUB @D_REV
 NEXT
 NEXT
RETURN
'-------SYSTEM APPLICATION-----
@S_ABOUT
 WINX2=130
 WINY2=48
 WINCLS=1
 WINTTL$="ABOUT
 @C_ABOUT
RETURN
@WIN_ABOUT
 WINSY=0
 WINSX=0
 WINSC=1
 WINSTR$=MID$(VERSION$,0,16)
 GOSUB @WINSTRPUT

 WINSC=1
 WINSY=8
 WINSTR$=MID$(VERSION$,16,15)
 GOSUB @WINSTRPUT

 WINBY=16
 WINBX=62-8
 WINBSTR$="OK"
 GOSUB @WINBTN
 IF WINBTNF==1THEN GOSUB @WINCLOSE
 
 WINSC=1
 WINSY=27
 WINSX=0
 WINSTR$="(C)2011-2013otya"
 GOSUB @WINSTRPUT
RETURN
'SYSTEM ERROR
@WINDIA
 WINSCX=WINDSX
 WINSCY=WINDSY
 WINSX=0:WINSY=0:WINX2=WINDX:WINY2=WINDY
 WIN_MODE=1
 GOSUB@WINDOW
' WINDSX=MOUSEX
' WINDSY=MOUSEY
RETURN
@SYS_BEEP_0
 '´×-
 BEEP 2,-8192
RETURN
@SYS_BEEP_1
 '¹²º¸1
 BEEP 3,-4096
RETURN
@SYS_BEEP_2
 '¹²º¸2
 BEEP 4,-4096
RETURN
@SYS_BEEP_3
@SYS_ERR_BUFF
 WINNAME$[TSK]="BUFF
 WINTTL$[TSK]="BUFF
 GOSUB@SYS_BEEP_0
RETURN
@WIN_BUFF
' WINNAME$[TSK]="SYS_ERR
' WINM[TSK]=-1
 ERRN$="Out of buffer
 ERRT$="ÊÞ¯Ì§ÌÞ¿¸
 GOSUB @WIN_SYS_ERR
RETURN
@C_SYS_ERR
 GOSUB @WINCLOSE
RETURN
'ARRAY SET
@A_SYS_ERR
 DIM OTWERRT$[TSKMAX]
 DIM OTWERRN$[TSKMAX]
RETURN
@S_SYS_ERR
 IF OTWERR==0THEN GOSUB @A_SYS_ERR
 OTWERR=1
 OTWERRT$[OTWERR_M]=ERRT$
 OTWERRN$[OTWERR_M]=ERRN$
 WINMLT[TSK]=OTWERR_M
 OTWERR_M=OTWERR_M
RETURN
@WIN_SYS_ERR
' P=WINMLT[TSK]
' WINM[TSK]=1
 WINTTL$[TSK]=ERRT$'="ÊÞ¯Ì§ÌÞ¿¸
 WINY2=26+WINDEGY2+WINDEGY
 WINX2=LEN("Sorry, a system error")*8+WINDEGX+WINDEGX2
 WINSX=0
 WINSY=0
 WINSC=1
 WINSTR$="Sorry, a system error"
 GOSUB @WINSTRPUT
 WINSC=1
 WINSY=8
 WINSTR$="type:"+ERRN$'Out of buff"
 GOSUB @WINSTRPUT
 WINBX=0
 WINBY=16
 WINBSTR$="OK"
 GOSUB @WINBTN
 IF WINBTNF==1THEN GOSUB @WINCLOSE
RETURN
'---ºÝ¿-Ù±ÌßØ
@S_COMDBG
RETURN
@WIN_COMDBG
 WINSC=1:WINSTR$="A"
GOSUB @WINSTRPUT
RETURN
@S_COM
 WINTTL$="COMMAND"
 COMINPUT$="@WIN_COM_INPUT
 WINMODE=-1
 WIN_MODE=-1
 'WINM[TSK]=-1'WINCLS=1
 GOSUB @WINFLAG
 WINCOMF=1
 WINCOMX2=128+8
 WINCOMY2=191-8
 WINX2=128+8
 WINY2=192-8
 GOSUB @COMWINDOW
 'WINCOMSCY=19
RETURN
@C_COM
 BGCLR 0
 GOSUB @WINCLOSE
RETURN
@WIN_COM
 WINDESIGN$="NORMAL
 WINBG=14
 GOSUB @WINDOW
IF !WINEND THEN WINSCX=(0OR WINSCX/8)*8:WINSCY=(0OR WINSCY/8)*8
 WINCOMSX=0OR WINSCX/8WINCOMSY=0OR WINSCY/8
 WFX=(0OR WFX/8)*8
 WFY=(0OR WFY/8)*8
 BGOFS 0,511-WFX+WINCOMSCX*8,511-WFY+WINCOM
' BGOFS WINCOMR,511-WINCOMSX*8+WINCOMSCX*8,511-WINCOMSY*8+WINCOM
 GOTO @COMSKP
' WX=WINCOMSX:WY=WINCOMSY
' WX2=WINCOMSX+WINCOMX2:WY2=WINCOMSY+WINCOMY2
' F=0
 IF MOUSEX>=WX AND MOUSEX<=WX2 THEN F=1
 IF F==1AND MOUSEY>=WY AND MOUSEY<=WY2 THEN F=2
 IF F==2AND CLICK==1THEN GOSUB @WINSWP
 F=0
 
 IF MOUSEX>=WX AND MOUSEX<=WX2 THEN F=1
 IF F==1AND MOUSEY>=WY AND MOUSEY<=WY+8THEN F=2
 IF F==2AND CLICK==1THEN WINCOMMVF=1
 IF WINCOMF==0THEN @S_COM
 @COMSKP
 IF WINIDFLG==1THEN RETURN
 WINCOMX22=0OR WINCOMX2/8
 WINCOMY22=0OR WINCOMY2/8-1
 B=BUTTON()
 IF B==1THEN WINCOMSCY=WINCOMSCY-1
 IF B==2THEN WINCOMSCY=WINCOMSCY+1:GOSUB @WINCOMSCRY
 IF B==4THEN WINCOMSCX=WINCOMSCX-1':GOSUB @WIN_COM_ECHO
 IF B==8THEN WINCOMSCX=WINCOMSCX+1':GOSUB @WIN_COM_ECHO
'IF WINCOMSCY<-(SCY+FLOOR(WINCOMY2/8))THEN WINCOMSCY=-(SCY+FLOOR(WINCOMY2/8))
' IF WINCOMSCY>63-(SCY+FLOOR(WINCOMY2/8)) THEN WINCOMSCY=63-(SCY+FLOOR(WINCOMY2/8))
' IF WINCOMSCY<-SY THEN WINCOMSCY=
' IF WINCOMSCY<21-CY THEN WINCOMSCY=21-CY
' IF SCYY<=0 THEN WINCOMSCY=0
' IF WINCOMSCY+CY<0THEN WINCOMSCY=0
' IF WINCOMSCY>63-WINCOMY22-6 THEN WINCOMSCY=63-WINCOMY22-6
 IF WINCOMSCX<0THEN WINCOMSCX=0
 IF WINCOMSCX>63-WINCOMX22 THEN WINCOMSCX=63-WINCOMX22
' IF CY<(FLOOR(WINCOMY2/8))THEN WINCOMSCY=21-CY
 IF WINCOMMVF==1THEN GOSUB @WIN_COM_MOV
' COMCOM=COMCOM+1
' COMP$="TST"+STR$(COMCOM):GOSUB COMPRT$
' GFILL WINCOMSX,WINCOMSY,WINCOMX2+WINCOMSX,WINCOMY2+WINCOMSY,14
 KEYFLG=KEYFLG+(WINACTV==1)
 I$=""
 IF KEYBF$!=""AND WINACTV==1THEN I$=KEYBF$:KEYBF$=""
 GOSUB @WIN_COM_IN
RETURN
@WINCOMSCRY
 IF WINCOMSCY>CY THEN COM$[WINCOMSCY]=""
RETURN
@WIN_COM_INPR
 WIN_COM_IN$=""
 COMP$=COMDIR$+">"
 COMKF=0
 GOSUB COMPRT$
RETURN
@WIN_COM_IN
 F=0
 IF INSTR(I$,CHR$(13))!=-1THEN GOSUB @WINCMDRUN
 WIN_COM_IN$=WIN_COM_IN$+I$
 COMCOM=RND(524287)'SCY
 COMP$=I$'STR$(COMCOM)+","+STR$(CYY)
 COMKF=0
 GOSUB COMPRT$
'CY=CY-1
 IF F==1THEN  GOSUB COMPRT$:GOSUB @WIN_COM_INPR
RETURN
@WINCMDRUN
 I$=MID$(I$,0,INSTR(I$,CHR$(13)))
 F=1
' CY=CY+1
 GOSUB COMPRT$
 CMD$=WIN_COM_IN$
 GOSUB @CMDRUN
 IF CMD$[0]=="TITLE"THEN WINTTL$=CMD$[1]
 IF NOCMD==0THEN GOSUB CMDL$
RETURN
@WIN_COM_MOV
 WINCOMSX=(0OR MOUSEX/8)*8
 WINCOMSY=(0OR MOUSEY/8)*8
' BGOFS 1,511-WINCOMSX,511-WINCOMSY-SCYY*8
' BGOFS 1,511-WINCOMSX,511-WINCOMSY+SCYY*8
' BGOFS 1,511-WINCOMSX,511-WINCOMSY+SCYY*8+WINCOMSCY*8-8
' BGFILL 1,0,0,WINCOMX2/8,WINCOMY2/8,255,0,0,0
'?MOUSEX,MOUSEY
'GFILL 0,0,WINCOMX2,WINCOMY2,OTWBGCL
 IF CLICK2==0THEN WINCOMMVF=0
RETURN
@COMWINDOW
 OTW=1
 BGFILL WINCOMR,0,0,WINCOMX2/8,WINCOMY2/8,0,0,0,0
 COMPRT$="@COM_ECHO
' COMP$="OTYAX-COMMAND
' GOSUB COMPRT$
' COMP$="alpha"
' GOSUB COMPRT$
 GOSUB @COM_COM
' GFILL 0,0,255,191,OTWBGCL
 GOSUB @WIN_COM_INPR
RETURN
@WIN_COM_INPUT
 COM_IN_B$=COM$[CY]
 COM_I_INK$=""
 COMI$=""
@WIN_COM_INPUTL
 COM_I_INK$=INKEY$()
 IF COM_I_INK$==CHR$(13)THEN RETURN
 IF COM_I_INK$!=""THEN COMI$=COMI$+COM_I_INK$:COM$[CY]=COM_IN_B$+COMI$:COMKF=0COMP$=""GOSUB COMPRT$
GOTO @WIN_COM_INPUTL
RETURN
 WIN_COM_IN_MX=LEN(COM$[CY])
 WIN_COM_IN_X=0
 WIN_COM_IN_I$=""
GPAGE 0,WINGPAGE,WINGPAGE
 FOR WIN_COM_IN_I=0TO 1
  WIN_COM_IN_I=0
WY=WINCOMSY+8+WINCOMZY*8
'GFILL WIN_COM_IN_X*8,WY,WIN_COM_IN_X*8+8,WY-1,0
  IF BUTTON()==4AND WIN_COM_IN_X>WIN_COM_IN_MX THEN WIN_COM_IN_X=WIN_COM_IN_X-1
  IF BUTTON()==8AND WIN_COM_IN_X<32THEN WIN_COM_IN_X=WIN_COM_IN_X+1
'GFILL WIN_COM_IN_X*8,WY,WIN_COM_IN_X*8+8,WY-1,15
  FOR WIN_COM_IN_J=0TO 3
   WIN_COM_IN_KEY=KEYBOARD
   WIN_COM_IN_K$=INKEY$()
   IF LEN(WIN_COM_IN_K$)THEN GOSUB @WIN_COM_IN_K
'?WIN_COM_IN_I$
VSYNC 1
  NEXT
 NEXT
GPAGE 0,WINGPAGE,!WINGPAGE
RETURN
@WIN_COM_IN_K
GFILL WIN_COM_IN_X*8,WY,WIN_COM_IN_X*8+8,WY-1,0
WIN_COM_IN_I$=MID$(WIN_COM_IN_I$,0,WIN_COM_IN_X)+WIN_COM_IN_K$+MID$(WIN_COM_IN_I$,WIN_COM_IN_X,256)
IF WIN_COM_IN_X<32THEN WIN_COM_IN_X=WIN_COM_IN_X+1
RETURN
@WIN_COM_ECHO
 A=FLOOR(WINCOMX2/8+WINCOMSX/8)-1
 B=FLOOR(WINCOMY2/8+WINCOMSY/8)
 IF A>=32THEN A=31
 IF B>=24THEN B=23
'BGCLIP 0OR(WINCOMSX/8),0OR(WINCOMSY/8)+1,A,B
 A=FLOOR(WFX2/8)-1
 B=FLOOR(WFY2/8)
 C=0OR(WFX/8)
 D=0OR(WFY/8)
 IF A<0THEN A=0
 IF B<0THEN B=0
 IF C<0THEN C=0
 IF D<0THEN D=0
 IF A>31THEN A=31
 IF B>23THEN B=23
 IF C>31THEN C=31
 IF D>23THEN D=23
 BGCLIP C,D,A,B
' CY=CY%65
 SCY=CY-(0OR (WINCOMY22))
 IF SCY<0THEN SCY=0
 SCYY=CY-(0OR (WINCOMY22))
' SCY=SCY%(65-FLOOR(WINCOMY22))
 IF CY<(FLOOR(WINCOMY22))THEN SCY=0:SCYY=0
 WINCMDF=0
 IF CY>=63THEN WINCMDF=1:CY=63:SCY=64-WINCOMY22:'GOSUB @WIN_COM_ECHO_S
 SCYYY=SCYY
 WINCOM=(SCYY*8)+WINCOMSCY*8
 IF WINCMDF==1THEN WINCOM=WINCOM+8
 IF WINCMDF THEN IF COMKF==1THEN GOSUB@WINCOMBGC:SCYYY=63 ELSE SCYYY=63
' WINCOMZY=((SCY+FLOOR(WINCOMY22))*(!WINCMDF))+(63*WINCMDF)
' COM$[((SCY+FLOOR(WINCOMY22))+1)%64]=""
 FOR I=SCY TO ((SCY+FLOOR(WINCOMY22))*(!WINCMDF))+(63*WINCMDF)
  K=0
' IF I>=64THEN I=99999:GOTO @WIN_COM_ECHO_SKP
   M$=COM$[I]
   IF I==CY THEN WINCOMZY=I-FLOOR(((WINCOMSY+WINCOM)/8))
 J=0
  FOR J=0 TO 63'(WINCOMX2/8)+WINCOMSCX-1
   IF MID$(M$,J,1)==""THEN BGFILL WINCOMR,J,I,63,I,32:A=0:J=64:GOTO@WINCOMECHOSKP
     A=ASC(MID$(M$,J,1))
   BGPUT WINCOMR,J,I,A
'   IF ((J+1)%32)==0THEN K=K+1
   @WINCOMECHOSKP
  NEXT
'I=I+3
@WIN_COM_ECHO_SKP
 NEXT
' BGOFS WINCOMR,511-WINCOMSX*8+WINCOMSCX*8,511-WINCOMSY*8+WINCOM
'IF CY>=64THEN CY=0
' IF WINCOM>=0 THEN WINCOM=0
' GFILL WINCOMSX,WINCOMSY,WINCOMX2+WINCOMSX,WINCOMY2+WINCOMSY,14
RETURN

------------
-0         - 0=1
------------ 
-1         - 1=2
------------
-2         - 
------------
-3         - 
------------
-4         - 
------------
-5         - 
------------
-6         - 6=7
------------ 
-7         - 7
------------
@WIN_COM_ECHO_S
 FOR I=0TO 62
  COM$[I]=COM$[I+1]
 NEXT
 COM$[63]=""
RETURN
@WINCOMBGC
 BGCOPY WINCOMR,0,1,63,63,0,0
'COMKF=1

RETURN
 FOR COM_Y=1TO 63
  FOR COM_X=0TO 63
   BGREAD(WINCOMR,COM_X,COM_Y),S
   BGPUT WINCOMR,COM_X,COM_Y-1,S
  NEXT
 NEXT
RETURN
@COM_ECHO
 K=0
 IF CX+LEN(COMP$)>31THEN K=1
 IF CY>=63AND OTW==1AND COMKF==1 THEN GOSUB @WIN_COM_ECHO_S
 IF CY>63THEN CY=63
 CX=LEN(COM$[CY])
 COM$[CY]=MID$(COM$[CY],0,CX)+COMP$
'(32*(0OR(CX/32))),(32*(0OR(CX/32))))+COMP$
' CX=CX+LEN(COMP$)
'CX=CX+LEN(COM$[CY])
 CY=CY+(COMKF==1)
' IF CY>=62 THEN ELSE COM$[CY+1]=""
'CX=CX
 CYY=CYY+(COMKF==1)
 IF OTW==1THEN GOSUB @WIN_COM_ECHO
 COMKF=1
' IF WINCMDF==1 AND COM_IF==0 THEN COM_IF=2:COMP$="":GOSUB COMPRT$:COM_IF=0
' IF COM_IF==2 THEN COM_IF=1:RETURN
 COMP$=""

RETURN

'OTYAXWINDOWMANUAL
@MANUAL
±ÌßØ
'-------------
'@S_NAME
 WINX2=
 WINY2=
RETURN
'@WIN_NAME
RETURN
'-------------
'-------------
'@S_NAME
 WIN_MODE=1GOSUB @WINFLAG
 WINX2=
 WINY2=
RETURN
'@WIN_NAME
 'WINDESIGN$="VISUAL
 GOSUB @WINDOW:IF WINIDFLG==1THEN RETURN
RETURN
'-------------
@M_SAMPLE
HELLO,WORLD!!
@S_S_HL
RETURN
@WIN_S_HL
 WINSX=0
 WINSY=0
 WINSC=1
 WINSTR$="Hello"
 GOSUB @WINSTRPUT
RETURN
1LINE EDITOR
@S_S_1LINE
 WINX2=128
 WINY2=20
 WINTTL$="1LINE EDITOR
RETURN
@WIN_S_1LINE
 WINTX=0:WINTY=0:WINTX2=116
 WINTSX=WIN1LINEX
 WINTA=WIN1LINEA
 WINTXTP$=WIN1LINE$
 GOSUB @WINTXTBOX
 WIN1LINE$=WINTXT$
 WIN1LINEX=WINTSX
 WIN1LINEA=WINTA
RETURN
Ê¯¶¯À¯É¯¼µ
@S_S_HKT
 WINX2=52
 WINY2=20
RETURN
@WIN_S_HKT
 WINBX=0:WINBY=0:WINBSTR$="CLICK!"
 GOSUB @WINBTN
 IF WINBTNF THEN TALK"@T50Ê!/¶!/À!/É!/@T50¼./µ!
RETURN
@S_S_V
 WIN_MODE=1
 WINTTL$="³²ÃÙ...
 GOSUB @WINFLAG
 WINX2=128:WINY2=24
RETURN
@WIN_S_V
 WINDESIGN$="VISUAL
 WINBG=1
 GOSUB @WINDOW
 IF WINIDFLG==1THEN RETURN
 WINSX=0:WINSY=0:WINSC=0:WINSTR$="ÀÀÞ¼NORMALÆ¶·ÞÙ
 GOSUB @WINSTRPUT
RETURN
@M_API
@MWINSTRPUT
->
WINSX=»ÞË®³
WINSY=»ÞË®³
WINSC=ÊßÚ¯Ä
WINSTR$=Ó¼Þ
<-Å¼
@MWINBTN
->
WINBX=»Þ
WINBY=»
WINBSTR$=Ó¼Þ
<-
WINBTNF=µ»ÚÀ¶
@MWINPROGBAR
WINPX,WINPY,WINPX2,WINPY2
WINPS=»²ÀÞ²
@MWINCHKBOX
WINCX,WINCY
WINCSTR$=
WINCHKF=µ»ÚÃ²Ù¶
->WINCHKF=µ»ÚÀ¶
@T
@TEMPLATE
DATA"@C_{N}
DATA" GOSUB@WINCLOSE
DATA"RETURN
DATA"@S_{N}
DATA" WINX2={X2}
DATA" WINY2={Y2}
DATA"RETURN
DATA"@WIN_{N}
DATA"RETURN
DATA END
@TEMPLATE2
ACLS:CLEAR
DATA"@C_{N}
DATA" BF={N}_BF
DATA" GOSUB@WINBUFFC
DATA" GOSUB@WINCLOSE
DATA"RETURN
DATA"@A_{N}
DATA" {DIM}
DATA"'DIM   'Ê²ÚÂ¾Ý¹ÞÝ
DATA"RETURN
DATA"@S_{N}
DATA" GOSUB@WINBUFF  'ÊÞ¯Ì§¶¸Î
DATA" IF BF==0 THEN RETURN   '´×-¼®Ø
DATA" {N}_BF=BF
DATA" BFC=15 'GCLS½Ù²Û
DATA" GOSUB@WINBUFFGCLS
DATA" WINCLS=1   '@C_Ê¿Ý»Þ²¼Ã²Ï½
DATA" IF {N}_A==0 THEN GOSUB@A_{N}
DATA" {N}_A=1
DATA" WINX2={X2}
DATA" WINY2={Y2}
DATA"RETURN
DATA"@WIN_{N}
DATA" GCOPY {N}_BF,0,0,WFX-WINSCX,WFY-WINSCY,WFX,WFY
DATA" GOSUB@WINBUFFP
DATA" GOSUB@WINBUFFP2
DATA"RETURN
DATA END
DIM VARN$[256]
DIM VAR$[256]
LBL$="@TEMPLATE2
@TEMPLATECOM
INPUT"NAME?(VARSET¨V,PREV¨P,LABEL¨@)";N$
IF N$=="V"THEN GOTO@TEMPLATEVARSET
IF N$=="P"THEN GOTO@TEMPLATEP
IF N$=="@"THEN INPUT"LABEL(NOT @)";L$:LBL$="@"+L$:GOTO@TEMPLATECOM
RESTORE LBL$
VARN$[0]="N"
VAR$[0]=N$
J=0
FOR I=0TO 1
 READ R$
 IF R$!="END"THEN I=0:GOSUB@TEMPLATECHK
NEXT
FOR I=1TO F+1
 KEY I,F$[I-1]
NEXT
END
@TEMPLATECHK
 GOSUB @TEMPLATEVAR
 IF LEN(R$)+1+LEN(F$[F])>255THEN F=F+1
 L=L+1
 ?L*10" "R$
 F$[F]=F$[F]+R$+CHR$(13)
RETURN
@TEMPLATEVAR
 SX=-1
 FOR J=0TO LEN(R$)-1
  IF MID$(R$,J,1)=="{"AND SX==-1THEN SX=J+1
  IF MID$(R$,J,1)=="}"AND SX>-1THEN EX=J-1:GOSUB@TEMPLATEVAR2:SX=-1:EX=-1
 NEXT
RETURN
@TEMPLATEVAR2
 VN$=MID$(R$,SX,EX-SX+1)
 FOR K=0TO 255
  IF VARN$[K]==VN$THEN R$=MID$(R$,0,(SX-1>=0)*(SX-1))+VAR$[K]+MID$(R$,EX+2,256)
 NEXT
RETURN
@TEMPLATEVARSET
 LINPUT"VARNAME?(RETURN¨RT)";VN$
 IF VN$=="RT"THEN GOTO @TEMPLATECOM
 LINPUT"VALUE?";VL$
 V=V+1
 VARN$[V]=VN$
 VAR$[V]=VL$
GOTO @TEMPLATEVARSET
@TEMPLATEP
 RESTORE LBL$
 FOR I=0TO 1
  READ R$
  IF R$!="END"THEN I=0GOSUB@TEMPLATEVAR
  ?R$
 NEXT
 RESTORE LBL$
GOTO@TEMPLATECOM
@C_HTN
 GOSUB@WINCLOSE
 TALK "³Ü±±±Ä¼ÞÙÅ±±±
RETURN
@S_HTN
 WINCLS=1
 WINX2=128
 WINY2=128
 WINTTL$="Hello,OTYAX"
 HTN_F=0
 HTN_X=0
 WINMLT[TSK]=HTN_I
 HTN_I=(HTN_I+1)%10
RETURN
@WIN_HTN
 I=WINMLT[TSK]
 WINSX=HTN_X[I]:WINSY=0:WINSC=1:WINSTR$="Hello,World!!"*!HTN_F[I]+"hatenahageta"*HTN_F[I]
 GOSUB @WINSTRPUT
 HTN_X[I]=(HTN_X[I]+1)%128
 WINBX=8
 WINBY=8
 WINBSTR$="hatena"
 GOSUB @WINBTN
 IF WINBTNF THEN HTN_F[I]=1:WINEXE$="HTN":GOSUB @WINEXE
RETURN

@C_HTNP
 BF=HTNP_BF
 GOSUB@WINBUFFC
 GOSUB @WINCLOSE
RETURN
@S_HTNP
 WINX2=130
 WINY2=107+8
 WINCLS=1
 GOSUB @WINBUFF
 IF !BF THEN RETURN
 HTNP_BF=BF 
 HTNP_C=0
 HTNP_P=0
 BFC=15
 GOSUB @WINBUFFGCLS
 WINTTL$="HNPAINT"
RETURN
@WIN_HTNP7
 IF CLICK3 THEN GCLS HTNP_CL
RETURN
@WIN_HTNP6
 IF CLICK THEN HTNP_X=MOUSEX-WFX:HTNP_Y=MOUSEY-WFY
 F=0
IF CLICK2 THEN GOSUB@WINBUFFP2:GCIRCLE HTNP_X+WFX,HTNP_Y+WFY,MOUSEX-HTNP_X-WFX,HTNP_CL
 IF F THEN GOSUB@WINBUFFP
 IF CLICK3 THEN GCIRCLE HTNP_X,HTNP_Y,MOUSEX-HTNP_X-WFX,HTNP_CL
RETURN
@WIN_HTNP5
 IF CLICK THEN HTNP_X=MOUSEX-WFX:HTNP_Y=MOUSEY-WFY
 F=0IF CLICK2 THEN GOSUB@WINBUFFP2:GFILL HTNP_X+WFX,HTNP_Y+WFY,MOUSEX,MOUSEY,HTNP_C+HTNP_P*16
 IF F THEN GOSUB@WINBUFFP
 IF CLICK3 THEN GFILL HTNP_X,HTNP_Y,MOUSEX-WFX,MOUSEY-WFY,HTNP_C+HTNP_P*16
RETURN
@WIN_HTNP4
 IF CLICK THEN HTNP_X=MOUSEX-WFX:HTNP_Y=MOUSEY-WFY
 F=0IF CLICK2 THEN  GOSUB@WINBUFFP2:GBOX HTNP_X+WFX,HTNP_Y+WFY,MOUSEX,MOUSEY,HTNP_C+HTNP_P*16
 IF F THEN GOSUB@WINBUFFP
 IF CLICK3 THEN GBOX HTNP_X,HTNP_Y,MOUSEX-WFX,MOUSEY-WFY,HTNP_C+HTNP_P*16
RETURN
@WIN_HTNP3
 IF CLICK3 THEN GPAINT MOUSEX-WFX,MOUSEY-WFY,HTNP_CL
RETURN
@WIN_HTNP2
 IF CLICK THEN HTNP_X=MOUSEX-WFX:HTNP_Y=MOUSEY-WFY
 F=0IF CLICK2 THEN  GOSUB@WINBUFFP2:GLINE HTNP_X+WFX,HTNP_Y+WFY,MOUSEX,MOUSEY,HTNP_C+HTNP_P*16
 IF F THEN GOSUB@WINBUFFP
 IF CLICK3 THEN GLINE HTNP_X,HTNP_Y,MOUSEX-WFX,MOUSEY-WFY,HTNP_C+HTNP_P*16
RETURN
@WIN_HTNP1
 IF CLICK THEN HTNP_X=MOUSEX-WFX:HTNP_Y=MOUSEY-WFY
 FOR I=1TO CLICK2==1
   GLINE HTNP_X,HTNP_Y,MOUSEX-WFX,MOUSEY-WFY,HTNP_C+HTNP_P*16
 NEXT
 IF CLICK2 THEN HTNP_X=MOUSEX-WFX:HTNP_Y=MOUSEY-WFY
RETURN
@WIN_HTNP
 BF=HTNP_BF
 HTNP_CL=HTNP_C+HTNP_P*16
 BF_X=0BF_Y=0BF_X2=120BF_Y2=88GOSUB@WINBUFFCPY
'GCOPY BF,0,0,120,88,WFX,WFY,1
 GOSUB@WINBUFFP
 F=0
 IF MOUSEX>=WFX AND MOUSEX<=WFX+120 THEN F=1
 IF F==1AND MOUSEY>=WFY AND MOUSEY<=WFY+88THEN F=2
 IF F!=2 THEN @HTNP_S
 F=-1IF WINFLG==2 THEN F=HTNP_M
IF F!=-1THEN ON F GOSUB@WIN_HTNP1,@WIN_HTNP2,@WIN_HTNP3,@WIN_HTNP4,@WIN_HTNP5,@WIN_HTNP6,@WIN_HTNP7
@HTNP_S

 GOSUB@WINBUFFP2
 FOR I=0TO 15
  GFILL WFX+I*8,WFY+88,WFX+I*8+8,WFY+96,I+16*HTNP_P
 NEXT
 GBOX WFX-1,WFY-1,WFX+120,WFY+88,14
 GBOX WFX+HTNP_C*8,WFY+88,WFX+HTNP_C*8+8,WFY+96,14
 F=0
 IF MOUSEX>=WFX AND MOUSEX<=WFX2 THEN F=1
 IF F==1AND MOUSEY>=WFY+88AND MOUSEY<=WFY+96 THEN F=2
 IF F==2AND CLICK THEN HTNP_C=0OR(MOUSEX-WFX)/8

 WINSTR$="0123456789ABCDEF"
 WINSX=0
 WINSY=97
 WINSC=1
 GOSUB @WINSTRPUT
 F=0
 IF MOUSEX>=WFX AND MOUSEX<=WFX2 THEN F=1
 IF F==1AND MOUSEY>=WFY+96AND MOUSEY<=WFY+104THEN F=2
 IF F==2AND CLICK THEN HTNP_P=0OR(MOUSEX-WFX)/8
 GBOX WFX+HTNP_P*8,WFY+96,WFX+HTNP_P*8+8,WFY+104,14
 WINBX=120
 WINBY=0
 WINBSTR$="¨"
 GOSUB @WINBTN
 F=0
 IF WINBTNF==1THEN HTNP_PL=!HTNP_PL
 IF HTNP_PL==1THEN @HTNP_M
RETURN
@HTNP_M
 WINMX=128
 WINMX2=128+64
 WINMY=8
 WINMK=HTNP_MK
 WINMKS=HTNP_MKS
 WINMMAX=6
 WINM$[0]="PSET
 WINM$[1]="LINE
 WINM$[2]="PAINT
 WINM$[3]="BOX
 WINM$[4]="FILL
 WINM$[5]="CIRCLE
 WINM$[6]="GCLS
 GOSUB @WINMENU2
 HTNP_MK=WINMK
 HTNP_MKS=WINMKS
 IF WINM!=-1AND CLICK AND HTNP_MK==0THEN HTNP_M=WINM
RETURN
@S_WWWW
RETURN
@WIN_WWWW
 WINEXE$="MAC
 IF WINACTV THEN GOSUB @WINEXE
RETURN
///<SUMMARY>
/// ºÔÂÒÊÊÊ
/// ºÔÂÒÊÊÊ
/// ÊÊÊºÔÂÒÊ Ê Ê
///</SUMMARY>
@S_HAHAHA
HAHAHAL$="CºCÔCÂEÒAÊAÊAR8ÊDºDÔDÂFÒGÊGÊGR4ÊGÊGÊG#ÊAºAÔAÂG#ÒG2ÊB2ÊC1Ê
HAHAHAX=0
WINY2=74
WINTTL$="ºÔÂÒ
RETURN
@WIN_HAHAHA
 IF BGMCHK(2)==0THEN @WIN_HAHAHAS
 GPUTCHR WFX,WFY,"BGF",ASC(HEHEHE$),1,8
RETURN
@WIN_HAHAHAS
 IF HAHAHAX>=LEN(HAHAHAL$) THEN HAHAHAX=0
 HAHAHAM$=""
 J=HAHAHAX
 D=0
 FOR I=J TO LEN(HAHAHAL$)-1
  M$=MID$(HAHAHAL$,I,1)
  IF ASC(M$)>=ASC("¦") AND ASC(M$)<=ASC("Ý")THEN I=999:HEHEHE$=M$ ELSE HAHAHAM$=HAHAHAM$+M$
 NEXT
 HAHAHAX=HAHAHAX+LEN(HAHAHAM$)+1
 BGMSET 128,HAHAHAM$
 BGMPLAY 2,128
RETURN

@S_POKOPOKO
 WINX2=170
 WINTTL$="POKOPOKO
 IF POKOF==0THEN DIM POKOE[5]
 POKOTM=1024
 POKOTTL=1
 POKOF=1
RETURN
TTLÛ¼Þ¯¸
@TTL_POKOPOKO
 WINSX=0WINSY=0WINSC=1
 WINSTR$="„GPOKOPOKO„F
 GOSUB @WINSTRPUT
 WINSX=0WINSY=8WINSC=1
 WINSTR$="SCORE:„G+10,„I+20,„s-10
 GOSUB @WINSTRPUT
 WINSX=0WINSY=16WINSC=1
 WINSTR$="TIME:„Q+10
 GOSUB @WINSTRPUT
 WINSX=0WINSY=24
 WINSTR$="CLICK TO START"
 WINSC=RND(16)
 GOSUB @WINSTRPUT
 IF MOUSEX>=WFX AND MOUSEX<=WFX2 AND MOUSEY>=WFY AND MOUSEY<=WFY2 AND CLICK THEN POKOTTL=0
RETURN
@WIN_POKOPOKO
 IF POKOTTL THEN @TTL_POKOPOKO
 '±Å
 FOR I=0TO 4
  GCIRCLE WFX+8+16+I*32,WFY+16+16,16,9
 NEXT
 WINSX=0WINSY=0WINSC=1WINSTR$="SCORE:"+STR$(POKOS)+"0TIME:"+STR$(POKOT)GOSUB @WINSTRPUT
 IF POKOE THEN WINSX=0WINSY=8WINSC=1WINSTR$="TIME UP „~CLICK TO RESTART"GOSUB @WINSTRPUT
 IF POKOE THEN IF CLICKR AND WINACTV THEN POKOE=0POKOS=0POKOT=0 ELSE RETURN 
 'IFÉ×ÚÂ¥¥¥ ¼ÞÂÆ·ÀÅ²
 FOR I=0TO 4
  IF POKOE[I]==0AND RND(100)==0THEN POKOE[I]=1:POKOT[I]=POKOT+15
  R=RND(200)
  IF POKOE[I]==0AND R==1THEN POKOE[I]=2:POKOT[I]=POKOT+15
  IF POKOE[I]==0AND R==2THEN POKOE[I]=4:POKOT[I]=POKOT+15
  IF POKOE[I]==0AND R==0THEN POKOE[I]=3:POKOT[I]=POKOT+15
  IF POKOE[I]==1THEN GPUTCHR WFX+8+32*I+3,WFY+18,"BGF",ASC("„G"),1,4
  IF POKOE[I]==2THEN GPUTCHR WFX+8+32*I+3,WFY+16,"BGF",ASC("„I"),1,4
  IF POKOE[I]==3THEN GPUTCHR WFX+8+32*I+3,WFY+16,"BGF",ASC("„s"),1,4
  IF POKOE[I]==4THEN GPUTCHR WFX+8+32*I+3,WFY+18,"BGF",ASC("„Q"),1,4
  F=0
  IF MOUSEX>=WFX+16+32*I AND MOUSEX<=WFX+48+32*I THEN F=1
  IF F==1AND MOUSEY>=WFY+16 AND MOUSEY<=WFY+48 THEN F=2
  IF F==2AND CLICK AND POKOE[I]==1THEN BEEP 3:POKOE[I]=0:POKOS=POKOS+1
  IF F==2AND CLICK AND POKOE[I]==2THEN BEEP 5:POKOE[I]=0:POKOS=POKOS+2
  IF F==2AND CLICK AND POKOE[I]==4THEN BEEP 15:POKOE[I]=0:POKOT=POKOT-10
  IF F==2AND CLICK AND POKOE[I]==3THEN BEEP 14:POKOE[I]=0:POKOS=POKOS-1
  IF POKOE[I]==4AND POKOT>POKOT[I] THEN POKOE[I]=0
  IF POKOE[I]==3AND POKOT>POKOT[I] THEN POKOE[I]=0
  IF POKOE[I]==2AND POKOT>POKOT[I] THEN POKOE[I]=0
  IF POKOE[I]==1AND POKOT>POKOT[I] THEN POKOE[I]=0
  IF POKOE[I]==0AND POKOT>POKOT[I] THEN POKOE[I]=0
 NEXT
 IF POKOT<0THEN POKOT=0
 POKOT=POKOT+1
 IF POKOT>=POKOTM THEN POKOE=1
RETURN
@S_SCRBAR
 K=32
 DIM SCRBART$[K]
SCRBART$[0]="±Î"SCRBART$[1]="ÀÞÅ"SCRBART$[2]="ÃÞ½"SCRBART$[3]="Ï±"SCRBART$[4]="º¹º¯º"
SCRBART$[5]="ÎÚÎÚ"SCRBART$[6]="ÄÞ½"SCRBART$[7]="ºÝÆÁÊ"SCRBART$[8]="ÌßÁºÝ"SCRBART$[9]="ÎÞ-Ý"
SCRBART$[10]="ÌÌÌ"SCRBART$[11]="ÆÔØ"SCRBART$[12]="¹ÞÛ"SCRBART$[13]="Èº"SCRBART$[14]="¾²º³"
SCRBART$[15]="¼¯Êß²"SCRBART$[16]="¾²ÐÂ"SCRBART$[17]="·¸Þ"SCRBART$[18]="¹¹¹"SCRBART$[19]="º¼®³"
SCRBART$[20]="³¿"SCRBART$[21]="ÃÞ½"SCRBART$[22]="YOU!"SCRBART$[23]="ÑÑÑ"SCRBART$[24]="OTYAX"
SCRBART$[25]="ÌÍÌÍ"SCRBART$[26]="ÜÝ"SCRBART$[27]="Ü²Ý"SCRBART$[28]="±±"SCRBART$[29]="ÃÚÚÚÚ"
SCRBART$[30]="Ð¶Ý"SCRBART$[31]="¾Ì"
 SCRBAR$="Å-¶Þ¶Þ¶Þ½ºÞ¸Å¶Þ²¼º¼ÕÌÔÔÔÃºÎÔÛ ËÈÎ"
 DIM SCRBAR$[24]
 FOR I=0TO 23
  FOR J=0TO LEN(SCRBAR$)-1
'   SCRBAR$[I]=SCRBAR$[I]+CHR$(RND(62)+161)
   SCRBAR$[I]=SCRBAR$[I]+SCRBART$[RND(K)]'CHR$(RND(62)+161)
   J=LEN(SCRBAR$[I])
  NEXT
 NEXT
RETURN
@WIN_SCRBAR
 WINBX=62-8
 WINBY=0
 WINBY2=52-8
 WINBM=(24-5)*8
 WINBX2=SCRBAR_X2
 GOSUB @WINSCRBARY
 SCRBAR_X2=WINBX2
 WINBX=0
 WINBX2=62-8
 WINBY=52-8
 WINBM=LEN(SCRBAR$)*8-56
 WINBY2=SCRBAR_Y2
 GOSUB @WINSCRBARX
 SCRBAR_Y2=WINBY2
 FOR I=0TO 4
 WINSX=0:WINSY=I*8:WINSC=1
 WINSTR$=MID$(SCRBAR$[I+SCRBAR_X2/8],WINBY2/8,7)
 GOSUB @WINSTRPUT
 NEXT
RETURN
@COM_HTN
 COMKF=0
 COMP$="AHO"GOSUB COMPRT$
RETURN
@S_TSKF
WINY2=96
WINX2=64+16
RETURN
@WIN_TSKF
 IF RND(1000)THEN GOSUB@TSKMAX:WTSKFTI=TSKM
 FOR I=WINTSKFYY TO WTSKFTI-1
  WINSX=0WINSY=(I-(WINTSKFYY))*8WINSC=1
  WINSTR$=MID$(WINNAME$[I]+":"+STR$(TSKF[I])+":"+STR$(WINID[I]),WINTSKFXX,8)
  GOSUB @WINSTRPUT
 NEXT
 WINBX=64-10+16
 WINBY=0
 WINBY2=86-10
 WINBX2=WINTSKFY
 WINBM=TSKMAX*8
 GOSUB @WINSCRBARY
 WINTSKFY=WINBX2
 WINTSKFYY=0OR WINBX2/8

 WINBX=0
 WINBX2=64-10+16
 WINBY=84-8
 WINBM=15*8
 WINBY2=WINTSKFX
 GOSUB @WINSCRBARX
 WINTSKFX=WINBY2
 WINTSKFXX=0OR WINTSKFX/8
RETURN
@S_BG
 WINY2=43
 WINTTL$="BG"
RETURN
@WIN_BG
 GFILL WFX,WFY,WFX2,WFY2,WIN_BG_CL
 WINN=WIN_BG_CL
 WINNX=0
 WINNY=0
 WINNY2=32
 WINNX2=32
 WINNM=255
' WINNSP=0.5
 GOSUB @WINNUMUPDWN
 WIN_BG_CL=WINN
 WINBX=33
 WINBY=0
 WINBSTR$="OK"
 GOSUB @WINBTN
 IF WINBTNF THEN OTWBGCL=WINN
RETURN

@S_HELP
 WINCLS=1
 WINTTL$="HELP"
 WINX2=90
 WINY2=86
RETURN
@WIN_HELP
 ON HELP_M GOTO @WIN_HELP1,@WIN_HELP2,@WIN_HELP3
@WIN_HELP1
 WINLBLX=0
 WINLBLY=0
 WINLBL$="±ÌßØÉ·ÄÞ³"
 GOSUB@WINLNKLBL
 IF WINLBLF THEN HELP_M=1:GOSUB@DIC_HELP1
 WINLBLX=0
 WINLBLY=8
 WINLBL$="¼½ÃÑ´×-"
 GOSUB@WINLNKLBL
 IF WINLBLF THEN HELP_M=2:GOSUB@DIC_HELP2
RETURN
@WIN_HELP3
 WINBX2=WIN_HELP_X
 WINBM=8WINBX2=WIN_HELP_X2:GOSUB @SCR_HELP:WIN_HELP_X2=WINBX2
 WINBM=68
 WINBY2=WIN_HELP_Y2
 GOSUB@SCR_HELPX
 WIN_HELP_Y2=WINBY2
 WINLBLX=0
 WINLBLY=0
 WINLBL$="TOP"
 GOSUB@WINLNKLBL
 IF WINLBLF THEN HELP_M=0
 FOR I=0TO 6
  WINSX=0
  WINSY=I*8+8
  WINSC=1
  WINSTR$=MID$(HELP_DIC$[I+WIN_HELP_X2/4],WINBY2/4,10)
  GOSUB@WINSTRPUT
 NEXT
RETURN
@WIN_HELP2
 WINLBLX=0
 WINLBLY=0
 WINLBL$="TOP"
 GOSUB@WINLNKLBL
 IF WINLBLF THEN HELP_M=0
 
 WINBY2=WIN_HELP_Y2
 WINBM=60
 GOSUB @SCR_HELPX
 WIN_HELP_Y2=WINBY2
 FOR I=0TO 3
  WINSX=0
  WINSY=I*8+8
  WINSC=1
  WINSTR$=MID$(HELP_DIC$[I],WINBY2/4,12)
  GOSUB@WINSTRPUT
 NEXT
RETURN
@DIC_HELP1
 HELP_DIC$[0]="RUNÉÃ·½ÄÎÞ¯¸½Æ±ÌßØÒ²¦
 HELP_DIC$[1]="Æ­³Ø®¸¼Ã[RUN]¦¸Ø¯¸½ÚÊÞ
 HELP_DIC$[2]="·ÄÞ³¼Ï½¡
 HELP_DIC$[3]="*¿Ý»Þ²¼Å²ÊÞ±²Ê´×-¶ÞÃÞÏ½¡
RETURN

@DIC_HELP2
 HELP_DIC$[0]="SYSTEMERROR
 HELP_DIC$[1]="Out of buffer
 HELP_DIC$[2]="ÊÞ¯Ì§ÌÞ¿¸ÃÞ½¡
 HELP_DIC$[3]=""
 HELP_DIC$[4]="ÊÞ¯Ì§Ê»²ÀÞ²2ÂÏÃÞÃÞ
 HELP_DIC$[5]="±ÌßØ¶Þ²¼Þ®³¼­³Ø®³¼ÀÄ·ÆÓÃÞÙ
 HELP_DIC$[6]="ÊÞ±²Ó±ØÏ½¡
 HELP_DIC$[7]=""
 HELP_DIC$[8]="Åµ×Å²ÊÞ±²Ê»²·ÄÞ³¼Ã¸ÀÞ»²¡
RETURN

@SCR_HELPX
 WINBX=0
 WINBX2=WINX2-WINDEGX2-WINDEGX
 WINBY=WINY2-WINDEGY-WINDEGY2-8
 GOSUB @WINSCRBARX
RETURN
@SCR_HELP
 WINBX=WINX2-WINDEGX2-WINDEGX-8
 WINBY=WINY'+WINDEGY
 WINBY2=WINY2-WINDEGY-WINDEGY2-8
 GOSUB @WINSCRBARY
RETURN

@C_HELP
 WIN_HELP_Y2=0
 WIN_HELP_X2=0
 GOSUB@WINCLOSE
RETURN

@C_SCR
 BF=SCR_BF
 GOSUB@WINBUFFC
 GOSUB@WINCLOSE
RETURN
@A_SCR
 DIM SCR_EX[16],SCR_EY[16],SCR_E[16]  'Ê²ÚÂ¾Ý¹ÞÝ
'DIM SCR_ETX[16,16],SCR_ETY[16,16],SCR_ET[16,16]  'Ê²ÚÂ¾Ý¹ÞÝ
 DIM SCR_ETX[32],SCR_ETY[32],SCR_ET[32]  'Ê²ÚÂ¾Ý¹ÞÝ
 DIM SCR_TX[16],SCR_TY[16],SCR_T[16]  'Ê²ÚÂ¾Ý¹ÞÝ
RETURN
@S_SCR
 GOSUB@WINBUFF  'ÊÞ¯Ì§¶¸Î
 IF BF==0 THEN RETURN   '´×-¼®Ø
 SCR_BF=BF
 BFC=9 'GCLS½Ù²Û
 GOSUB@WINBUFFGCLS
 WINCLS=1   '@C_Ê¿Ý»Þ²¼Ã²Ï½
 IF SCR_A==0 THEN GOSUB@A_SCR
 SCR_A=1
 WINX2=130
 WINY2=108
 SCR_X=64
 SCR_PY=88
 SCR_PX=64
 GOSUB@WINBUFFP
 FOR I=0TO 15
  GPUTCHR I*8-1,128,"BGF",255,1,1
  GPUTCHR I*8,128,"BGF",255,5,1
 NEXT
 GOSUB@WINBUFFP2
RETURN
@WIN_SCR
 BF=SCR_BF
 BF_X=0BF_Y=0BF_X2=128BF_Y2=96GOSUB@WINBUFFCPY
'GCOPY SCR_BF,0,0,128,96,WFX,WFY,1
 GOSUB@WINBUFFP
  GCOPY SCR_BF,0,2,128,96,0,0,1
  SCR_X=SCR_X+RND(-3)+1
  IF SCR_X>120THEN SCR_X=120
  IF SCR_X<0THEN SCR_X=0
'  GLINE 0,96,128,96,10
  IF !RND(1000)THEN GPUTCHR RND(128),88,"BGF",232,RND(16),1
  IF !RND(10)THEN GPUTCHR RND(64)*2,88,"BGF",8,RND(16),1
  SCR_C=!SCR_C
  GCOPY SCR_BF,0,128,128,129,0,95,1
  GLINE SCR_X,95,SCR_X+8,95,9
  SCR_X=SCR_X+RND(-3)+1
  GLINE SCR_X,96,SCR_X+8,96,9
  B=BUTTON()
  SCR_PX=SCR_PX+-((B AND 4)==4)*2+((B AND 8)==8)*2
  SCR_PY=SCR_PY+-((B AND 1)==1)*2+((B AND 2)==2)*2
 GOSUB@WINBUFFP2
  GPUTCHR SCR_PX+WFX,WFY+SCR_PY,"BGF",5,2,1
 C=SCR_C
 SCR_D=(SCR_D+1)%16
 FOR I=0TO 15
  IF!C AND !SCR_T[I]AND(B AND 16)==16THEN SCR_T[I]=1SCR_TX[I]=SCR_PX+3:SCR_TY[I]=SCR_PY:C=1
  IF!SCR_T[I]THEN @SKP_SCR
  GFILL SCR_TX[I]+WFX,WFY+SCR_TY[I],SCR_TX[I]+1+WFX,SCR_TY[I]-4+WFY,13
  SCR_TY[I]=SCR_TY[I]-4
  IF SCR_TY[I]<0THEN SCR_T[I]=0
  F=0
  IF SCR_TY[I]>=SCR_PY AND SCR_TY[I]<=SCR_PY+8 THEN F=1
  IF F==1AND SCR_TX[I]-8>=SCR_PX AND SCR_TX[I]+8<=SCR_PX THEN SCR_ET[I]=0:BEEP 13:?Q
@SKP_SCR
  V=1
  IF!SCR_E[I]AND RND(1000)==0THEN SCR_E[I]=3:SCR_EX[I]=RND(128):SCR_EY[I]=0
  IF!SCR_E[I]AND RND(1000)==0THEN SCR_E[I]=2:SCR_EX[I]=RND(128):SCR_EY[I]=0
  IF!SCR_E[I]AND RND(100)==0THEN SCR_E[I]=1:SCR_EX[I]=RND(128):SCR_EY[I]=0
  ON SCR_E[I]-1 GOSUB @ENE1_SCR,@ENE2_SCR,@ENE3_SCR
 NEXT
 FOR I=0TO 31
  IF!SCR_ET[I]GOTO@SKPT_SCR
  GFILL SCR_ETX[I]+WFX,WFY+SCR_ETY[I],SCR_ETX[I]+1+WFX,SCR_ETY[I]+4+WFY,13
  SCR_ETY[I]=SCR_ETY[I]+4
  IF SCR_ETY[I]>96THEN SCR_ET[I]=0
  F=0
  IF SCR_ETY[I]>=SCR_PY AND SCR_ETY[I]-4<=SCR_PY THEN F=1
  IF F==1AND SCR_ETX[I]>=SCR_PX AND SCR_ETX[I]+8<=SCR_PXTHEN SCR_ET[I]=0:BEEP 13:?Q
@SKPT_SCR
 NEXT
RETURN
@ENE1_SCR
 SCR_EY[I]=SCR_EY[I]+1
 SCR_EX[I]=SCR_EX[I]+(RND(-3000)+1000)/1000
 GPUTCHR SCR_EX[I]+WFX,SCR_EY[I]+WFY,"BGF",14,2,1
 IF SCR_EY[I]>96THEN SCR_E[I]=0
 IF SCR_EX[I]>128THEN SCR_EX[I]=128
 IF SCR_EX[I]<0THEN SCR_EX[I]=0
 IF!RND(50)THEN V=1GOSUB@ENE_SCRTPP
RETURN
@ENE2_SCR
'SCR_EX[I]=SCR_EX[I]-COS(ATAN(SCR_PX-SCR_EX[I],SCR_PY-SCR_EY[I]))*2
 F=0
 IF SCR_EY[I]>SCR_PY+8 THEN SCR_EY[I]=SCR_EY[I]+0.9F=1
 IF!F THEN SCR_EY[I]=SCR_EY[I]+2
 IF !F AND SCR_EX[I]>SCR_PX THEN SCR_EX[I]=SCR_EX[I]-1
 IF !F AND SCR_EX[I]<SCR_PX THEN SCR_EX[I]=SCR_EX[I]+1
 GPUTCHR SCR_EX[I]+WFX,SCR_EY[I]+WFY,"BGF",6,1,1
 IF SCR_EY[I]>96THEN SCR_E[I]=0
 IF!RND(50)THEN V=2GOSUB@ENE_SCRTPP

RETURN
@ENE3_SCR
 SCR_EY[I]=SCR_EY[I]+1
 ON SCR_D/8 GOTO @ENE3_SCRA,@ENE3_SCRB
@ENE3_SCRA
 GPUTCHR SCR_EX[I]+WFX,SCR_EY[I]+WFY,"BGF",255,14,1
 GPUTCHR SCR_EX[I]+WFX+8,SCR_EY[I]+WFY,"BGF",255,14,1
 GPUTCHR SCR_EX[I]+WFX+16,SCR_EY[I]+WFY,"BGF",255,14,1
 GPUTCHR SCR_EX[I]+WFX,SCR_EY[I]+WFY-8,"BGF",151,2,1
 GPUTCHR SCR_EX[I]+WFX+8,SCR_EY[I]+WFY-8,"BGF",151,2,1
 GPUTCHR SCR_EX[I]+WFX+16,SCR_EY[I]+WFY-8,"BGF",151,2,1
 IF SCR_EY[I]>96THEN SCR_E[I]=0
RETURN
@ENE3_SCRB
 GPUTCHR SCR_EX[I]+WFX,SCR_EY[I]+WFY-8,"BGF",255,2,1
 GPUTCHR SCR_EX[I]+WFX+16,SCR_EY[I]+WFY-8,"BGF",255,2,1
 GPUTCHR SCR_EX[I]+WFX+8,SCR_EY[I]+WFY-8,"BGF",255,2,1
 GPUTCHR SCR_EX[I]+WFX,SCR_EY[I]+WFY,"BGF",151,14,1
 GPUTCHR SCR_EX[I]+WFX+8,SCR_EY[I]+WFY,"BGF",151,14,1
 GPUTCHR SCR_EX[I]+WFX+16,SCR_EY[I]+WFY,"BGF",151,14,1
 IF SCR_EY[I]>96THEN SCR_E[I]=0
RETURN
@ENE_SCRTPP
 FOR K=0TO 31
  IF!SCR_ET[K]THEN SCR_ET[K]=V:SCR_ETX[K]=SCR_EX[I]+2SCR_ETY[K]=SCR_EY[I]+8:K=320:BEEP 1
 NEXT
 V=1
RETURN
@S_BHAHAHA
 WIN_MODE=1GOSUB @WINFLAG
GOSUB @S_HAHAHA
RETURN
@WIN_BHAHAHA
 IF BGMCHK(2)==0THEN @WIN_HAHAHAS
RETURN
@C_CALC
 GOSUB@WINCLOSE
RETURN
@S_CALC
 WINCLS=1
 WINTTL$="„GCALC"
RETURN
@WIN_CALC
 GFILL WFX,WFY,WFX2,WFY+9,13
 GBOX WFX,WFY,WFX2,WFY+10,14
 WINBX=0
 WINBY=11
 WINBSTR$="C"
 GOSUB @WINBTN
RETURN
@S_DIA
RETURN
@WIN_DIA
 WINDSX=TSTDIA_SX
 WINDSY=TSTDIA_SY
 WINDX=72
 WINDY=64
 GOSUB@WINDIA
 TSTDIA_SY=WINDSY
 TSTDIA_SX=WINDSX
RETURN
@S_MEMED
 WINTTL$="MEMED
RETURN
@WIN_MEMED
 WINTX=0
 WINTY=8
 WINTX2=WINX2-2
 WINTY2=WINXY-2
 GOSUB@WINMLTTXTBOX
RETURN
@S_ST
 ST_VAR=1     '
 ST_VAL=2    '
 ST_FUNC=3    '
 ST_LEFT_PAR=4'(
 ST_RIGH_PAR=5')
 ST_STR=4
 DIM ST_TKN$[16]
 DIM ST_TKN_TY[16]
 ST_PRG$="PRINTF('Hello,World!!')"'PRINTF('A')"
 ST_FUNCTION$[0]="PRINTF"
 ST_FUNCTION$[1]="WINDOWSET"
 ST_STRFLG=1
RETURN
'F=´²¼ÞÀÞÄTRUE
@ST_ACHK
 F=ASC(VAR$)
 F=(F>=65 AND F<=90)OR(F>=97AND F<=122)
RETURN
@WIN_ST
 WINSX=0:WINSY=0:WINSC=2:WINSTR$=ST_PRG$
 ST_STRFLG=0
 ST_M$=""
 GOSUB@WINSTRPUT
 GOSUB @ST_NXT_TKN
 ?ST_TKN$,ST_TKN_TY
' ?MID$(ST_PRG$,ST_INDEX,1)
'INPUT A$
RETURN
@ST_NXT_TKN
 M$=MID$(ST_PRG$,ST_INDEX,1)
 VAR$=M$
 GOSUB@ST_ACHK
 IF M$=="'"AND ST_STRFLG THEN ST_STRFLG=0:ST_TKN$=MID$(ST_M$,1,256):ST_TKN_TY=ST_STR:RETURN
 IF ST_M$==""AND M$=="'"AND !ST_STRFLG THEN ST_STRFLG=1
 IF!F AND !ST_STRFLG THEN GOSUB@ST_K:ST_INDEX=ST_INDEX+1RETURN
 ST_M$=ST_M$+M$
 ST_INDEX=ST_INDEX+1
GOTO @ST_NXT_TKN
RETURN
@ST_K
' IF M$=="'"THEN ST_INDEX=ST_INDEX-1
 IF M$=="("THEN ELSE @ST_K_F
 ST_TKN$=ST_M$
 ST_TKN_TY=ST_FUNC
@ST_K_F
'STOP
RETURN
@S_VIRUS
 WINTTL$="½·¬ÝÁ­³..."
 WINX2=66+32
 WINVIRUSPROG=0
RETURN
@WIN_VIRUS
 WINPX=0
 WINPX2=96
 WINPY=0
 WINPY2=8
 WINPS=WINVIRUSPROG
 GOSUB @WINPROGBAR
 IF WINVIRUSPROG>=100THEN @WIN_VIRUS_OK
 WINVIRUSPROG=WINVIRUSPROG+0.1
 L$=""
 FOR I=0TO 7
  L$=L$+CHR$(65+RND(26))
 NEXT
 WINSX=0WINSY=9
 WINSTR$=L$
 IF RND(2) THEN WINSTR$=WINSTR$+".EXE" ELSE WINSTR$=WINSTR$+".DLL"
 WINSC=14
 GOSUB @WINSTRPUT
RETURN
@WIN_VIRUS_OK
 WINTTL$="½·¬Ý¼­³Ø®³"
 WINSTR$="²¼Þ®³Å¼"
 WINSX=0:WINSY=9
 WINSC=14
 GOSUB @WINSTRPUT
 WINSX=0WINSY=9
 WINBX=8
 WINBY=16
 WINBSTR$="OK"
 GOSUB @WINBTN
 IF WINBTNF THEN GOSUB @WINCLOSE
RETURN
@S_RECVTST
RETURN
@WIN_RECVTST
 GOSUB @WINRECV_MES
 IF!WINRECV_RESULT THEN MESTST$=WINRECVRESULT$:BEEP 46
 IF!WINRECV_RESULT THEN WIN_ID=WINRECVRESULTID:GOSUB@WINID2TSK
 IF!WINRECV_RESULT AND !WINID_RESULT THEN MESTST_$=WINNAME$[WINID_TSK]
 WINSX=0:WINSY=0:WINSC=1WINSTR$=MESTST$
 GOSUB @WINSTRPUT
 WINSX=0:WINSY=8:WINSC=1WINSTR$=MESTST_$
 GOSUB @WINSTRPUT
RETURN
@S_SENDTST
RETURN
@TES_SENDTST
 WINSEND$="RECVTST"
 WINSEND_MES$=SENDTST$
 GOSUB @WINSEND_MES
 IF WINSEND_RESULT THEN BEEP 2
RETURN
@WIN_SENDTST
 WINBX=0WINBY=0WINBSTR$="SEND"
 GOSUB @WINBTN
 IF WINBTNF THEN GOSUB @TES_SENDTST
 WINTX=0WINTY=10WINTX2=62WINTM=0WINTXTP$=SENDTST$
 WINTSX=SENDTST
 WINTA=SENDTA
 GOSUB @WINTXTBOX
 SENDTST$=WINTXT$
 SENDTST=WINTSX
 SENDTA=WINTA
RETURN
@S_BUFEXC
RETLBL$="@S_BUFEXC_
GOTO @WINEXCBUFF
@S_BUFEXC_
RETURN
@WIN_BUFEXC
RETURN
@DIM_SNOTE2
 DIM SNOTE2_TXT$[10]
 DIM SNOTE2_TSX[10]
 DIM SNOTE2_TA[10]
RETURN
@S_SNOTE2
 IF!SNOTE2_P THEN GOSUB @DIM_SNOTE2
 WINX2=126:WINY2=10
 WIN_MODE=1
 WINMLT[TSK]=SNOTE2_P
 GOSUB @WINFLAG
 SNOTE2_P=SNOTE2_P+1
RETURN
@WIN_SNOTE2
 GOSUB @FUNCWINSET
 _WINMOVBOXC=WINMOVBOXC
 _SNOTE2=WINMLT[TSK]
 WINDESIGN$="WIN_SNOTE2"
 WINMOVBOXC=12
 GOSUB @WINDOW
' IF WINFLG[TSK]==3AND SNOTE2_TA[_SNOTE2] THEN WINFLG[TSK]=2
 WINMOVBOXC=_WINMOVBOXC
 IF WINIDFLG==1THEN RETURN
 WINTX=0:WINTY=-WINY2:WINTM=0
 WINTX2=WINX2-10
 WINTXTP$=SNOTE2_TXT$[_SNOTE2]
 WINTA=SNOTE2_TA[_SNOTE2]
 WINTSX=SNOTE2_TSX[_SNOTE2]
 GOSUB @WINTXTBOX
 SNOTE2_TXT$[_SNOTE2]=WINTXT$
 SNOTE2_TA[_SNOTE2]=WINTA
 SNOTE2_TSX[_SNOTE2]=WINTSX
RETURN
@DEG_WIN_SNOTE2
 GFILL WX,WY,WX2,WY2,12
 GLINE WX2-6,WY+2,WX2-1,WY+7,0
 GLINE WX2-7,WY+2,WX2-2,WY+7,0
 GLINE WX2-1,WY+2,WX2-6,WY+7
 GLINE WX2-2,WY+2,WX2-7,WY+7
RETURN
@DGS_WIN_SNOTE2
 WINDEGX=1
 WINDEGY=WINY2
 WINDEGY2=1
 WINDEGX2=1
RETURN
@S_R
 WIN_MODE=1
 WIN_R=1
 GOSUB @WINFLAG
 WINX2=64WINY2=64
 WINTTL$="TST"
RETURN
@WIN_R
 GOSUB @WINDOW
 IF WINIDFLG==1THEN RETURN
RETURN
@S_MOUSET
 MOUSET_TXT$=MOUSERES$
 WIN_R=1
 WIN_MODE=1
 GOSUB @WINFLAG
 WINTTL$="MOUSE RESOURCE EDITOR"
RETURN
@WIN_MOUSET
 GOSUB @WINDOW
 IF WINY2<32THEN WINY2=32
 IF WINIDFLG==1THEN RETURN
 WINTX=1
 WINTY=0
 WINTX2=WINX2-3
 WINTSX=MOUSET_TSX
 WINTA=MOUSET_TA
 WINTXTP$=MOUSET_TXT$
 GOSUB @WINTXTBOX
 MOUSET_TSX=WINTSX
 MOUSET_TA=WINTA
 MOUSET_TXT$=WINTXT$
 WINBX=WINX2/2-10
 WINBY=10
 WINBSTR$="OK"
 GOSUB @WINBTN
 IF WINBTNF==1THEN MOUSERES$=MID$(WINTXT$,0,8)
RETURN
@S_SMS
 WINX2=24
 WINY2=10
 WINTTL$="SMS"
RETURN
@WIN_SMS
 B=BUTTON()
 IF B AND 1THEN MOUSEY=MOUSEY-60/FPS
 IF B AND 2THEN MOUSEY=MOUSEY+60/FPS
 IF B AND 4THEN MOUSEX=MOUSEX-60/FPS
 IF B AND 8THEN MOUSEX=MOUSEX+60/FPS
RETURN
@S_DESKTOP
 WIN_MODE=1GOSUB @WINFLAG
RETURN
@WIN_DESKTOP
 FOR I=TSK TO TSKMAX-1
  IF WINFLG[I]==0 THEN J=I:I=TSKMAX ELSE J=TSK
 NEXT
 GFILL 0,0,8,8,4
RETURN
@S_SEIUNS
B$="T140EFG2EGA2<CC>B2 B8A8G8A8B2 R4 A8B8A2<C4>A2B8<C8D2> R4 CDE2GGA2AAB2B8G8G8A2
B$=B$+"GGA<CCDED>B<C2> R4 GA<C2>
N=RND(128)+128
 BGMSET N,B$
'"EFG2EGA2<CC>B2 B8A8G8A8B2 R4 A8B8A2<C4>A2B8<C8D2> R4 CDE2GGA2AAB2B8G8G8A2 GGA<CCDED>B
 BGMPLAY RND(8),N
 SEIUNS_N=N
RETURN
@WIN_SEIUNS
 WINSX=0
 WINSY=0
 WINSC=1
 WINSTR$=STR$(SEIUNS_N)
 GOSUB @WINSTRPUT
RETURN
'MEMO ¹Ý»¸¼Ãµ·¶´ÒÝÄÞ³         „y„y VS   ³ÞÜÞÜÞÜÞÜÞ©-Ý ¬ÍÞÝÃÞ-ÌÞ ÎÞ¯¶Þ¶Þ·Þ
'„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z  „z„z„z„z„z„z„z„z„z„z„z„z„z„N---*---„M=   
'„x              „x „x                „{  À¹ÔÌÞ
'„xNOMAL->NORMAL „x „x·ÄÞ³¼Ã²ÙÀ½¸É¶½Þ „|???????
'„xDEGIN$->DESIGN$ „x @TSKMAX„S„S„S„S„S„S „R„w „R„R„R„T
'„x              „x „x„S„S„S„S„S„S„S„S„S„S„S„S„S„S„{ „|„F<×ÌÞÚÀ-¶Þ ÔÌÞ ÃÞ ÔÌÞÚÀ-
'„x¼Ã· hatema    „x „x„S„S¶ÝØ®„S„S„S„S„S„S„S„S„| „y )„R„R„T     _ ?
'„x  ¶ÝØ®-       „x „x„S„S„S„S„S„S„S„S„S„S„S„S„S„S „| !!„R„R„z  _/„w „w
'„¼„z„z„z„z„z„z„z„z„z„z„z„z„z„z„x „¼„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„{ „w„w„w„w „w„w     
@EOF                                 „|ÜÊÊÊÊÊÊ/  
'[EOF]                               „E „E „E „E „E
   „Ÿ„¦„Ÿ„  „ „¡„Ÿ END „¡„Ÿ„¢„R „¡  
    „  „¥„Ÿ„§„¥„Ÿ     „  „ „R „¥ILE
    „  „  „ „¤„Ÿ     „¤„Ÿ„£     
  „z„z„z„z„z„z
  „x    „y „{»-ÄÞÊß-Ã¨-É±ÌßØÃÞ½
 „y  „¦ „¦ „x„| 
 |      |   
 „x „x „Ÿ  „y  <É¯À  Ö¯À   ³¨-  Ö¯Ä ÃÞ ÌÅÖ²
„y        „x    HATENAHATENA
 „x      „y    HATENAHATENA
 |_„z__„z„z|   HATENAHATENA
'„½„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„¼
'„xMOUSE SCALE for OTYAX    „y
'„x                         „y
'„x<MSS>           by hatena„y
'„»„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„º

@S_MSS
 WINCLS=1:WIN_MODE=1
 WINX2=177:WINY2=32
 SPREAD(0),MSS_X,MSS_Y,MSS_A,MSS_S,MSS_C
 MSS_S=FLOOR(MSS_S)
 WINTTL$="Mouse Scale - "+STR$(MSS_S)+"%"
RETURN

@WIN_MSS
 WIN_MODE=1
 MSS_S=FLOOR(MSS_S)
 WINTTL$="Mouse Scale - "+STR$(MSS_S)+"%"
 WINTTL$[TSK]=WINTTL$
 GOSUB@WINDOW
 IF WINIDFLG THEN RETURN
 WINSX=32:WINSY=1:WINSC=1
 WINSTR$="Ï³½Éµµ·»¦¶´Ï½¡":GOSUB@WINSTRPUT
 WINBX=0:WINBY=10:WINBSTR$="60%":GOSUB@WINBTN
 FOR I=1 TO !!(WINBTNF)
  MSS_S=60
  SPSCALE 0,MSS_S,0
 NEXT
 WINBX=29:WINBY=10:WINBSTR$="SMALL":GOSUB@WINBTN
 FOR I=1 TO !!(WINBTNF)
  MSS_S=MSS_S-20
  MSS_S=FLOOR(MSS_S)
  IF MSS_S<60 THEN MSS_S=60
  SPSCALE 0,MSS_S,0
 NEXT
 WINBX=74:WINBY=10:WINBSTR$="100%":GOSUB@WINBTN
 FOR I=1 TO !!(WINBTNF)
  MSS_S=100
  SPSCALE 0,MSS_S,0
 NEXT
 WINBX=111:WINBY=10:WINBSTR$="BIG":GOSUB@WINBTN
 FOR I=1 TO !!(WINBTNF)
  MSS_S=MSS_S+20
  MSS_S=FLOOR(MSS_S)
  IF MSS_S>200 THEN MSS_S=200
  SPSCALE 0,MSS_S,0
 NEXT
 WINBX=140:WINBY=10:WINBSTR$="200%":GOSUB@WINBTN
 FOR I=1 TO !!(WINBTNF)
  MSS_S=200
  SPSCALE 0,MSS_S,0
 NEXT
RETURN

@C_MSS
 GOSUB@WINCLOSE
RETURN

'„½„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„¼
'„xÈ½ÞÐ¸¼Þ®¹Þ-Ñ             „y
'„x                         „y
'„x<NZM>           by hatena„y
'„»„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„º

@S_NZM
 WINCLS=1:WINMODE=0
 WINX2=48:WINY2=58
 WINTTL$="È½ÞÐ"
 BF=0
 GOSUB @WINBUFF
 IF BF==0 THEN GOSUB@SYS_ERR_BUFF:RETURN
 NZM_BF=BF
 BFC=0:GOSUB@WINBUFFGCLS
RETURN

@WIN_NZM
 WINBX=9:WINBY=36
 WINBSTR$="BOM":GOSUB@WINBTN
 NZM_F=!!WINBTNF
 GCOPY NZM_BF,0,0,46,36,WFX,WFY,1
 BF=NZM_BF
 GOSUB @WINBUFFP
  GPSET RND(47),RND(36),13
  IF NZM_F THEN GFILL 0,0,46,36,0
 GOSUB @WINBUFFP2
RETURN

@C_NZM
 BF=NZM_BF:GOSUB@WINBUFFC
 GOSUB@WINCLOSE
RETURN

'„½„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„¼
'„xWindowMoveMode           „y
'„x                         „y
'„x<WMM>           by hatena„y
'„»„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„º

@S_WMM
 WINCLS=1:WINMODE=0
 WINX2=100:WINY2=68
 WINTTL$="WindowMM"
RETURN

@WIN_WMM
 WINSX=2:WINSY=3:WINSC=1
 WINSTR$=" ²ÄÞ³Ó-ÄÞ:":GOSUB@WINSTRPUT
 WINSX=82:WINSY=3:WINSC=11
 WINSTR$=STR$(WINMOVMODE):GOSUB@WINSTRPUT
 WINSX=14:WINSY=22:WINSC=1
 WINSTR$="½ÍÞÃ²ÄÞ³":GOSUB@WINSTRPUT
 WINSX=14:WINSY=34:WINSC=1
 WINSTR$="¸ÛÜ¸ÉÐ²ÄÞ³":GOSUB@WINSTRPUT
 WINSX=14:WINSY=46:WINSC=13
 WINSTR$="·Ó¸²ÄÞ³":GOSUB@WINSTRPUT
 WINBX=2:WINBY=20:WINBSTR$="0"
 GOSUB@WINBTN:IF WINBTNF THEN WINMOVMODE=0
 WINBX=2:WINBY=32:WINBSTR$="1"
 GOSUB@WINBTN:IF WINBTNF THEN WINMOVMODE=1
 WINBX=2:WINBY=44:WINBSTR$="2"
 GOSUB@WINBTN:IF WINBTNF THEN WINMOVMODE=2
RETURN

@C_WMM
 GOSUB@WINCLOSE
RETURN

'„½„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„¼
'„xTask Manager             „y
'„x                         „y
'„x<TMNG>          by hatena„y
'„»„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„º

@S_TMNG
 WINCLS=0:WIN_MODE=0
 WINX2=191
 WINTTL$="Taskmgr"
 TMNG_SC=0:TMNG_BXC=1
RETURN

@WIN_TMNG
 TMNG_T=0:TMNG_SL=64:TMNG_L=7
 FOR TMNG_I=0 TO TSKMAX-1
  TMNG_T=TMNG_T+!!(WINFLG[TMNG_I]!=0)
 NEXT
 FOR TMNG_CI=1 TO TMNG_BXC
  WINSX=2:WINSY=2:WINSC=1
  WINSTR$="Target:":GOSUB@WINSTRPUT
  WINSX=58:WINSY=2:WINSC=11
  WINSTR$=STR$(TMNG_SC):GOSUB@WINSTRPUT
  WINSX=2:WINSY=11:WINSC=11
  WINSTR$=WINTTL$[TMNG_SC]:GOSUB@WINSTRPUT
  WINSX=2:WINSY=20:WINSC=1
  WINSTR$="Name:":GOSUB@WINSTRPUT
  WINSX=42:WINSY=20:WINSC=11
  WINSTR$=WINNAME$[TMNG_SC]:GOSUB@WINSTRPUT
  WINBX=2:WINBY=28:WINBSTR$="Compact"
  GOSUB@WINBTN
  IF WINBTNF THEN TMNG_BXC=0
  WINBX=2:WINBY=40:WINBSTR$="RUN.OTW"
  GOSUB@WINBTN
  IF WINBTNF THEN WINEXE$="RUN":GOSUB@WINEXE
  WINBX=2:WINBY=52:WINBSTR$="Close"
  GOSUB@WINBTN
  IF WINBTNF THEN TSK=TMNG_SC:GOSUB@WINCLOSEGT
 NEXT
 FOR TMNG_CI=1 TO !(TMNG_BXC)
  WINBX=2:WINBY=1:WINBSTR$="Resize"
  GOSUB@WINBTN
  IF WINBTNF THEN TMNG_BXC=1
  TMNG_SL=13
 NEXT
 FOR TMNG_I=0 TO TMNG_T-1
  WINBX=2:WINBY=TMNG_I*12+TMNG_SL:WINBSTR$=STR$(TMNG_I)
  GOSUB@WINBTN
  IF WINBTNF THEN TMNG_SC=TMNG_I
  WINSX=14:WINSY=TMNG_I*12+TMNG_SL+2:WINSC=1
  IF LEN(STR$(TMNG_I))==2 THEN WINSX=WINSX+8
  WINSTR$=WINTTL$[TMNG_I]
  IF LEN(WINTTL$[TMNG_I])>TMNG_L THEN TMNG_L=LEN(WINTTL$[TMNG_I])
  GOSUB@WINSTRPUT
 NEXT
 WINY2=TMNG_SL+12+TMNG_T*12
 WINX2=16+TMNG_L*8
RETURN

@C_TMNG
 GOSUB@WINCLOSE
RETURN

'„½„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„¼
'„xBack Ground Music Player „y
'„x                         „y
'„x<BGMP>         by hatena „y
'„»„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„º

@S_BGMP
 WIMCLS=1:WINMODE=0
 WINX2=110:WINY2=33
 WINTTL$="BGMPlayer"
RETURN

@WIN_BGMP
 IF BGMP_N<0 THEN BGMP_N=29
 IF BGMP_N>29 THEN BGMP_N=0
 WINSX=2:WINSY=2:WINSC=1
 WINSTR$="BGM Number:"
 GOSUB@WINSTRPUT
 WINSX=90:WINSY=2:WINSC=11
 WINSTR$=STR$(BGMP_N)
 GOSUB@WINSTRPUT
 WINBX=2:WINBY=10:WINBSTR$="ô"
 GOSUB@WINBTN
 IF WINBTNF THEN BGMPLAY 7,BGMP_N
 WINBX=15:WINBY=10:WINBSTR$="„}"
 GOSUB@WINBTN
 IF WINBTNF THEN BGMSTOP 7
 WINBX=28:WINBY=10:WINBSTR$="+"
 GOSUB@WINBTN
 IF WINBTNF THEN BGMP_N=BGMP_N+1
 WINBX=41:WINBY=10:WINBSTR$="-"
 GOSUB@WINBTN
 IF WINBTNF THEN BGMP_N=BGMP_N-1
RETURN

@C_BGMP
 GOSUB@WINCLOSE
RETURN


'„½„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„¼
'„xControl Pannel           „y
'„x                         „y
'„x<CP>            by hatena„y
'„»„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„º

@S_CP
 WINCLS=1:WINMODE=0
 WINX2=191:WINY2=144
 WINTTL$="ºÝÄÛ-ÙÊßÈÙ"
RETURN

@WIN_CP
 WINBX=0:WINBY=8:WINBSTR$="Ï³½Éµµ·»":GOSUB@WINBTN
 IF WINBTNF THEN WINEXE$="MSS":GOSUB@WINEXE
 WINBX=69:WINBY=8:WINBSTR$="³¨ÝÄÞ³²ÄÞ³Ó-ÄÞ":GOSUB@WINBTN
 IF WINBTNF THEN WINEXE$="WMM":GOSUB@WINEXE
 
RETURN

@C_CP
 GOSUB@WINCLOSE
RETURN





@GUIED
ACLS
RTFLG=1
GOSUB @OTW
?"GUIED
APPNAME$="APP
WINX[0]=0WINY[0]=0WINY2[0]=127WINX2[0]=64
WINSX[0]=255-64
WINSY[0]=0
WINM[0]=2
WINFLG[0]=1
CONTROL$[0]="STR
CONTROL$[1]="BTN
CONTROL$[2]="TXTBOX
CONTROL$[3]="PROG
CONTROL$[4]="LNKLBL
WINSCX=255-64WINSCY=0
@GUILOOP
WINACTV=1
WINTTL$="TOOL"
GCLS OTWBGCL
WINACTV=0
WIN_MODE=0
TSK=0
WINIDFLG=0
GOSUB @WINDOW
TSK=0
WINIDFLG=1
GOSUB @WINDOW
WINM[0]=WINM
WINFLG[0]=WINFLG
WINSX[0]=WINSCX
WINSY[0]=WINSCY
WINIDFLG=0
FOR I=0TO 4
 WINSX=0WINSY=I*8
 WINSC=1WINSTR$=CONTROL$[I]
 GOSUB @WINSTRPUT
NEXT
'GOSUB @MOUSE
'GOTO @GUILOOP
WINTTL$=APPNAME$
WINACTV=1
WIN_MODE=1
WINSCX=0
WINSCY=0
WINX=0
WINY=0
WINY2=64
WINX2=64
GOSUB @WINDOW
WINSX=0
WINSY=0
WINSC=1
WINSTR$="HELLO
GOSUB @WINSTRPUT
GOSUB @MOUSE
 M=!M
GPAGE 0,!WINGPAGE,WINGPAGE
GOTO @GUILOOP
@GUIMOUSE
 B=BUTTON()
 MOUSEY=MOUSEY-(B AND 1)+((B AND 2)==2)
 MOUSEX=MOUSEX-((B AND 4)==4)+((B AND 8)==8)
 SPOFS MOUSESP,MOUSEX,MOUSEY
RETURN
'„½„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„w„¼
'„xSTICKY NOTE              „y
'„x                         „y
'„x<SNOTE>         by hatena„y
'„»„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„z„º
@S_SNOTE
 WINMLT[TSK]=_SNOTE_P
 WINMODE=0
 WINX2=126:WINY2=32
 WINTTL$="Sticky Note"
 _SNOTE_P=_SNOTE_P+1
RETURN

@WIN_SNOTE
 _SNOTE=WINMLT[TSK]
 WINTX=1:WINTY=0
 WINTX2=WINX2-1
 WINTSX=_SNOTE_SX[_SNOTE]
 WINTA=_SNOTE_A[_SNOTE]
 WINTXTP$=_SNOTE$[_SNOTE]
 GOSUB@WINTXTBOX
 _SNOTE$[_SNOTE]=WINTXT$
 _SNOTE_A[_SNOTE]=WINTA
 _SNOTE_SX[_SNOTE]=WINTSX
 WINBX=1:WINBY=10
 WINBSTR$="New Sticky Note"
 GOSUB@WINBTN
 IF WINBTNF THEN WINEXE$="SNOTE":GOSUB@WINEXE
RETURN
@@